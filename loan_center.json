{"paragraphs":[{"text":"%md\n#<Center><h1><span style=\"color:black\"> Loan Center </font></h1></Center>\n</br>\n\n<h4 style=\"font-family: Verdana\"><font color=\"#7133FF\"></font></h4>\n<p align=\"center\">\n<img src=\"http://bsmedia.business-standard.com/_media/bs/img/article/2017-09/28/full/1506595674-8657.jpg?im=Resize\" width=\"600\" height=\"400\" />\n</p>\n---\n\n<span style=\"color:black\">  [M2 MoSEF]  : **Abdoul Aziz Berrada , Amira Slimene , Yasmine Ouyahya  et Nicolas Turpin** </span>\n","user":"imsduser","dateUpdated":"2022-03-16T01:32:39+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1><Center><h1><span style=\"color:black\"> Loan Center </font></h1></Center></h1>\n<p></br></p>\n<h4 style=\"font-family: Verdana\"><font color=\"#7133FF\"></font></h4>\n<p align=\"center\">\n<img src=\"http://bsmedia.business-standard.com/_media/bs/img/article/2017-09/28/full/1506595674-8657.jpg?im=Resize\" width=\"600\" height=\"400\" />\n</p>\n<hr />\n<p><span style=\"color:black\">  [M2 MoSEF]  : <strong>Abdoul Aziz Berrada , Amira Slimene , Yasmine Ouyahya  et Nicolas Turpin</strong> </span></p>\n"}]},"apps":[],"jobName":"paragraph_1646603882307_-578952020","id":"20220306-225802_540521756","dateCreated":"2022-03-06T22:58:02+0100","dateStarted":"2022-03-16T01:32:39+0100","dateFinished":"2022-03-16T01:32:39+0100","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:37560"},{"text":"%md\n<h2 style=\"font-family: Verdana\"><font color=\"#FF33F6\"><strong>Sommaire</strong></font></h2>\n\n------\n\nIntroduction : Présentation de la problématique \n- Problématique\n- Contexte\n- Implementation\n\nI - Chargement et création de la base de données sous Hive\n- Préparation et Présentation de la base de données\n- Description du jeu de données \n\nII - Analyse exploratoire \n- Analyse univariée\n- Analyse bivariée\n\nIII- Nettoyage et traitement des données sous Pyspark\n- Traitement des valeurs manquantes\n- Imputation des variables quantitatives\n- Imputation des variables catégorielles\n- Corrélation entre les variables\n\nIV -  Sélection du modèle et validation\n- Méthode de sélection des modèles ML\n- Meilleur modèle \n\nV -Streamlit app web\n\nConclusion \n\n--- ","user":"imsduser","dateUpdated":"2022-03-16T00:10:03+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2 style=\"font-family: Verdana\"><font color=\"#FF33F6\"><strong>Sommaire</strong></font></h2>\n<hr />\n<p>Introduction : Présentation de la problématique</p>\n<ul>\n<li>Problématique</li>\n<li>Contexte</li>\n<li>Implementation</li>\n</ul>\n<p>I - Chargement et création de la base de données sous Hive</p>\n<ul>\n<li>Préparation et Présentation de la base de données</li>\n<li>Description du jeu de données</li>\n</ul>\n<p>II - Analyse exploratoire</p>\n<ul>\n<li>Analyse univariée</li>\n<li>Analyse bivariée</li>\n</ul>\n<p>III- Nettoyage et traitement des données sous Pyspark</p>\n<ul>\n<li>Traitement des valeurs manquantes</li>\n<li>Imputation des variables quantitatives</li>\n<li>Imputation des variables catégorielles</li>\n<li>Corrélation entre les variables</li>\n</ul>\n<p>IV -  Sélection du modèle et validation</p>\n<ul>\n<li>Méthode de sélection des modèles ML</li>\n<li>Meilleur modèle</li>\n</ul>\n<p>V -Streamlit app web</p>\n<p>Conclusion</p>\n<hr />\n"}]},"apps":[],"jobName":"paragraph_1647375568804_924205761","id":"20220315-211928_243743106","dateCreated":"2022-03-15T21:19:28+0100","dateStarted":"2022-03-16T00:09:54+0100","dateFinished":"2022-03-16T00:09:54+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37561"},{"text":"%md\n<h2 style=\"font-family: Verdana\"><font color=\"#7133FF\"><strong> Introduction</strong></font></h2>\n\n\n<h4 style=\"font-family: Verdana\"><font color=\"#FF33F6\"><strong>Problématique</strong></font></h4>\n\n<p style='text-align: justify'>Dans ce projet, nous allons développer un modèle de risque de crédit piloté par les données pour prédire les probabilités de défaut (PD) des emprunteurs existants ou potentiels. Nous déterminerons les scores de crédit à l'aide d'une Grille de score hautement interprétable, facile à comprendre et à mettre en œuvre.</p>\n\n<p style='text-align: justify'>On pense parfois que l'évaluation statistique du crédit est trop coûteuse ou difficile, ou qu'on ne dispose pas du type de données nécessaires pour la mettre en œuvre. Cependant, la principale donnée nécessaire pour ce type de modélisation se situe dans les historiques de remboursement des clients.</p>\n\n\n<h4 style=\"font-family: Verdana\"><font color=\"#FF33F6\"><strong>Contexte</strong></font></h4>\n\n<p style='text-align: justify'>Cette technique aide ainsi les institutions financières à développer leurs portefeuilles en réduisant le coût du service aux clients à faibles revenus et en augmentant la qualité du service et la satisfaction client. Un modèle de scoring de crédit est un outil de gestion des risques qui évalue la solvabilité d'un demandeur de prêt en estimant sa probabilité de défaillance sur la base de données historiques. Il utilise des outils numériques pour classer les cas en utilisant des données intégrées dans une seule valeur qui tente de mesurer le risque ou la solvabilité.</p>\n\n<h4 style=\"font-family: Verdana\"><font color=\"#FF33F6\"><strong>Implémentation</strong></font></h4>\n</p>\nNous utilisons l’ensemble de données sur le crédit immobilier HMEQ rapportant les caractéristiques et les informations de remboursement des clients. Le jeu de données contient les observations de 5 960 demandeurs de prêts hypothécaires.\nEn effet, un prêt sur valeur nette immobilière est un prêt pour lequel le débiteur utilise la valeur nette de son logement comme garantie sous-jacente.</p>\n\n\n\n\n","user":"imsduser","dateUpdated":"2022-03-16T16:35:59+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2 style=\"font-family: Verdana\"><font color=\"#7133FF\"><strong> Introduction</strong></font></h2>\n<h4 style=\"font-family: Verdana\"><font color=\"#FF33F6\"><strong>Problématique</strong></font></h4>\n<p style='text-align: justify'>Dans ce projet, nous allons développer un modèle de risque de crédit piloté par les données pour prédire les probabilités de défaut (PD) des emprunteurs existants ou potentiels. Nous déterminerons les scores de crédit à l'aide d'une Grille de score hautement interprétable, facile à comprendre et à mettre en œuvre.</p>\n<p style='text-align: justify'>On pense parfois que l'évaluation statistique du crédit est trop coûteuse ou difficile, ou qu'on ne dispose pas du type de données nécessaires pour la mettre en œuvre. Cependant, la principale donnée nécessaire pour ce type de modélisation se situe dans les historiques de remboursement des clients.</p>\n<h4 style=\"font-family: Verdana\"><font color=\"#FF33F6\"><strong>Contexte</strong></font></h4>\n<p style='text-align: justify'>Cette technique aide ainsi les institutions financières à développer leurs portefeuilles en réduisant le coût du service aux clients à faibles revenus et en augmentant la qualité du service et la satisfaction client. Un modèle de scoring de crédit est un outil de gestion des risques qui évalue la solvabilité d'un demandeur de prêt en estimant sa probabilité de défaillance sur la base de données historiques. Il utilise des outils numériques pour classer les cas en utilisant des données intégrées dans une seule valeur qui tente de mesurer le risque ou la solvabilité.</p>\n<h4 style=\"font-family: Verdana\"><font color=\"#FF33F6\"><strong>Implémentation</strong></font></h4>\n</p>\nNous utilisons l’ensemble de données sur le crédit immobilier HMEQ rapportant les caractéristiques et les informations de remboursement des clients. Le jeu de données contient les observations de 5 960 demandeurs de prêts hypothécaires.\nEn effet, un prêt sur valeur nette immobilière est un prêt pour lequel le débiteur utilise la valeur nette de son logement comme garantie sous-jacente.</p>\n"}]},"apps":[],"jobName":"paragraph_1646903150600_1929557105","id":"20220310-100550_794815972","dateCreated":"2022-03-10T10:05:50+0100","dateStarted":"2022-03-16T16:35:59+0100","dateFinished":"2022-03-16T16:36:00+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37562"},{"text":"%md\n<h2 style=\"font-family: Verdana\"><font color=\"#7133FF\"><strong> I - Chargement et création de la base de données sous Hive </strong></font></h2>\n\n","user":"imsduser","dateUpdated":"2022-03-15T22:06:16+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2 style=\"font-family: Verdana\"><font color=\"#7133FF\"><strong> I - Chargement et création de la base de données sous Hive </strong></font></h2>\n"}]},"apps":[],"jobName":"paragraph_1647300921035_-538071198","id":"20220315-003521_1002223602","dateCreated":"2022-03-15T00:35:21+0100","dateStarted":"2022-03-15T22:06:16+0100","dateFinished":"2022-03-15T22:06:16+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37563"},{"text":"%md\n<h3 style=\"font-family: Verdana\"><font color=\"#FF33F6\"><strong> 1 - Mise de la base sous Hive</strong></font></h3>\n```\nscp -P 2222 hmeq.csv imsduser@interne.avisia.fr:/home/imsduser\nssh imsduser@interne.avisia.fr -p 2222\nhdfs dfs -put hmeq.csv /user/imsduser/aadm\n```\nNous commençons par créer une base de données vide sous Hive afin de pouvoir importer les données:","user":"imsduser","dateUpdated":"2022-03-15T23:24:14+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3 style=\"font-family: Verdana\"><font color=\"#FF33F6\"><strong> 1 - Mise de la base sous Hive</strong></font></h3>\n<pre><code>scp -P 2222 hmeq.csv imsduser@interne.avisia.fr:/home/imsduser\nssh imsduser@interne.avisia.fr -p 2222\nhdfs dfs -put hmeq.csv /user/imsduser/aadm\n</code></pre>\n<p>Nous commençons par créer une base de données vide sous Hive afin de pouvoir importer les données:</p>\n"}]},"apps":[],"jobName":"paragraph_1647374622554_-1839605408","id":"20220315-210342_2109847856","dateCreated":"2022-03-15T21:03:42+0100","dateStarted":"2022-03-15T23:23:35+0100","dateFinished":"2022-03-15T23:23:35+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37564"},{"text":"%md #### **Création d'une table vide sous Hive** ","user":"imsduser","dateUpdated":"2022-03-15T23:18:34+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h4><strong>Création d'une table vide sous Hive</strong></h4>\n"}]},"apps":[],"jobName":"paragraph_1646242509233_-868385650","id":"20220302-183509_1211233529","dateCreated":"2022-03-02T18:35:09+0100","dateStarted":"2022-03-15T23:18:34+0100","dateFinished":"2022-03-15T23:18:34+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37565"},{"text":"%jdbc(hive)\nshow databases;","user":"imsduser","dateUpdated":"2022-03-07T23:49:03+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"database_name\nabdou_anais_patrick\namonino\ndata_jerome\ndataiku\ndb_music_genre\ndefault\nformation1\nformation10\nformation11\nformation2commandes\nformation3\nformation4\nformation5\nformation6\nformation7\nformation_c\ngroup_hannachi_rahmany_un\ngroupe_abdou_patrick_anais\ngroupe_dorian_martin\nhmeq\nimsd\nimsd_adelaide\nimsd_afiz\nimsd_aflatoun\nimsd_amo\nimsd_amo2\nimsd_amo6\nimsd_cuichen\nimsd_danika\nimsd_efz\nimsd_greg\nimsd_jiajun\nimsd_kldsjfjdfkj\nimsd_patrck\nimsd_rom\nimsd_stephane\nimsd_test\nimsd_tgm\nimsd_titi\nimsduser_jde\niris\nloarn\nmosef\nmosef_amo\nmosef_david_c4\nmosef_davidng\nmosef_dnguyen\nmosef_feriel\nmosef_hamon\nmosef_hmeq\nmosef_ilona\nmosef_jey\nmosef_jhms\nmosef_joceline\nmosef_linh\nmosef_lucas\nmosef_marie\nmosef_mathieu\nmosef_mathieur\nmosef_mehditest\nmosef_morgane\nmosef_nnr\nmosef_pac\nmosef_pia\nmosef_piag\nmosef_projet_score\nmosef_rachid\nmosef_roxane\nmosef_t\nmosef_test\nmosef_yasmine\nmosef_yogara\nmosef_yogaratnam\nmosef_zhanike\nmosef_zhy\nprojet_amazon\nprojet_heart_disease\nprojet_ppn\ntest\ntest12\ntest_fst\n"}]},"apps":[],"jobName":"paragraph_1646254253712_2035557400","id":"20220302-215053_774903866","dateCreated":"2022-03-02T21:50:53+0100","dateStarted":"2022-03-07T23:49:03+0100","dateFinished":"2022-03-07T23:49:04+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37566"},{"text":"%jdbc(hive)\ncreate database if not exists score;","user":"imsduser","dateUpdated":"2022-03-12T18:58:25+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"}]},"apps":[],"jobName":"paragraph_1647107897788_-589027554","id":"20220312-185817_1177484216","dateCreated":"2022-03-12T18:58:17+0100","dateStarted":"2022-03-12T18:58:25+0100","dateFinished":"2022-03-12T19:01:28+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37567"},{"text":"%jdbc(hive)\nCREATE TABLE IF NOT EXISTS score.hmeq (BAD String, loan float, MORTDUE float, VALUE float, REASON String, JOB String, YOJ int, DEROG int, DELINQ int, CLAGE float, NINQ int, CLNO int, DEBTINC float)\nROW FORMAT DELIMITED FIELDS\nTERMINATED BY ','\nSTORED AS TEXTFILE\ntblproperties('skip.header.line.count'='1');","user":"imsduser","dateUpdated":"2022-03-12T19:02:29+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"}]},"apps":[],"jobName":"paragraph_1647107882323_969190167","id":"20220312-185802_198229441","dateCreated":"2022-03-12T18:58:02+0100","dateStarted":"2022-03-12T19:02:29+0100","dateFinished":"2022-03-12T19:05:31+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37568"},{"text":"%jdbc(hive)\nuse score;","user":"imsduser","dateUpdated":"2022-03-12T19:09:51+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"}]},"apps":[],"jobName":"paragraph_1646071651518_-1328061040","id":"20220228-190731_846169110","dateCreated":"2022-02-28T19:07:31+0100","dateStarted":"2022-03-11T01:48:26+0100","dateFinished":"2022-03-11T01:48:26+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37569"},{"text":"%jdbc(hive)\nCREATE TABLE IF NOT EXISTS scoring.hmeq (BAD String, loan float, MORTDUE float, VALUE float, REASON String, JOB String, YOJ int, DEROG int, DELINQ int, CLAGE float, NINQ int, CLNO int, DEBTINC float)\nROW FORMAT DELIMITED FIELDS\nTERMINATED BY ','\nSTORED AS TEXTFILE\ntblproperties('skip.header.line.count'='1');","user":"imsduser","dateUpdated":"2022-03-11T01:48:29+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"}]},"apps":[],"jobName":"paragraph_1646071523595_-344779125","id":"20220228-190523_396550028","dateCreated":"2022-02-28T19:05:23+0100","dateStarted":"2022-03-11T01:48:30+0100","dateFinished":"2022-03-11T01:48:30+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37570"},{"text":"%jdbc(hive)\nload data inpath \"/user/imsduser/aadm/hmeq.csv\"\nINTO TABLE score.hmeq;","user":"imsduser","dateUpdated":"2022-03-12T19:05:39+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"}]},"apps":[],"jobName":"paragraph_1647108326859_-1798666061","id":"20220312-190526_1081982158","dateCreated":"2022-03-12T19:05:26+0100","dateStarted":"2022-03-12T19:05:39+0100","dateFinished":"2022-03-12T19:08:42+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37571"},{"text":"%jdbc(hive)\r\ndescribe score.hmeq;","user":"imsduser","dateUpdated":"2022-03-12T19:09:30+0100","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"col_name\tdata_type\tcomment\nbad\tstring\t\nloan\tfloat\t\nmortdue\tfloat\t\nvalue\tfloat\t\nreason\tstring\t\njob\tstring\t\nyoj\tint\t\nderog\tint\t\ndelinq\tint\t\nclage\tfloat\t\nninq\tint\t\nclno\tint\t\ndebtinc\tfloat\t\n"}]},"apps":[],"jobName":"paragraph_1646238601629_-660598221","id":"20220302-173001_1177802529","dateCreated":"2022-03-02T17:30:01+0100","dateStarted":"2022-03-12T19:09:17+0100","dateFinished":"2022-03-12T19:09:17+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37572"},{"text":"%jdbc(hive)\r\nSELECT * from score.hmeq limit 30;","user":"imsduser","dateUpdated":"2022-03-12T19:10:28+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"hmeq.bad\thmeq.loan\thmeq.mortdue\thmeq.value\thmeq.reason\thmeq.job\thmeq.yoj\thmeq.derog\thmeq.delinq\thmeq.clage\thmeq.ninq\thmeq.clno\thmeq.debtinc\n1\t1100.0\t25860.0\t39025.0\tHomeImp\tOther\t10\t0\t0\t94.36667\t1\t9\tnull\n1\t1300.0\t70053.0\t68400.0\tHomeImp\tOther\t7\t0\t2\t121.833336\t0\t14\tnull\n1\t1500.0\t13500.0\t16700.0\tHomeImp\tOther\t4\t0\t0\t149.46666\t1\t10\tnull\n1\t1500.0\tnull\tnull\t\t\tnull\tnull\tnull\tnull\tnull\tnull\tnull\n0\t1700.0\t97800.0\t112000.0\tHomeImp\tOffice\t3\t0\t0\t93.333336\t0\t14\tnull\n1\t1700.0\t30548.0\t40320.0\tHomeImp\tOther\t9\t0\t0\t101.466\t1\t8\t37.113613\n1\t1800.0\t48649.0\t57037.0\tHomeImp\tOther\t5\t3\t2\t77.1\t1\t17\tnull\n1\t1800.0\t28502.0\t43034.0\tHomeImp\tOther\t11\t0\t0\t88.76603\t0\t8\t36.884895\n1\t2000.0\t32700.0\t46740.0\tHomeImp\tOther\t3\t0\t2\t216.93333\t1\t12\tnull\n1\t2000.0\tnull\t62250.0\tHomeImp\tSales\t16\t0\t0\t115.8\t0\t13\tnull\n1\t2000.0\t22608.0\tnull\t\t\t18\tnull\tnull\tnull\tnull\tnull\tnull\n1\t2000.0\t20627.0\t29800.0\tHomeImp\tOffice\t11\t0\t1\t122.53333\t1\t9\tnull\n1\t2000.0\t45000.0\t55000.0\tHomeImp\tOther\t3\t0\t0\t86.066666\t2\t25\tnull\n0\t2000.0\t64536.0\t87400.0\t\tMgr\t2\t0\t0\t147.13333\t0\t24\tnull\n1\t2100.0\t71000.0\t83850.0\tHomeImp\tOther\t8\t0\t1\t123.0\t0\t16\tnull\n1\t2200.0\t24280.0\t34687.0\tHomeImp\tOther\tnull\t0\t1\t300.86667\t0\t8\tnull\n1\t2200.0\t90957.0\t102600.0\tHomeImp\tMgr\t7\t2\t6\t122.9\t1\t22\tnull\n1\t2200.0\t23030.0\tnull\t\t\t19\tnull\tnull\tnull\tnull\tnull\t3.7113123\n1\t2300.0\t28192.0\t40150.0\tHomeImp\tOther\t4\t0\t0\t54.6\t1\t16\tnull\n0\t2300.0\t102370.0\t120953.0\tHomeImp\tOffice\t2\t0\t0\t90.99253\t0\t13\t31.588503\n1\t2300.0\t37626.0\t46200.0\tHomeImp\tOther\t3\t0\t1\t122.26667\t1\t14\tnull\n1\t2400.0\t50000.0\t73395.0\tHomeImp\tProfExe\t5\t1\t0\tnull\t1\t0\tnull\n1\t2400.0\t28000.0\t40800.0\tHomeImp\tMgr\t12\t0\t0\t67.2\t2\t22\tnull\n1\t2400.0\t18000.0\tnull\tHomeImp\tMgr\t22\tnull\t2\t121.73333\t0\t10\tnull\n1\t2400.0\tnull\t17180.0\tHomeImp\tOther\tnull\t0\t0\t14.566667\t3\t4\tnull\n1\t2400.0\t34863.0\t47471.0\tHomeImp\tMgr\t12\t0\t0\t70.49108\t1\t21\t38.2636\n0\t2400.0\t98449.0\t117195.0\tHomeImp\tOffice\t4\t0\t0\t93.811775\t0\t13\t29.681828\n1\t2500.0\t15000.0\t20200.0\tHomeImp\t\t18\t0\t0\t136.06667\t1\t19\tnull\n1\t2500.0\t25116.0\t36350.0\tHomeImp\tOther\t10\t1\t2\t276.96667\t0\t9\tnull\n0\t2500.0\t7229.0\t44516.0\tHomeImp\tSelf\tnull\t0\t0\t208.0\t0\t12\tnull\n"}]},"apps":[],"jobName":"paragraph_1646238568057_1794838611","id":"20220302-172928_1985708084","dateCreated":"2022-03-02T17:29:28+0100","dateStarted":"2022-03-12T19:10:17+0100","dateFinished":"2022-03-12T19:10:17+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37573"},{"text":"%jdbc(hive)\nselect count (bad) as nb_observations\nfrom score.hmeq;","user":"imsduser","dateUpdated":"2022-03-15T21:05:49+0100","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":224,"optionOpen":false}}},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"nb_observations\n5960\n"}]},"apps":[],"jobName":"paragraph_1647107384031_-2083930273","id":"20220312-184944_554113080","dateCreated":"2022-03-12T18:49:44+0100","dateStarted":"2022-03-12T19:08:52+0100","dateFinished":"2022-03-12T19:09:06+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37574"},{"text":"%md\n#### **Imports**","user":"imsduser","dateUpdated":"2022-03-15T23:19:16+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h4><strong>Imports</strong></h4>\n"}]},"apps":[],"jobName":"paragraph_1647382736166_29118282","id":"20220315-231856_1086313347","dateCreated":"2022-03-15T23:18:56+0100","dateStarted":"2022-03-15T23:19:16+0100","dateFinished":"2022-03-15T23:19:16+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37575"},{"text":"%pyspark\nfrom pyspark.sql import SparkSession\nfrom pyspark.ml.evaluation import BinaryClassificationEvaluator, MulticlassClassificationEvaluator\nfrom pyspark.ml.feature import IndexToString\nfrom pyspark.ml.classification import GBTClassifier\nfrom pyspark.ml.classification import NaiveBayes \nfrom pyspark.ml.classification import LogisticRegression\nfrom pyspark.ml.classification import RandomForestClassifier\nimport numpy as np\nfrom pyspark.ml.classification import DecisionTreeClassifier\nfrom pyspark.ml.tuning import ParamGridBuilder, CrossValidator\nfrom pyspark.ml.evaluation import BinaryClassificationEvaluator\nfrom pyspark.mllib.evaluation import BinaryClassificationMetrics\nfrom pyspark.ml.feature import StandardScaler\nfrom pyspark.ml.feature import StringIndexer, OneHotEncoder, VectorAssembler\nfrom pyspark.ml.stat import Correlation\nfrom pyspark.ml.feature import Imputer\nfrom pyspark.sql.types import FloatType\nfrom pyspark.sql.functions import skewness\nfrom pyspark.sql.functions import col,isnan,when,count","user":"imsduser","dateUpdated":"2022-03-15T23:18:00+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1647382169523_1830900670","id":"20220315-230929_2092538627","dateCreated":"2022-03-15T23:09:29+0100","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:37576"},{"text":"%pyspark\r\nfrom pyspark.sql import SparkSession\r\nsparkSession = (SparkSession\r\n .builder\r\n .appName('scoring')\r\n .enableHiveSupport()\r\n .getOrCreate())\r\ndff = sparkSession.sql('SELECT * FROM score.hmeq')\r\ndff.show()\r\nprint(\"shape\", (dff.count(), len(dff.columns)))","user":"imsduser","dateUpdated":"2022-03-15T21:12:33+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+------+--------+--------+-------+------+----+-----+------+----------+----+----+---------+\n|bad|  loan| mortdue|   value| reason|   job| yoj|derog|delinq|     clage|ninq|clno|  debtinc|\n+---+------+--------+--------+-------+------+----+-----+------+----------+----+----+---------+\n|  1|1100.0| 25860.0| 39025.0|HomeImp| Other|  10|    0|     0|  94.36667|   1|   9|     null|\n|  1|1300.0| 70053.0| 68400.0|HomeImp| Other|   7|    0|     2|121.833336|   0|  14|     null|\n|  1|1500.0| 13500.0| 16700.0|HomeImp| Other|   4|    0|     0| 149.46666|   1|  10|     null|\n|  1|1500.0|    null|    null|       |      |null| null|  null|      null|null|null|     null|\n|  0|1700.0| 97800.0|112000.0|HomeImp|Office|   3|    0|     0| 93.333336|   0|  14|     null|\n|  1|1700.0| 30548.0| 40320.0|HomeImp| Other|   9|    0|     0|   101.466|   1|   8|37.113613|\n|  1|1800.0| 48649.0| 57037.0|HomeImp| Other|   5|    3|     2|      77.1|   1|  17|     null|\n|  1|1800.0| 28502.0| 43034.0|HomeImp| Other|  11|    0|     0|  88.76603|   0|   8|36.884895|\n|  1|2000.0| 32700.0| 46740.0|HomeImp| Other|   3|    0|     2| 216.93333|   1|  12|     null|\n|  1|2000.0|    null| 62250.0|HomeImp| Sales|  16|    0|     0|     115.8|   0|  13|     null|\n|  1|2000.0| 22608.0|    null|       |      |  18| null|  null|      null|null|null|     null|\n|  1|2000.0| 20627.0| 29800.0|HomeImp|Office|  11|    0|     1| 122.53333|   1|   9|     null|\n|  1|2000.0| 45000.0| 55000.0|HomeImp| Other|   3|    0|     0| 86.066666|   2|  25|     null|\n|  0|2000.0| 64536.0| 87400.0|       |   Mgr|   2|    0|     0| 147.13333|   0|  24|     null|\n|  1|2100.0| 71000.0| 83850.0|HomeImp| Other|   8|    0|     1|     123.0|   0|  16|     null|\n|  1|2200.0| 24280.0| 34687.0|HomeImp| Other|null|    0|     1| 300.86667|   0|   8|     null|\n|  1|2200.0| 90957.0|102600.0|HomeImp|   Mgr|   7|    2|     6|     122.9|   1|  22|     null|\n|  1|2200.0| 23030.0|    null|       |      |  19| null|  null|      null|null|null|3.7113123|\n|  1|2300.0| 28192.0| 40150.0|HomeImp| Other|   4|    0|     0|      54.6|   1|  16|     null|\n|  0|2300.0|102370.0|120953.0|HomeImp|Office|   2|    0|     0|  90.99253|   0|  13|31.588503|\n+---+------+--------+--------+-------+------+----+-----+------+----------+----+----+---------+\nonly showing top 20 rows\n\n('shape', (5960, 13))\n"}]},"apps":[],"jobName":"paragraph_1646906318941_732292907","id":"20220310-105838_1557541417","dateCreated":"2022-03-10T10:58:38+0100","dateStarted":"2022-03-15T03:15:12+0100","dateFinished":"2022-03-15T03:15:55+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37577"},{"text":"%pyspark\nprint(\"shape\", (dff.count(), len(dff.columns)))","user":"imsduser","dateUpdated":"2022-03-15T02:40:38+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"('shape', (5960, 13))\n"}]},"apps":[],"jobName":"paragraph_1646690947320_409021802","id":"20220307-230907_827775892","dateCreated":"2022-03-07T23:09:07+0100","dateStarted":"2022-03-15T02:40:39+0100","dateFinished":"2022-03-15T02:41:05+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37578"},{"text":"%md\n<h3 style=\"font-family: Verdana\"><font color=\"#FF33F6\"><strong>2 - Présentation de la base</strong></font></h3>","user":"imsduser","dateUpdated":"2022-03-15T23:39:51+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3 style=\"font-family: Verdana\"><font color=\"#FF33F6\"><strong>2 - Présentation de la base</strong></font></h3>\n"}]},"apps":[],"jobName":"paragraph_1646909090900_-1267662000","id":"20220310-114450_1914748699","dateCreated":"2022-03-10T11:44:50+0100","dateStarted":"2022-03-15T23:39:51+0100","dateFinished":"2022-03-15T23:39:51+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37579"},{"text":"%md\n<p style='text-align: justify'>Nous avons des données sur le crédit immobilier HMEQ rapportant les caractéristiques et les informations de remboursement des clients. Il y a 5 960 demandeurs de prêts hypothécaires .</p>\n\nPour chaque demandeur, 12 variables d’entrée ont été enregistrées :\n   - BAD ∈ [0, 1] : Variable binaire décrivant si l’emprunteur a fait défaut sur son prêt (BAD=1) ou si ce dernier l’a bien remboursé (BAD=0).\n   - LOAN ∈ D + : Montant du prêt accordé.\n   - MORTDUE ∈ D + : Montant dû sur l’hypothèque existante.\n   -  VALUE ∈ D + : Valeur de la propriété actuelle de l’individu\n   - REASON - Catégorielle : Raison avancée pour l’octroi du prêt.\n   - JOB - Catégorielle : Emploi occupée.\n   - YOJ ∈ N : Nombre d’années en poste dans l’emploi mentionné.\n   - DEROG ∈ N : Nombre de rapports péjoratifs ”majeurs” : Ce sont en quelque sorte des remarques qui apparaissent sur le profil bancaire de chaque client à chaque incident  considéré comme majeur par la dite banque (retards de paiement, fraude etc.) . Plus il y en a, plus on est réticent à octroyer un crédit par exemple, puisque le risque de défaut semble plus élevé.\n   - DELINQ ∈ N : Nombre de lignes de crédit \"délinquantes\" : Une ligne de crédit devient \"délinquante” lorsque l’emprunteur n’effectue pas les paiements minimums requis 30 à 60 jours après la date à laquelle les paiements étaient dus. Cela signifie que la ligne de crédit risque d’être en défaut de paiement.\n   - CLAGE ∈ N : \"âge\" de la dernière ligne de crédit (en mois)\n   - NINQ ∈ N : Nombre d’enquêtes dit de \"solvabilité\" récentes. Ce sont des demandes formulées par une institution ou une entreprise financière pour obtenir des informations sur le dossier de crédit d’une personne ou d’une entité.\n   - CLNO ∈ N : Nombre de lignes de crédit.\n   - DEBTINC ∈ D + : Ratio dette-revenu.","user":"imsduser","dateUpdated":"2022-03-16T16:37:27+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p style='text-align: justify'>Nous avons des données sur le crédit immobilier HMEQ rapportant les caractéristiques et les informations de remboursement des clients. Il y a 5 960 demandeurs de prêts hypothécaires .</p>\n<p>Pour chaque demandeur, 12 variables d’entrée ont été enregistrées :</p>\n<ul>\n<li>BAD ∈ [0, 1] : Variable binaire décrivant si l’emprunteur a fait défaut sur son prêt (BAD=1) ou si ce dernier l’a bien remboursé (BAD=0).</li>\n<li>LOAN ∈ D + : Montant du prêt accordé.</li>\n<li>MORTDUE ∈ D + : Montant dû sur l’hypothèque existante.</li>\n<li>VALUE ∈ D + : Valeur de la propriété actuelle de l’individu</li>\n<li>REASON - Catégorielle : Raison avancée pour l’octroi du prêt.</li>\n<li>JOB - Catégorielle : Emploi occupée.</li>\n<li>YOJ ∈ N : Nombre d’années en poste dans l’emploi mentionné.</li>\n<li>DEROG ∈ N : Nombre de rapports péjoratifs ”majeurs” : Ce sont en quelque sorte des remarques qui apparaissent sur le profil bancaire de chaque client à chaque incident  considéré comme majeur par la dite banque (retards de paiement, fraude etc.) . Plus il y en a, plus on est réticent à octroyer un crédit par exemple, puisque le risque de défaut semble plus élevé.</li>\n<li>DELINQ ∈ N : Nombre de lignes de crédit &ldquo;délinquantes&rdquo; : Une ligne de crédit devient &ldquo;délinquante” lorsque l’emprunteur n’effectue pas les paiements minimums requis 30 à 60 jours après la date à laquelle les paiements étaient dus. Cela signifie que la ligne de crédit risque d’être en défaut de paiement.</li>\n<li>CLAGE ∈ N : &ldquo;âge&rdquo; de la dernière ligne de crédit (en mois)</li>\n<li>NINQ ∈ N : Nombre d’enquêtes dit de &ldquo;solvabilité&rdquo; récentes. Ce sont des demandes formulées par une institution ou une entreprise financière pour obtenir des informations sur le dossier de crédit d’une personne ou d’une entité.</li>\n<li>CLNO ∈ N : Nombre de lignes de crédit.</li>\n<li>DEBTINC ∈ D + : Ratio dette-revenu.</li>\n</ul>\n"}]},"apps":[],"jobName":"paragraph_1646909264840_-1374396145","id":"20220310-114744_1533781143","dateCreated":"2022-03-10T11:47:44+0100","dateStarted":"2022-03-16T16:37:27+0100","dateFinished":"2022-03-16T16:37:28+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37580"},{"text":"%md\n<h2 style=\"font-family: Verdana\"><font color=\"#7133FF\"><strong> II - Analyse exploratoire </strong></font></h2>","user":"imsduser","dateUpdated":"2022-03-15T23:40:29+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2 style=\"font-family: Verdana\"><font color=\"#7133FF\"><strong> II - Analyse exploratoire </strong></font></h2>\n"}]},"apps":[],"jobName":"paragraph_1646930203612_1577752647","id":"20220310-173643_440134703","dateCreated":"2022-03-10T17:36:43+0100","dateStarted":"2022-03-15T23:40:29+0100","dateFinished":"2022-03-15T23:40:29+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37581"},{"text":"%md \n<h3 style=\"font-family: Verdana\"><font color=\"#FF33F6\"><strong>1 - Analyse univariée</strong></font></h3>\nL’ensemble des données présentent les caractéristiques suivantes : \nLa cible (BAD) est une variable binaire indiquant si le client a payé son prêt ou s’il est en défaut de paiement. Cette issue défavorable s’est produite dans 1189 cas (20 %).\n -  Défaut : BAD = 1 \n -  Non défaut : BAD = 0 \n\nToutes  les variables quantitatives ont un écart à la moyenne faible, donc elles sont bien centrées sauf pour : LOAN, MORTDUE, VALUE qui ont un écart type important.\nConcernant les 2 seules variables qualitatives, on voit que REASON qui indique le motif de demande du prêt a 2 modalités. La plus fréquente est {DebtCon} (Consolidation de dettes ) à hauteur de 68.8% des cas. Les demandeurs de prêts font rouler leurs prêts, ils s'endettent de nouveau pour payer leurs anciens prêts. La variable JOB ,quant à elle, distingue 6 types de demandeurs de prêts, dont l'ordre d'importance est le suivant : {Other, ProfExe, Office, Mgr, Self et Sales}.","user":"imsduser","dateUpdated":"2022-03-16T16:39:06+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3 style=\"font-family: Verdana\"><font color=\"#FF33F6\"><strong>1 - Analyse univariée</strong></font></h3>\n<p>L’ensemble des données présentent les caractéristiques suivantes :\n<br  />La cible (BAD) est une variable binaire indiquant si le client a payé son prêt ou s’il est en défaut de paiement. Cette issue défavorable s’est produite dans 1189 cas (20 %).</p>\n<ul>\n<li>Défaut : BAD = 1</li>\n<li>Non défaut : BAD = 0</li>\n</ul>\n<p>Toutes  les variables quantitatives ont un écart à la moyenne faible, donc elles sont bien centrées sauf pour : LOAN, MORTDUE, VALUE qui ont un écart type important.\n<br  />Concernant les 2 seules variables qualitatives, on voit que REASON qui indique le motif de demande du prêt a 2 modalités. La plus fréquente est {DebtCon} (Consolidation de dettes ) à hauteur de 68.8% des cas. Les demandeurs de prêts font rouler leurs prêts, ils s'endettent de nouveau pour payer leurs anciens prêts. La variable JOB ,quant à elle, distingue 6 types de demandeurs de prêts, dont l'ordre d'importance est le suivant : {Other, ProfExe, Office, Mgr, Self et Sales}.</p>\n"}]},"apps":[],"jobName":"paragraph_1646929839610_-1714628535","id":"20220310-173039_1258377512","dateCreated":"2022-03-10T17:30:39+0100","dateStarted":"2022-03-16T16:39:06+0100","dateFinished":"2022-03-16T16:39:06+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37582"},{"text":"%spark2.sql\n\nselect bad, count(bad) as comptage_target\nfrom score.hmeq\ngroup by bad","user":"imsduser","dateUpdated":"2022-03-12T19:11:51+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":true},"editorMode":"ace/mode/sql","editorHide":false,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"bad\tcomptage_target\n0\t4771\n1\t1189\nBAD\t1\n"}]},"apps":[],"jobName":"paragraph_1646931610410_-1848224536","id":"20220310-180010_670085228","dateCreated":"2022-03-10T18:00:10+0100","dateStarted":"2022-03-12T19:11:46+0100","dateFinished":"2022-03-12T19:11:47+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37583"},{"text":"%spark2.sql\n\nselect *\nfrom score.hmeq\nWHERE bad=\"BAD\"","user":"imsduser","dateUpdated":"2022-03-12T19:12:38+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"bad\tloan\tmortdue\tvalue\treason\tjob\tyoj\tderog\tdelinq\tclage\tninq\tclno\tdebtinc\nBAD\tnull\tnull\tnull\tREASON\tJOB\tnull\tnull\tnull\tnull\tnull\tnull\tnull\n"}]},"apps":[],"jobName":"paragraph_1646931666258_870503137","id":"20220310-180106_1425202502","dateCreated":"2022-03-10T18:01:06+0100","dateStarted":"2022-03-12T19:12:39+0100","dateFinished":"2022-03-12T19:12:39+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37584"},{"text":"%jdbc(hive)\nINSERT OVERWRITE TABLE score.hmeq\nSELECT * FROM score.hmeq\nWHERE hmeq.bad NOT IN ('BAD');","user":"imsduser","dateUpdated":"2022-03-12T19:22:16+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"}]},"apps":[],"jobName":"paragraph_1646931725051_92433592","id":"20220310-180205_1235208987","dateCreated":"2022-03-10T18:02:05+0100","dateStarted":"2022-03-12T19:12:47+0100","dateFinished":"2022-03-12T19:15:55+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37585"},{"text":"%spark2.sql\n\nselect bad, count(bad) as count_target\nfrom score.hmeq\ngroup by bad","user":"imsduser","dateUpdated":"2022-03-12T19:16:25+0100","config":{"colWidth":6,"enabled":true,"results":{},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"bad\tcount_target\n0\t4771\n1\t1189\n"}]},"apps":[],"jobName":"paragraph_1646932274276_1872242610","id":"20220310-181114_1556082613","dateCreated":"2022-03-10T18:11:14+0100","dateStarted":"2022-03-12T19:16:02+0100","dateFinished":"2022-03-12T19:16:03+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37586"},{"title":"Répartition des modalités de la target","text":"%jdbc(hive)\n\nSELECT bad, count(bad) as count_target\nfrom score.hmeq\ngroup by bad\n","user":"imsduser","dateUpdated":"2022-03-12T19:22:21+0100","config":{"colWidth":6,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/sql","editorHide":false,"title":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"bad\tcount_target\n0\t4771\n1\t1188\n"}]},"apps":[],"jobName":"paragraph_1646932384246_567513117","id":"20220310-181304_213617644","dateCreated":"2022-03-10T18:13:04+0100","dateStarted":"2022-03-12T19:16:44+0100","dateFinished":"2022-03-12T19:16:50+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37587"},{"text":"%md\nNous pouvons constater le déséquilibre des deux classes, avec une majorité d'individu en non défaut (4771 observations lorsque BAD = 0 contre 1189 lorsque BAD = 1). Bien que nous choisissions un bon algorithme, des modèles peuvent être plus sensibles que d'autres vis à vis d'un déséquilibre aux données : ceci peut générer un biais. L'algorithme pourrait se retrouver à s'adapter de manière excessive à la classe majoritaire.\nSi une telle chose se produit, nous obtiendrons sur les modèles un score élevé sur le Loss Fonction ainsi que sur la précision et le rappel de la classe dominante (nous définirons ces concepts plus tard).","user":"imsduser","dateUpdated":"2022-03-15T23:07:28+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Nous pouvons constater le déséquilibre des deux classes, avec une majorité d'individu en non défaut (4771 observations lorsque BAD = 0 contre 1189 lorsque BAD = 1). Bien que nous choisissions un bon algorithme, des modèles peuvent être plus sensibles que d'autres vis à vis d'un déséquilibre aux données : ceci peut générer un biais. L'algorithme pourrait se retrouver à s'adapter de manière excessive à la classe majoritaire.\n<br  />Si une telle chose se produit, nous obtiendrons sur les modèles un score élevé sur le Loss Fonction ainsi que sur la précision et le rappel de la classe dominante (nous définirons ces concepts plus tard).</p>\n"}]},"apps":[],"jobName":"paragraph_1647375801342_1486478791","id":"20220315-212321_1987296212","dateCreated":"2022-03-15T21:23:21+0100","dateStarted":"2022-03-15T23:07:17+0100","dateFinished":"2022-03-15T23:07:17+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37588"},{"text":"%spark2.pyspark\ndff.describe(['bad']).show()\n","user":"imsduser","dateUpdated":"2022-03-14T23:13:11+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+-----------------+\n|summary|              bad|\n+-------+-----------------+\n|  count|             5960|\n|   mean|0.199496644295302|\n| stddev|0.399655517450269|\n|    min|                0|\n|    max|                1|\n+-------+-----------------+\n\n"}]},"apps":[],"jobName":"paragraph_1647109063178_-1391363639","id":"20220312-191743_1057797461","dateCreated":"2022-03-12T19:17:43+0100","dateStarted":"2022-03-12T19:21:45+0100","dateFinished":"2022-03-12T19:21:45+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37589"},{"text":"%md\n<h4 style=\"font-family: Verdana\"><font color=\"#D30543\"><strong> Statistiques descriptives </strong></font></h4>","user":"imsduser","dateUpdated":"2022-03-15T23:42:42+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"editOnDblClick":true,"language":"markdown"},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h4 style=\"font-family: Verdana\"><font color=\"#D30543\"><strong> Statistiques descriptives </strong></font></h4>\n"}]},"apps":[],"jobName":"paragraph_1646932382677_-406286349","id":"20220310-181302_1107718519","dateCreated":"2022-03-10T18:13:02+0100","dateStarted":"2022-03-15T23:42:30+0100","dateFinished":"2022-03-15T23:42:30+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37590"},{"text":"%spark2.pyspark\ndff.describe(['loan']).show()","user":"imsduser","dateUpdated":"2022-03-14T23:13:13+0100","config":{"colWidth":4,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":true},"editorMode":"ace/mode/python","editorHide":false,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+------------------+\n|summary|              loan|\n+-------+------------------+\n|  count|              5960|\n|   mean| 18607.96979865772|\n| stddev|11207.480416693992|\n|    min|            1100.0|\n|    max|           89900.0|\n+-------+------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1647109361323_426420027","id":"20220312-192241_457895164","dateCreated":"2022-03-12T19:22:41+0100","dateStarted":"2022-03-12T19:22:52+0100","dateFinished":"2022-03-12T19:22:53+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37591"},{"text":"%spark2.pyspark\ndff.describe(['mortdue']).show()","user":"imsduser","dateUpdated":"2022-03-14T23:13:16+0100","config":{"colWidth":4,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+------------------+\n|summary|           mortdue|\n+-------+------------------+\n|  count|              5442|\n|   mean| 73760.81719905653|\n| stddev|44457.609457337334|\n|    min|            2063.0|\n|    max|          399550.0|\n+-------+------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1647109375795_1983144725","id":"20220312-192255_1520445638","dateCreated":"2022-03-12T19:22:55+0100","dateStarted":"2022-03-12T19:29:44+0100","dateFinished":"2022-03-12T19:29:44+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37592"},{"text":"%spark2.pyspark\ndff.describe(['value']).show()","user":"imsduser","dateUpdated":"2022-03-14T23:13:18+0100","config":{"colWidth":4,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+------------------+\n|summary|             value|\n+-------+------------------+\n|  count|              5848|\n|   mean|101776.04874128976|\n| stddev| 57385.77533365315|\n|    min|            8000.0|\n|    max|          855909.0|\n+-------+------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1647109803677_-567571393","id":"20220312-193003_407156777","dateCreated":"2022-03-12T19:30:03+0100","dateStarted":"2022-03-12T19:30:16+0100","dateFinished":"2022-03-12T19:30:16+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37593"},{"text":"%spark2.pyspark\ndff.describe(['yoj']).show()\n","user":"imsduser","dateUpdated":"2022-03-14T23:13:20+0100","config":{"colWidth":4,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+-----------------+\n|summary|              yoj|\n+-------+-----------------+\n|  count|             5445|\n|   mean| 8.90358126721763|\n| stddev|7.585544231901787|\n|    min|                0|\n|    max|               41|\n+-------+-----------------+\n\n"}]},"apps":[],"jobName":"paragraph_1647109825050_-1873763260","id":"20220312-193025_732937399","dateCreated":"2022-03-12T19:30:25+0100","dateStarted":"2022-03-12T19:31:00+0100","dateFinished":"2022-03-12T19:31:00+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37594"},{"text":"%spark2.pyspark\ndff.describe(['derog']).show()\n","user":"imsduser","dateUpdated":"2022-03-14T23:13:22+0100","config":{"colWidth":4,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+------------------+\n|summary|             derog|\n+-------+------------------+\n|  count|              5252|\n|   mean|0.2545696877380046|\n| stddev| 0.846046777086318|\n|    min|                 0|\n|    max|                10|\n+-------+------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1647109873060_733942191","id":"20220312-193113_1479416041","dateCreated":"2022-03-12T19:31:13+0100","dateStarted":"2022-03-12T19:31:22+0100","dateFinished":"2022-03-12T19:31:22+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37595"},{"text":"%spark2.pyspark\ndff.describe(['delinq']).show()\n","user":"imsduser","dateUpdated":"2022-03-14T23:13:24+0100","config":{"colWidth":4,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+------------------+\n|summary|            delinq|\n+-------+------------------+\n|  count|              5380|\n|   mean|0.4494423791821561|\n| stddev|1.1272659176049724|\n|    min|                 0|\n|    max|                15|\n+-------+------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1647109896573_191092142","id":"20220312-193136_1881330393","dateCreated":"2022-03-12T19:31:36+0100","dateStarted":"2022-03-12T19:31:54+0100","dateFinished":"2022-03-12T19:31:54+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37596"},{"text":"%spark2.pyspark\ndff.describe(['clage']).show()\n","user":"imsduser","dateUpdated":"2022-03-14T23:13:27+0100","config":{"colWidth":4,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+------------------+\n|summary|             clage|\n+-------+------------------+\n|  count|              5652|\n|   mean|179.76627517814808|\n| stddev| 85.81009185923476|\n|    min|               0.0|\n|    max|         1168.2335|\n+-------+------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1647109924490_1792863109","id":"20220312-193204_1341124487","dateCreated":"2022-03-12T19:32:04+0100","dateStarted":"2022-03-12T19:32:25+0100","dateFinished":"2022-03-12T19:32:26+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37597"},{"text":"%spark2.pyspark\ndff.describe(['ninq']).show()\n","user":"imsduser","dateUpdated":"2022-03-14T23:13:30+0100","config":{"colWidth":4,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+------------------+\n|summary|              ninq|\n+-------+------------------+\n|  count|              5450|\n|   mean|1.1860550458715597|\n| stddev|1.7286749712080534|\n|    min|                 0|\n|    max|                17|\n+-------+------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1647109959503_1771179253","id":"20220312-193239_964258051","dateCreated":"2022-03-12T19:32:39+0100","dateStarted":"2022-03-12T19:32:47+0100","dateFinished":"2022-03-12T19:32:47+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37598"},{"text":"%spark2.pyspark\ndff.describe(['clno']).show()\n","user":"imsduser","dateUpdated":"2022-03-14T23:13:32+0100","config":{"colWidth":4,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+------------------+\n|summary|              clno|\n+-------+------------------+\n|  count|              5738|\n|   mean| 21.29609620076682|\n| stddev|10.138933192458637|\n|    min|                 0|\n|    max|                71|\n+-------+------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1647109974025_280292590","id":"20220312-193254_218231374","dateCreated":"2022-03-12T19:32:54+0100","dateStarted":"2022-03-12T19:33:02+0100","dateFinished":"2022-03-12T19:33:02+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37599"},{"text":"%spark2.pyspark\ndff.describe(['debtinc']).show()","user":"imsduser","dateUpdated":"2022-03-14T23:13:34+0100","config":{"colWidth":4,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+------------------+\n|summary|           debtinc|\n+-------+------------------+\n|  count|              4693|\n|   mean|33.779915328234615|\n| stddev| 8.601746176096126|\n|    min|        0.52449924|\n|    max|         203.31215|\n+-------+------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1647110010365_101581921","id":"20220312-193330_247709078","dateCreated":"2022-03-12T19:33:30+0100","dateStarted":"2022-03-12T19:33:37+0100","dateFinished":"2022-03-12T19:33:38+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37600"},{"text":"%md\n\n<h4 style=\"font-family: Verdana\"><font color=\"#D30543\"><strong> La variable Loan </strong></font></h4>","user":"imsduser","dateUpdated":"2022-03-15T23:42:07+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h4 style=\"font-family: Verdana\"><font color=\"#D30543\"><strong> La variable Loan </strong></font></h4>\n"}]},"apps":[],"jobName":"paragraph_1647041031790_12898224","id":"20220312-002351_226885619","dateCreated":"2022-03-12T00:23:51+0100","dateStarted":"2022-03-15T23:41:54+0100","dateFinished":"2022-03-15T23:41:54+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37601"},{"title":"Distribution de la variable loan","text":"%jdbc(hive)\n\nSELECT loan, count(loan) as count_loan\nfrom score.hmeq\ngroup by loan","user":"imsduser","dateUpdated":"2022-03-14T23:07:19+0100","config":{"colWidth":6,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"loan\tcount_loan\n1300.0\t1\n1500.0\t2\n1700.0\t2\n1800.0\t2\n2000.0\t6\n2100.0\t1\n2200.0\t3\n2300.0\t3\n2400.0\t6\n2500.0\t4\n2800.0\t2\n2900.0\t5\n3000.0\t12\n3100.0\t2\n3200.0\t6\n3300.0\t2\n3400.0\t1\n3500.0\t2\n3600.0\t7\n3700.0\t1\n3800.0\t4\n3900.0\t5\n4000.0\t19\n4100.0\t3\n4200.0\t6\n4300.0\t3\n4400.0\t3\n4500.0\t11\n4700.0\t6\n4800.0\t3\n4900.0\t10\n5000.0\t50\n5100.0\t15\n5200.0\t8\n5300.0\t12\n5400.0\t11\n5500.0\t19\n5600.0\t8\n5700.0\t19\n5800.0\t9\n5900.0\t9\n6000.0\t28\n6100.0\t12\n6200.0\t18\n6300.0\t16\n6400.0\t17\n6500.0\t21\n6600.0\t8\n6700.0\t16\n6800.0\t15\n6900.0\t14\n7000.0\t37\n7100.0\t12\n7200.0\t15\n7300.0\t10\n7400.0\t16\n7500.0\t36\n7600.0\t8\n7700.0\t12\n7800.0\t15\n7900.0\t16\n8000.0\t44\n8100.0\t19\n8200.0\t30\n8300.0\t20\n8400.0\t30\n8500.0\t26\n8600.0\t23\n8700.0\t29\n8800.0\t18\n8900.0\t16\n9000.0\t33\n9100.0\t17\n9200.0\t12\n9300.0\t26\n9400.0\t28\n9500.0\t18\n9600.0\t18\n9700.0\t23\n9800.0\t26\n9900.0\t28\n10000.0\t81\n10100.0\t25\n10200.0\t31\n10300.0\t23\n10400.0\t16\n10500.0\t28\n10600.0\t34\n10700.0\t23\n10800.0\t33\n10900.0\t15\n11000.0\t47\n11100.0\t30\n11200.0\t17\n11300.0\t24\n11400.0\t19\n11500.0\t21\n11600.0\t20\n11700.0\t28\n11800.0\t20\n11900.0\t28\n12000.0\t69\n12100.0\t31\n12200.0\t19\n12300.0\t33\n12400.0\t21\n12500.0\t32\n12600.0\t25\n12700.0\t27\n12800.0\t33\n12900.0\t34\n13000.0\t50\n13100.0\t20\n13200.0\t17\n13300.0\t30\n13400.0\t24\n13500.0\t29\n13600.0\t27\n13700.0\t31\n13800.0\t21\n13900.0\t34\n14000.0\t29\n14100.0\t14\n14200.0\t17\n14300.0\t23\n14400.0\t20\n14500.0\t17\n14600.0\t22\n14700.0\t24\n14800.0\t22\n14900.0\t29\n15000.0\t105\n15100.0\t26\n15200.0\t32\n15300.0\t31\n15400.0\t25\n15500.0\t28\n15600.0\t20\n15700.0\t30\n15800.0\t29\n15900.0\t31\n16000.0\t39\n16100.0\t24\n16200.0\t25\n16300.0\t19\n16400.0\t27\n16500.0\t37\n16600.0\t19\n16700.0\t20\n16800.0\t24\n16900.0\t19\n17000.0\t51\n17100.0\t21\n17200.0\t29\n17300.0\t21\n17400.0\t25\n17500.0\t23\n17600.0\t24\n17700.0\t19\n17800.0\t21\n17900.0\t17\n18000.0\t40\n18100.0\t18\n18200.0\t24\n18300.0\t19\n18400.0\t20\n18500.0\t19\n18600.0\t29\n18700.0\t23\n18800.0\t15\n18900.0\t25\n19000.0\t28\n19100.0\t9\n19200.0\t14\n19300.0\t20\n19400.0\t13\n19500.0\t17\n19600.0\t10\n19700.0\t12\n19800.0\t9\n19900.0\t15\n20000.0\t74\n20100.0\t20\n20200.0\t21\n20300.0\t15\n20400.0\t17\n20500.0\t25\n20600.0\t20\n20700.0\t13\n20800.0\t23\n20900.0\t22\n21000.0\t27\n21100.0\t10\n21200.0\t18\n21300.0\t23\n21400.0\t21\n21500.0\t23\n21600.0\t21\n21700.0\t26\n21800.0\t17\n21900.0\t22\n22000.0\t24\n22100.0\t15\n22200.0\t14\n22300.0\t18\n22400.0\t33\n22500.0\t17\n22600.0\t23\n22700.0\t15\n22800.0\t18\n22900.0\t23\n23000.0\t25\n23100.0\t13\n23200.0\t10\n23300.0\t14\n23400.0\t12\n23500.0\t28\n23600.0\t17\n23700.0\t17\n23800.0\t12\n23900.0\t19\n24000.0\t17\n24100.0\t11\n24200.0\t15\n24300.0\t13\n24400.0\t21\n24500.0\t16\n24600.0\t8\n24700.0\t10\n24800.0\t12\n24900.0\t11\n25000.0\t73\n25100.0\t23\n25200.0\t13\n25300.0\t12\n25400.0\t14\n25500.0\t18\n25600.0\t19\n25700.0\t14\n25800.0\t8\n25900.0\t15\n26000.0\t16\n26100.0\t12\n26200.0\t10\n26300.0\t17\n26400.0\t13\n26500.0\t20\n26600.0\t10\n26700.0\t10\n26800.0\t14\n26900.0\t14\n27000.0\t15\n27100.0\t9\n27200.0\t10\n27300.0\t15\n27400.0\t10\n27500.0\t11\n27600.0\t18\n27700.0\t20\n27800.0\t7\n27900.0\t12\n28000.0\t10\n28100.0\t9\n28200.0\t15\n28300.0\t10\n28400.0\t12\n28500.0\t10\n28600.0\t9\n28700.0\t6\n28800.0\t7\n28900.0\t12\n29000.0\t6\n29200.0\t4\n29300.0\t2\n29400.0\t4\n29500.0\t4\n29600.0\t1\n29700.0\t2\n29800.0\t3\n29900.0\t5\n30000.0\t16\n30100.0\t6\n30200.0\t6\n30300.0\t6\n30400.0\t4\n30500.0\t8\n30600.0\t4\n30700.0\t2\n30800.0\t8\n30900.0\t4\n31000.0\t7\n31100.0\t2\n31200.0\t6\n31300.0\t4\n31400.0\t3\n31500.0\t7\n31600.0\t2\n31700.0\t2\n31800.0\t9\n31900.0\t6\n32000.0\t6\n32100.0\t2\n32200.0\t4\n32300.0\t9\n32400.0\t3\n32500.0\t3\n32600.0\t3\n32700.0\t2\n32800.0\t4\n32900.0\t5\n33000.0\t7\n33100.0\t3\n33200.0\t6\n33300.0\t1\n33400.0\t3\n33500.0\t7\n33600.0\t3\n33700.0\t9\n33800.0\t1\n33900.0\t4\n34000.0\t3\n34100.0\t4\n34200.0\t1\n34300.0\t3\n34400.0\t2\n34500.0\t1\n34600.0\t3\n34700.0\t1\n34800.0\t4\n34900.0\t2\n35000.0\t6\n35100.0\t2\n35200.0\t3\n35300.0\t1\n35400.0\t1\n35500.0\t1\n35600.0\t3\n35700.0\t1\n35800.0\t2\n36000.0\t5\n36100.0\t3\n36200.0\t3\n36300.0\t6\n36400.0\t4\n36500.0\t5\n36600.0\t2\n36800.0\t4\n36900.0\t1\n37000.0\t3\n37200.0\t3\n37300.0\t1\n37400.0\t1\n37500.0\t2\n37600.0\t2\n37700.0\t3\n37800.0\t2\n37900.0\t2\n38000.0\t6\n38100.0\t4\n38200.0\t3\n38300.0\t1\n38400.0\t1\n38600.0\t2\n38700.0\t3\n38800.0\t1\n38900.0\t4\n39000.0\t3\n39100.0\t2\n39300.0\t2\n39400.0\t2\n39500.0\t4\n39600.0\t2\n39700.0\t3\n39800.0\t1\n40000.0\t12\n40100.0\t2\n40300.0\t2\n40400.0\t3\n40500.0\t2\n40600.0\t3\n40700.0\t3\n40800.0\t2\n40900.0\t5\n41100.0\t3\n41200.0\t3\n41300.0\t1\n41400.0\t2\n41500.0\t1\n41600.0\t4\n41700.0\t4\n41800.0\t3\n42000.0\t5\n42100.0\t2\n42200.0\t3\n42300.0\t2\n42400.0\t1\n42500.0\t2\n42600.0\t3\n42700.0\t1\n42800.0\t4\n42900.0\t3\n43000.0\t1\n43100.0\t2\n43200.0\t4\n43300.0\t6\n43500.0\t3\n43700.0\t2\n43800.0\t2\n43900.0\t2\n44000.0\t3\n44100.0\t1\n44400.0\t2\n44500.0\t1\n44900.0\t1\n45000.0\t3\n45100.0\t1\n45200.0\t1\n45700.0\t2\n45900.0\t1\n46100.0\t1\n46200.0\t1\n46300.0\t2\n46700.0\t1\n46900.0\t1\n47000.0\t5\n47100.0\t1\n47500.0\t3\n47600.0\t2\n47700.0\t1\n47800.0\t1\n47900.0\t1\n48000.0\t1\n48200.0\t1\n48400.0\t1\n48800.0\t1\n48900.0\t2\n49200.0\t1\n49300.0\t1\n49500.0\t2\n49800.0\t1\n49900.0\t1\n50000.0\t16\n50100.0\t4\n50200.0\t4\n50300.0\t1\n50400.0\t5\n50500.0\t1\n50600.0\t1\n50700.0\t1\n50800.0\t4\n50900.0\t4\n51000.0\t1\n51100.0\t2\n51300.0\t1\n51400.0\t1\n51500.0\t2\n51600.0\t2\n51700.0\t2\n51800.0\t1\n52000.0\t2\n52200.0\t3\n52300.0\t1\n52400.0\t1\n52700.0\t2\n52800.0\t1\n52900.0\t1\n53000.0\t1\n53200.0\t1\n53300.0\t1\n53400.0\t1\n53500.0\t1\n53600.0\t2\n53700.0\t4\n53800.0\t2\n53900.0\t1\n54000.0\t1\n56800.0\t1\n57000.0\t1\n58000.0\t1\n58100.0\t1\n58900.0\t1\n59200.0\t2\n59500.0\t1\n59700.0\t1\n59800.0\t1\n60000.0\t3\n60500.0\t1\n61400.0\t1\n62500.0\t1\n62700.0\t1\n62900.0\t1\n63300.0\t1\n63900.0\t1\n64200.0\t1\n64900.0\t1\n65100.0\t1\n65200.0\t3\n65500.0\t1\n65800.0\t2\n66000.0\t1\n66400.0\t1\n66500.0\t1\n67400.0\t1\n68000.0\t1\n68100.0\t1\n68700.0\t1\n69000.0\t1\n69600.0\t1\n69700.0\t2\n70300.0\t1\n70500.0\t1\n70800.0\t1\n71200.0\t1\n72300.0\t1\n75400.0\t1\n76500.0\t1\n77200.0\t1\n77400.0\t1\n78400.0\t1\n78700.0\t1\n79100.0\t1\n79200.0\t2\n79900.0\t1\n80300.0\t1\n80600.0\t1\n81200.0\t1\n81400.0\t2\n82200.0\t2\n86000.0\t1\n87000.0\t1\n87500.0\t1\n88300.0\t1\n88500.0\t1\n88800.0\t1\n88900.0\t2\n89000.0\t1\n89200.0\t1\n89800.0\t1\n89900.0\t1\n"}]},"apps":[],"jobName":"paragraph_1647040775747_-1835018450","id":"20220312-001935_1261920984","dateCreated":"2022-03-12T00:19:35+0100","dateStarted":"2022-03-14T23:07:19+0100","dateFinished":"2022-03-14T23:07:32+0100","status":"ABORT","progressUpdateIntervalMs":500,"$$hashKey":"object:37602"},{"title":"Statistiques descriptives de la variable loan","text":"%jdbc(hive)\n\nselect  min(loan) as min_loan, \n        round(avg(loan),2) as mean_loan,\n        max(loan) as max_loan\nfrom score.hmeq","user":"imsduser","dateUpdated":"2022-03-12T19:34:33+0100","config":{"colWidth":6,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"min_loan\tmean_loan\tmax_loan\n1300.0\t18610.91\t89900.0\n"}]},"apps":[],"jobName":"paragraph_1647040825910_962334271","id":"20220312-002025_652819600","dateCreated":"2022-03-12T00:20:25+0100","dateStarted":"2022-03-12T19:34:23+0100","dateFinished":"2022-03-12T19:34:36+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37603"},{"text":"%md\n\n<h4 style=\"font-family: Verdana\"><font color=\"#D30543\"><strong> Les variables catégorielles REASON & JOB </strong></font></h4>","user":"imsduser","dateUpdated":"2022-03-16T00:12:48+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h4 style=\"font-family: Verdana\"><font color=\"#D30543\"><strong> Les variables catégorielles REASON & JOB </strong></font></h4>\n"}]},"apps":[],"jobName":"paragraph_1647041888967_-2092458148","id":"20220312-003808_1383912137","dateCreated":"2022-03-12T00:38:08+0100","dateStarted":"2022-03-16T00:12:48+0100","dateFinished":"2022-03-16T00:12:48+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37604"},{"title":"Répartition de la variable Reason","text":"%jdbc(hive)\n\nSELECT reason, count(reason) as count_reason\nfrom score.hmeq\ngroup by reason","user":"imsduser","dateUpdated":"2022-03-12T19:36:28+0100","config":{"colWidth":6,"enabled":true,"results":{"0":{"graph":{"mode":"pieChart","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"reason\tcount_reason\n\t252\nDebtCon\t3928\nHomeImp\t1779\n"}]},"apps":[],"jobName":"paragraph_1647041932588_-1132632236","id":"20220312-003852_2055718027","dateCreated":"2022-03-12T00:38:52+0100","dateStarted":"2022-03-12T19:36:17+0100","dateFinished":"2022-03-12T19:36:24+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37605"},{"title":"Répartition de la variable Job","text":"%jdbc(hive)\n\nSELECT job, count(job) as count_job\nfrom score.hmeq\ngroup by job","user":"imsduser","dateUpdated":"2022-03-12T19:36:28+0100","config":{"colWidth":6,"enabled":true,"results":{"0":{"graph":{"mode":"pieChart","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"job\tcount_job\n\t279\nMgr\t767\nOffice\t948\nOther\t2387\nProfExe\t1276\nSales\t109\nSelf\t193\n"}]},"apps":[],"jobName":"paragraph_1647042092953_-1660276220","id":"20220312-004132_1383947212","dateCreated":"2022-03-12T00:41:32+0100","dateStarted":"2022-03-12T19:36:19+0100","dateFinished":"2022-03-12T19:36:27+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37606"},{"text":"%md\nConcernant ces 2 seules variables qualitatives, nous pouvons constater que:\n<ul>\n<li><p style='text-align: justify'>on voit que REASON qui indique le motif de demande du prêt a 2 modalités et la plus fréquente est DebtCon (Consolidation de dettes ) à hauteur de 68.8% des cas. Les demandeurs de prêts font rouler leurs prêts, ils s’endettent de nouveau pour payer leurs anciens prêts.</p></li>\n\n<li><p style='text-align: justify'>La variable JOB distingue 6 types de demandeurs de prêts, dont l’ordre d’importance est : Other, ProfExe, Office, Mgr, Self et Sale.</p></li>\n\n</ul>","user":"imsduser","dateUpdated":"2022-03-15T10:55:33+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Concernant ces 2 seules variables qualitatives, nous pouvons constater que:</p>\n<ul>\n<li><p style='text-align: justify'>on voit que REASON qui indique le motif de demande du prêt a 2 modalités et la plus fréquente est DebtCon (Consolidation de dettes ) à hauteur de 68.8% des cas. Les demandeurs de prêts font rouler leurs prêts, ils s’endettent de nouveau pour payer leurs anciens prêts.</p></li>\n\n<li><p style='text-align: justify'>La variable JOB distingue 6 types de demandeurs de prêts, dont l’ordre d’importance est : Other, ProfExe, Office, Mgr, Self et Sale.</p></li>\n\n</ul>\n"}]},"apps":[],"jobName":"paragraph_1647042184372_-884116739","id":"20220312-004304_701967984","dateCreated":"2022-03-12T00:43:04+0100","dateStarted":"2022-03-15T10:55:33+0100","dateFinished":"2022-03-15T10:55:33+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37607"},{"text":"%md\n\n<h4 style=\"font-family: Verdana\"><font color=\"#D30543\"><strong> Les variables DEROG & DELINQ </strong></font></h4>","user":"imsduser","dateUpdated":"2022-03-15T23:44:30+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h4 style=\"font-family: Verdana\"><font color=\"#D30543\"><strong> Les variables DEROG & DELINQ </strong></font></h4>\n"}]},"apps":[],"jobName":"paragraph_1647042420396_607463325","id":"20220312-004700_1691996929","dateCreated":"2022-03-12T00:47:00+0100","dateStarted":"2022-03-15T23:44:12+0100","dateFinished":"2022-03-15T23:44:12+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37608"},{"text":"%jdbc(hive)\n\nSELECT derog, count(derog) as count_derog\nfrom score.hmeq\ngroup by derog","user":"imsduser","dateUpdated":"2022-03-12T19:36:57+0100","config":{"colWidth":6,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/sql","editorHide":false,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"derog\tcount_derog\nnull\t0\n0\t4526\n1\t435\n2\t160\n3\t58\n4\t23\n5\t15\n6\t15\n7\t8\n8\t6\n9\t3\n10\t2\n"}]},"apps":[],"jobName":"paragraph_1647042466263_1958209444","id":"20220312-004746_2076627826","dateCreated":"2022-03-12T00:47:46+0100","dateStarted":"2022-03-12T19:36:53+0100","dateFinished":"2022-03-12T19:37:01+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37609"},{"text":"%jdbc(hive)\n\nSELECT delinq, count(delinq) as count_delinq\nfrom score.hmeq\ngroup by delinq","user":"imsduser","dateUpdated":"2022-03-12T19:36:58+0100","config":{"colWidth":6,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"delinq\tcount_delinq\nnull\t0\n0\t4178\n1\t654\n2\t250\n3\t129\n4\t78\n5\t38\n6\t27\n7\t13\n8\t5\n10\t2\n11\t2\n12\t1\n13\t1\n15\t1\n"}]},"apps":[],"jobName":"paragraph_1647042506203_1087400090","id":"20220312-004826_625184039","dateCreated":"2022-03-12T00:48:26+0100","dateStarted":"2022-03-12T19:36:58+0100","dateFinished":"2022-03-12T19:37:05+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37610"},{"text":"%md\nNous pouvons constater que la majorité des demandeurs de prêts n'ont pas de cas dérogatoires majeurs.","user":"imsduser","dateUpdated":"2022-03-12T00:50:22+0100","config":{"colWidth":6,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Nous pouvons constater que la majorité des demandeurs de prêts n'ont pas de cas dérogatoires majeurs.</p>\n"}]},"apps":[],"jobName":"paragraph_1647042525863_760763598","id":"20220312-004845_1448869521","dateCreated":"2022-03-12T00:48:45+0100","dateStarted":"2022-03-12T00:50:22+0100","dateFinished":"2022-03-12T00:50:22+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37611"},{"text":"%md \nNous pouvons également voir que la majorité des demandeurs de prêts n'ont pas de lignes de crédit en défaut de paiement.","user":"imsduser","dateUpdated":"2022-03-12T00:50:28+0100","config":{"colWidth":6,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Nous pouvons également voir que la majorité des demandeurs de prêts n'ont pas de lignes de crédit en défaut de paiement.</p>\n"}]},"apps":[],"jobName":"paragraph_1647042511627_1608750174","id":"20220312-004831_546042001","dateCreated":"2022-03-12T00:48:31+0100","dateStarted":"2022-03-12T00:50:17+0100","dateFinished":"2022-03-12T00:50:22+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37612"},{"text":"%md\nVoici quelsques statistiques descriptives des variables numériques de notre dataset :\n\nOn voit que :\n\n  - Pour la variable LOAN, on a une moyenne de 18607 par montant demandé;  \n  - Pour DEBTINC les valeurs varient entre 0.52% et 203.31% avec 50% des taux d'endettemnt supérieurs à 34.8%;\n  - Pour VALUE (représente la valeur du bien actuel de l'emprunteur), on voit que les valeurs sont très dispersées autour de la moyenne, l'écart type est très élevé, et les biens valent en moyenne 101776$.\n    \nOn note une distribution désaxée vers la droite, ce qui signifie que nous avons une moyenne supérieure à la médiane. La médiane est une meilleure mesure de tendance centrale lorsque les distributions sont désaxées.\n\nToutes les variables quantitatives ont un écart à la moyenne faible donc elles sont bien centrées sauf pour LOAN, MORTDUE, VALUE qui ont un écart type important.\n\nConcernant les 2 seules variables qualitatives, on voit que REASON qui indique le motif de demande du prêt a 2 modalités. La plus fréquente est DebtCon (Consolidation de dettes) à hauteur de 68.8% des cas, et l'autre motif de prêt est HomeImp. Les demandeurs de prêts font rouler leurs prêts, ils s'endettent de nouveau pour payer leurs anciens prêts. La variable JOB distingue 6 types de demandeurs de prêts, dans l'ordre d'importance on a : Other, ProfExe, Office, Mgr, Self et Sales.","user":"imsduser","dateUpdated":"2022-03-15T20:49:58+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Voici quelsques statistiques descriptives des variables numériques de notre dataset :</p>\n<p>On voit que :</p>\n<ul>\n<li>Pour la variable LOAN, on a une moyenne de 18607 par montant demandé;</li>\n<li>Pour DEBTINC les valeurs varient entre 0.52% et 203.31% avec 50% des taux d'endettemnt supérieurs à 34.8%;</li>\n<li>Pour VALUE (représente la valeur du bien actuel de l'emprunteur), on voit que les valeurs sont très dispersées autour de la moyenne, l'écart type est très élevé, et les biens valent en moyenne 101776$.</li>\n</ul>\n<p>On note une distribution désaxée vers la droite, ce qui signifie que nous avons une moyenne supérieure à la médiane. La médiane est une meilleure mesure de tendance centrale lorsque les distributions sont désaxées.</p>\n<p>Toutes les variables quantitatives ont un écart à la moyenne faible donc elles sont bien centrées sauf pour LOAN, MORTDUE, VALUE qui ont un écart type important.</p>\n<p>Concernant les 2 seules variables qualitatives, on voit que REASON qui indique le motif de demande du prêt a 2 modalités. La plus fréquente est DebtCon (Consolidation de dettes) à hauteur de 68.8% des cas, et l'autre motif de prêt est HomeImp. Les demandeurs de prêts font rouler leurs prêts, ils s'endettent de nouveau pour payer leurs anciens prêts. La variable JOB distingue 6 types de demandeurs de prêts, dans l'ordre d'importance on a : Other, ProfExe, Office, Mgr, Self et Sales.</p>\n"}]},"apps":[],"jobName":"paragraph_1646932382467_-434757768","id":"20220310-181302_1444649487","dateCreated":"2022-03-10T18:13:02+0100","dateStarted":"2022-03-15T20:49:58+0100","dateFinished":"2022-03-15T20:49:58+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37613"},{"text":"%md\n<h3 style=\"font-family: Verdana\"><font color=\"#FF33F6\"><strong>2 - Analyse multivariée</strong></font></h3>","user":"imsduser","dateUpdated":"2022-03-16T16:40:47+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3 style=\"font-family: Verdana\"><font color=\"#FF33F6\"><strong>2 - Analyse multivariée</strong></font></h3>\n"}]},"apps":[],"jobName":"paragraph_1647006206234_1771077351","id":"20220311-144326_1495388754","dateCreated":"2022-03-11T14:43:26+0100","dateStarted":"2022-03-16T16:40:47+0100","dateFinished":"2022-03-16T16:40:47+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37614"},{"title":"Répartition de la variable Reason en fonction de BAD","text":"%jdbc(hive)\n\nSELECT reason,bad, count(*) as count\nfrom score.hmeq\ngroup by reason,bad","user":"imsduser","dateUpdated":"2022-03-12T19:37:56+0100","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{}},"commonSetting":{},"keys":[{"name":"reason","index":0,"aggr":"sum"}],"groups":[{"name":"bad","index":1,"aggr":"sum"}],"values":[{"name":"count","index":2,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"reason\tbad\tcount\n\t0\t204\n\t1\t48\nDebtCon\t0\t3183\nDebtCon\t1\t745\nHomeImp\t0\t1384\nHomeImp\t1\t395\n"}]},"apps":[],"jobName":"paragraph_1647042729811_-753917846","id":"20220312-005209_1043617682","dateCreated":"2022-03-12T00:52:09+0100","dateStarted":"2022-03-12T19:37:23+0100","dateFinished":"2022-03-12T19:37:30+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37615"},{"text":"%md\nNous pouvons constater que les personnes empruntant afin de consolider leurs dettes sont majoritaires peu importe la classe de la variable cible","user":"imsduser","dateUpdated":"2022-03-15T20:51:05+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Nous pouvons constater que les personnes empruntant afin de consolider leurs dettes sont majoritaires peu importe la classe de la variable cible</p>\n"}]},"apps":[],"jobName":"paragraph_1647042772269_542563354","id":"20220312-005252_143206760","dateCreated":"2022-03-12T00:52:52+0100","dateStarted":"2022-03-15T20:51:02+0100","dateFinished":"2022-03-15T20:51:03+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37616"},{"title":"Répartition de la variable Job en fonction de BAD","text":"%jdbc(hive)\n\nSELECT job,bad, count(*) as count\nfrom score.hmeq\ngroup by job,bad","user":"imsduser","dateUpdated":"2022-03-12T19:37:57+0100","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{}},"commonSetting":{},"keys":[{"name":"job","index":0,"aggr":"sum"}],"groups":[{"name":"bad","index":1,"aggr":"sum"}],"values":[{"name":"count","index":2,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"job\tbad\tcount\n\t0\t256\n\t1\t23\nMgr\t0\t588\nMgr\t1\t179\nOffice\t0\t823\nOffice\t1\t125\nOther\t0\t1834\nOther\t1\t553\nProfExe\t0\t1064\nProfExe\t1\t212\nSales\t0\t71\nSales\t1\t38\nSelf\t0\t135\nSelf\t1\t58\n"}]},"apps":[],"jobName":"paragraph_1647042997408_1974334961","id":"20220312-005637_626555175","dateCreated":"2022-03-12T00:56:37+0100","dateStarted":"2022-03-12T19:37:37+0100","dateFinished":"2022-03-12T19:37:39+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37617"},{"text":"%md\n\nConcernant la catégorie professionnelle des demandeurs de prêts, nous remarquons que les tendances des personnes en défaut sont similaires aux personnes ayant remboursé leurs prêts.","user":"imsduser","dateUpdated":"2022-03-15T20:51:30+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Concernant la catégorie professionnelle des demandeurs de prêts, nous remarquons que les tendances des personnes en défaut sont similaires aux personnes ayant remboursé leurs prêts.</p>\n"}]},"apps":[],"jobName":"paragraph_1647043043861_-1490451478","id":"20220312-005723_1455199367","dateCreated":"2022-03-12T00:57:23+0100","dateStarted":"2022-03-15T20:51:30+0100","dateFinished":"2022-03-15T20:51:30+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37618"},{"title":"Répartition de la variable Value en fonction de BAD","text":"%jdbc(hive)\n\nSELECT value,bad, count(*) as count, avg(value) as avg_value\nfrom score.hmeq\ngroup by value,bad","user":"imsduser","dateUpdated":"2022-03-12T19:37:57+0100","config":{"colWidth":6,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{},"scatterChart":{"xAxis":{"name":"value","index":0,"aggr":"sum"},"group":{"name":"bad","index":1,"aggr":"sum"},"size":{"name":"count","index":2,"aggr":"sum"}}},"keys":[{"name":"bad","index":1,"aggr":"sum"}],"groups":[],"values":[{"name":"avg_value","index":3,"aggr":"sum"}],"commonSetting":{}},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"value\tbad\tcount\tavg_value\nnull\t0\t21\tnull\nnull\t1\t315\tnull\n8000.0\t0\t3\t8000.0\n8800.0\t1\t3\t8800.0\n9100.0\t1\t3\t9100.0\n9500.0\t1\t3\t9500.0\n11550.0\t1\t3\t11550.0\n11702.0\t1\t3\t11702.0\n12414.0\t0\t3\t12414.0\n12500.0\t1\t3\t12500.0\n12737.0\t0\t3\t12737.0\n12972.0\t1\t3\t12972.0\n13770.0\t1\t3\t13770.0\n13930.0\t0\t3\t13930.0\n13933.0\t0\t3\t13933.0\n14100.0\t1\t3\t14100.0\n14500.0\t1\t3\t14500.0\n14580.0\t0\t3\t14580.0\n14609.0\t0\t3\t14609.0\n16020.0\t1\t3\t16020.0\n16365.0\t1\t3\t16365.0\n16700.0\t1\t2\t16700.0\n17180.0\t1\t3\t17180.0\n18000.0\t1\t3\t18000.0\n18361.0\t1\t3\t18361.0\n18600.0\t1\t3\t18600.0\n19000.0\t1\t3\t19000.0\n19132.0\t1\t3\t19132.0\n20200.0\t1\t3\t20200.0\n20300.0\t1\t3\t20300.0\n20494.0\t1\t3\t20494.0\n20631.0\t1\t3\t20631.0\n20700.0\t0\t3\t20700.0\n21144.0\t1\t3\t21144.0\n21500.0\t1\t3\t21500.0\n21510.0\t0\t3\t21510.0\n22092.0\t1\t3\t22092.0\n22399.0\t0\t3\t22399.0\n22971.0\t0\t3\t22971.0\n23031.0\t1\t3\t23031.0\n23200.0\t1\t3\t23200.0\n23400.0\t0\t3\t23400.0\n23636.0\t0\t3\t23636.0\n24457.0\t0\t3\t24457.0\n24770.0\t0\t3\t24770.0\n24808.0\t0\t3\t24808.0\n24811.0\t0\t3\t24811.0\n24869.0\t1\t3\t24869.0\n24894.0\t0\t3\t24894.0\n25000.0\t1\t6\t25000.0\n25010.0\t1\t3\t25010.0\n25250.0\t1\t3\t25250.0\n25300.0\t1\t3\t25300.0\n25425.0\t0\t3\t25425.0\n25552.0\t0\t3\t25552.0\n25566.0\t0\t3\t25566.0\n25850.0\t1\t3\t25850.0\n26000.0\t0\t3\t26000.0\n26100.0\t1\t3\t26100.0\n26140.0\t0\t3\t26140.0\n26400.0\t1\t3\t26400.0\n26450.0\t0\t3\t26450.0\n26500.0\t0\t3\t26500.0\n26507.0\t0\t3\t26507.0\n26550.0\t0\t3\t26550.0\n26600.0\t0\t3\t26600.0\n26699.0\t0\t3\t26699.0\n26715.0\t0\t3\t26715.0\n26732.0\t0\t3\t26732.0\n26809.0\t1\t3\t26809.0\n26850.0\t0\t3\t26850.0\n26958.0\t0\t3\t26958.0\n27136.0\t0\t3\t27136.0\n27410.0\t1\t3\t27410.0\n27439.0\t0\t3\t27439.0\n27500.0\t1\t3\t27500.0\n27750.0\t1\t3\t27750.0\n27779.0\t0\t3\t27779.0\n27781.0\t1\t3\t27781.0\n27873.0\t0\t3\t27873.0\n28000.0\t1\t3\t28000.0\n28198.0\t0\t3\t28198.0\n28291.0\t0\t3\t28291.0\n28437.5\t0\t3\t28437.5\n28593.0\t0\t3\t28593.0\n28600.0\t0\t3\t28600.0\n28635.0\t0\t3\t28635.0\n28639.0\t0\t3\t28639.0\n28900.0\t0\t3\t28900.0\n28981.0\t0\t3\t28981.0\n28992.0\t1\t3\t28992.0\n29025.0\t1\t3\t29025.0\n29115.0\t0\t3\t29115.0\n29168.0\t0\t3\t29168.0\n29374.0\t0\t3\t29374.0\n29375.0\t0\t3\t29375.0\n29375.0\t1\t3\t29375.0\n29387.0\t0\t3\t29387.0\n29412.0\t1\t3\t29412.0\n29512.0\t0\t3\t29512.0\n29725.0\t0\t3\t29725.0\n29750.0\t1\t3\t29750.0\n29792.0\t0\t3\t29792.0\n29800.0\t1\t3\t29800.0\n30000.0\t0\t3\t30000.0\n30000.0\t1\t3\t30000.0\n30198.0\t0\t3\t30198.0\n30320.0\t0\t3\t30320.0\n30395.0\t0\t3\t30395.0\n30436.0\t0\t3\t30436.0\n30451.0\t1\t3\t30451.0\n30455.0\t0\t3\t30455.0\n30500.0\t1\t3\t30500.0\n30544.0\t0\t3\t30544.0\n30625.0\t0\t3\t30625.0\n30695.0\t1\t3\t30695.0\n30700.0\t0\t3\t30700.0\n30807.0\t0\t3\t30807.0\n30809.0\t0\t3\t30809.0\n30813.0\t0\t3\t30813.0\n31196.0\t0\t3\t31196.0\n31200.0\t0\t3\t31200.0\n31352.0\t1\t3\t31352.0\n31414.0\t0\t3\t31414.0\n31531.0\t0\t3\t31531.0\n31602.0\t0\t3\t31602.0\n31666.0\t0\t3\t31666.0\n31671.0\t0\t3\t31671.0\n31681.0\t0\t3\t31681.0\n31777.0\t0\t3\t31777.0\n31843.0\t0\t3\t31843.0\n31900.0\t0\t3\t31900.0\n31920.0\t0\t3\t31920.0\n31953.0\t1\t3\t31953.0\n31960.0\t1\t3\t31960.0\n32200.0\t1\t3\t32200.0\n32220.0\t0\t3\t32220.0\n32221.0\t0\t3\t32221.0\n32287.0\t0\t3\t32287.0\n32289.0\t0\t3\t32289.0\n32357.0\t0\t3\t32357.0\n32365.0\t0\t3\t32365.0\n32480.0\t1\t3\t32480.0\n32500.0\t1\t3\t32500.0\n32559.0\t1\t3\t32559.0\n32584.0\t0\t3\t32584.0\n32855.0\t0\t3\t32855.0\n32907.0\t0\t3\t32907.0\n32981.0\t0\t3\t32981.0\n33000.0\t1\t3\t33000.0\n33100.0\t1\t6\t33100.0\n33269.0\t0\t3\t33269.0\n33353.0\t0\t3\t33353.0\n33382.0\t0\t3\t33382.0\n33438.0\t0\t3\t33438.0\n33450.0\t0\t3\t33450.0\n33540.0\t0\t3\t33540.0\n33580.0\t0\t3\t33580.0\n33664.0\t0\t3\t33664.0\n33879.0\t1\t3\t33879.0\n33888.0\t0\t3\t33888.0\n33909.0\t0\t3\t33909.0\n33926.0\t0\t3\t33926.0\n33938.0\t0\t3\t33938.0\n33975.0\t0\t3\t33975.0\n34000.0\t1\t6\t34000.0\n34225.0\t1\t3\t34225.0\n34226.0\t0\t3\t34226.0\n34254.0\t0\t3\t34254.0\n34294.0\t0\t3\t34294.0\n34443.0\t0\t3\t34443.0\n34462.0\t0\t3\t34462.0\n34477.0\t0\t3\t34477.0\n34687.0\t1\t3\t34687.0\n34704.0\t0\t3\t34704.0\n34705.0\t0\t3\t34705.0\n34777.0\t0\t3\t34777.0\n34800.0\t1\t3\t34800.0\n34846.0\t0\t3\t34846.0\n34886.0\t0\t3\t34886.0\n34900.0\t1\t3\t34900.0\n35000.0\t0\t6\t35000.0\n35000.0\t1\t6\t35000.0\n35183.0\t0\t3\t35183.0\n35184.0\t1\t3\t35184.0\n35200.0\t1\t3\t35200.0\n35250.0\t0\t6\t35250.0\n35261.0\t0\t3\t35261.0\n35271.0\t0\t3\t35271.0\n35300.0\t0\t3\t35300.0\n35396.0\t0\t3\t35396.0\n35397.0\t0\t3\t35397.0\n35402.0\t0\t3\t35402.0\n35422.0\t0\t3\t35422.0\n35461.0\t0\t3\t35461.0\n35500.0\t1\t3\t35500.0\n35543.0\t0\t3\t35543.0\n35675.0\t1\t3\t35675.0\n35684.0\t0\t3\t35684.0\n35792.0\t0\t3\t35792.0\n35836.0\t0\t3\t35836.0\n35875.06\t0\t3\t35875.05859375\n35900.0\t1\t3\t35900.0\n35910.0\t1\t3\t35910.0\n36002.0\t0\t3\t36002.0\n36078.0\t1\t3\t36078.0\n36082.0\t0\t3\t36082.0\n36100.0\t1\t3\t36100.0\n36133.0\t0\t3\t36133.0\n36191.0\t0\t3\t36191.0\n36195.0\t0\t3\t36195.0\n36277.0\t0\t3\t36277.0\n36300.0\t0\t3\t36300.0\n36350.0\t1\t3\t36350.0\n36369.0\t0\t3\t36369.0\n36375.0\t0\t3\t36375.0\n36385.0\t0\t3\t36385.0\n36392.0\t1\t3\t36392.0\n36425.0\t0\t3\t36425.0\n36474.0\t0\t3\t36474.0\n36486.0\t0\t3\t36486.0\n36524.0\t0\t3\t36524.0\n36527.0\t0\t3\t36527.0\n36600.0\t1\t3\t36600.0\n36605.0\t0\t3\t36605.0\n36672.0\t0\t3\t36672.0\n36721.0\t1\t3\t36721.0\n36739.0\t1\t3\t36739.0\n36793.0\t0\t3\t36793.0\n36810.0\t1\t3\t36810.0\n36811.0\t1\t3\t36811.0\n36892.0\t0\t3\t36892.0\n36922.0\t0\t3\t36922.0\n37076.0\t0\t3\t37076.0\n37079.0\t0\t3\t37079.0\n37125.0\t0\t3\t37125.0\n37125.0\t1\t3\t37125.0\n37200.0\t1\t3\t37200.0\n37244.0\t0\t3\t37244.0\n37245.0\t0\t3\t37245.0\n37286.0\t0\t3\t37286.0\n37310.0\t0\t3\t37310.0\n37333.0\t0\t3\t37333.0\n37345.0\t0\t3\t37345.0\n37363.0\t0\t3\t37363.0\n37391.0\t0\t3\t37391.0\n37433.0\t0\t3\t37433.0\n37448.0\t0\t3\t37448.0\n37500.0\t1\t3\t37500.0\n37531.0\t0\t3\t37531.0\n37533.0\t1\t3\t37533.0\n37539.0\t0\t3\t37539.0\n37598.0\t0\t3\t37598.0\n37700.0\t1\t3\t37700.0\n37717.0\t0\t3\t37717.0\n37881.0\t0\t3\t37881.0\n37882.0\t0\t3\t37882.0\n37980.0\t0\t3\t37980.0\n38000.0\t0\t6\t38000.0\n38000.0\t1\t3\t38000.0\n38061.0\t0\t3\t38061.0\n38094.0\t0\t3\t38094.0\n38246.0\t0\t3\t38246.0\n38290.0\t0\t3\t38290.0\n38311.0\t0\t3\t38311.0\n38356.0\t0\t3\t38356.0\n38412.0\t0\t3\t38412.0\n38437.0\t0\t3\t38437.0\n38441.0\t0\t3\t38441.0\n38480.0\t1\t3\t38480.0\n38500.0\t1\t3\t38500.0\n38575.0\t1\t3\t38575.0\n38577.0\t0\t3\t38577.0\n38583.0\t0\t3\t38583.0\n38584.0\t0\t3\t38584.0\n38648.0\t0\t3\t38648.0\n38666.0\t1\t3\t38666.0\n38750.0\t1\t3\t38750.0\n38774.0\t0\t3\t38774.0\n38900.0\t1\t3\t38900.0\n38952.0\t1\t3\t38952.0\n38964.0\t0\t3\t38964.0\n39000.0\t0\t3\t39000.0\n39000.0\t1\t9\t39000.0\n39025.0\t1\t2\t39025.0\n39050.0\t0\t3\t39050.0\n39052.0\t0\t3\t39052.0\n39102.0\t0\t3\t39102.0\n39106.0\t0\t3\t39106.0\n39188.0\t0\t3\t39188.0\n39200.0\t0\t3\t39200.0\n39264.0\t0\t3\t39264.0\n39285.0\t0\t3\t39285.0\n39293.0\t1\t3\t39293.0\n39326.0\t0\t3\t39326.0\n39333.0\t0\t3\t39333.0\n39401.0\t0\t3\t39401.0\n39431.0\t1\t3\t39431.0\n39433.0\t0\t3\t39433.0\n39527.0\t1\t3\t39527.0\n39604.0\t1\t3\t39604.0\n39605.0\t0\t3\t39605.0\n39660.0\t1\t3\t39660.0\n39710.0\t0\t3\t39710.0\n39723.0\t0\t3\t39723.0\n39746.0\t0\t3\t39746.0\n39750.0\t1\t3\t39750.0\n39816.0\t1\t3\t39816.0\n39858.0\t0\t3\t39858.0\n39880.0\t0\t3\t39880.0\n39907.0\t0\t3\t39907.0\n39992.0\t1\t3\t39992.0\n40000.0\t0\t3\t40000.0\n40000.0\t1\t6\t40000.0\n40098.0\t0\t3\t40098.0\n40116.0\t0\t3\t40116.0\n40143.0\t0\t3\t40143.0\n40150.0\t0\t3\t40150.0\n40150.0\t1\t6\t40150.0\n40185.0\t0\t3\t40185.0\n40200.0\t1\t3\t40200.0\n40268.0\t0\t3\t40268.0\n40300.0\t1\t3\t40300.0\n40320.0\t1\t3\t40320.0\n40341.0\t0\t3\t40341.0\n40356.0\t0\t3\t40356.0\n40456.0\t1\t3\t40456.0\n40515.0\t0\t3\t40515.0\n40700.0\t1\t3\t40700.0\n40739.0\t0\t3\t40739.0\n40754.0\t0\t3\t40754.0\n40798.0\t1\t3\t40798.0\n40800.0\t1\t3\t40800.0\n40807.0\t0\t3\t40807.0\n40834.0\t1\t3\t40834.0\n40848.0\t0\t3\t40848.0\n40881.0\t0\t3\t40881.0\n40908.0\t0\t3\t40908.0\n41055.0\t0\t3\t41055.0\n41075.0\t0\t3\t41075.0\n41119.0\t0\t3\t41119.0\n41250.0\t1\t3\t41250.0\n41299.0\t0\t3\t41299.0\n41396.0\t0\t6\t41396.0\n41438.0\t0\t3\t41438.0\n41500.0\t1\t3\t41500.0\n41600.0\t1\t3\t41600.0\n41657.0\t0\t3\t41657.0\n41677.0\t0\t3\t41677.0\n41763.0\t0\t3\t41763.0\n41835.0\t0\t3\t41835.0\n41856.0\t1\t3\t41856.0\n41870.0\t0\t3\t41870.0\n41879.0\t0\t3\t41879.0\n41900.0\t1\t3\t41900.0\n41950.0\t1\t3\t41950.0\n41987.0\t0\t3\t41987.0\n42000.0\t1\t6\t42000.0\n42013.0\t0\t3\t42013.0\n42050.0\t1\t3\t42050.0\n42075.0\t1\t3\t42075.0\n42189.0\t0\t3\t42189.0\n42289.0\t1\t3\t42289.0\n42309.0\t0\t3\t42309.0\n42320.0\t0\t3\t42320.0\n42328.0\t0\t3\t42328.0\n42408.0\t0\t3\t42408.0\n42495.0\t1\t3\t42495.0\n42497.0\t0\t3\t42497.0\n42500.0\t0\t3\t42500.0\n42500.0\t1\t3\t42500.0\n42515.0\t0\t3\t42515.0\n42517.0\t0\t3\t42517.0\n42590.0\t0\t3\t42590.0\n42623.0\t0\t3\t42623.0\n42629.0\t0\t3\t42629.0\n42634.0\t0\t3\t42634.0\n42682.0\t0\t3\t42682.0\n42695.0\t0\t3\t42695.0\n42722.0\t0\t3\t42722.0\n42751.0\t0\t3\t42751.0\n42770.0\t1\t3\t42770.0\n42800.0\t0\t3\t42800.0\n42834.0\t0\t3\t42834.0\n42845.01\t1\t3\t42845.01171875\n42894.0\t0\t3\t42894.0\n42980.0\t0\t3\t42980.0\n43026.0\t0\t3\t43026.0\n43028.0\t0\t3\t43028.0\n43031.0\t0\t3\t43031.0\n43034.0\t1\t3\t43034.0\n43040.0\t1\t3\t43040.0\n43076.0\t0\t3\t43076.0\n43078.0\t0\t3\t43078.0\n43082.0\t0\t3\t43082.0\n43132.0\t1\t3\t43132.0\n43157.0\t0\t3\t43157.0\n43218.0\t0\t3\t43218.0\n43277.0\t0\t3\t43277.0\n43300.0\t0\t3\t43300.0\n43310.0\t0\t3\t43310.0\n43334.0\t0\t3\t43334.0\n43358.0\t0\t3\t43358.0\n43371.0\t0\t3\t43371.0\n43403.0\t0\t3\t43403.0\n43472.0\t0\t3\t43472.0\n43475.0\t0\t3\t43475.0\n43500.0\t1\t3\t43500.0\n43531.0\t0\t3\t43531.0\n43600.0\t1\t3\t43600.0\n43683.0\t1\t3\t43683.0\n43684.0\t0\t3\t43684.0\n43726.0\t0\t3\t43726.0\n43740.0\t1\t3\t43740.0\n43790.0\t0\t3\t43790.0\n43823.0\t0\t3\t43823.0\n43880.0\t0\t3\t43880.0\n43899.0\t0\t3\t43899.0\n43900.0\t1\t3\t43900.0\n43962.0\t1\t3\t43962.0\n43982.0\t0\t3\t43982.0\n44000.0\t1\t3\t44000.0\n44066.0\t0\t3\t44066.0\n44083.0\t1\t3\t44083.0\n44092.0\t0\t3\t44092.0\n44108.0\t0\t3\t44108.0\n44138.0\t0\t3\t44138.0\n44144.0\t0\t3\t44144.0\n44157.0\t1\t3\t44157.0\n44165.0\t0\t3\t44165.0\n44166.0\t1\t3\t44166.0\n44195.0\t0\t6\t44195.0\n44218.0\t0\t3\t44218.0\n44220.0\t0\t3\t44220.0\n44379.0\t0\t3\t44379.0\n44417.0\t0\t3\t44417.0\n44459.0\t0\t3\t44459.0\n44461.0\t0\t3\t44461.0\n44516.0\t0\t3\t44516.0\n44605.0\t1\t3\t44605.0\n44651.0\t0\t3\t44651.0\n44707.0\t0\t3\t44707.0\n44716.0\t0\t3\t44716.0\n44735.0\t0\t3\t44735.0\n44761.0\t0\t3\t44761.0\n44849.0\t0\t3\t44849.0\n44866.0\t0\t3\t44866.0\n44901.0\t0\t3\t44901.0\n45000.0\t0\t6\t45000.0\n45000.0\t1\t9\t45000.0\n45119.0\t0\t3\t45119.0\n45167.0\t0\t3\t45167.0\n45175.0\t0\t3\t45175.0\n45187.0\t0\t3\t45187.0\n45197.0\t0\t3\t45197.0\n45200.0\t1\t3\t45200.0\n45209.0\t0\t3\t45209.0\n45270.0\t0\t3\t45270.0\n45369.0\t0\t3\t45369.0\n45495.0\t0\t3\t45495.0\n45550.0\t0\t3\t45550.0\n45557.0\t0\t3\t45557.0\n45640.0\t0\t3\t45640.0\n45654.0\t1\t3\t45654.0\n45657.0\t0\t3\t45657.0\n45744.0\t0\t3\t45744.0\n45760.0\t0\t3\t45760.0\n45764.0\t0\t3\t45764.0\n45819.0\t0\t3\t45819.0\n45841.0\t0\t3\t45841.0\n45900.0\t1\t6\t45900.0\n45906.0\t0\t3\t45906.0\n45913.0\t0\t3\t45913.0\n45924.0\t1\t3\t45924.0\n45956.0\t1\t3\t45956.0\n45960.0\t1\t3\t45960.0\n46000.0\t0\t6\t46000.0\n46000.0\t1\t3\t46000.0\n46045.0\t0\t3\t46045.0\n46053.0\t0\t3\t46053.0\n46091.0\t0\t3\t46091.0\n46140.0\t0\t3\t46140.0\n46195.0\t1\t3\t46195.0\n46200.0\t1\t6\t46200.0\n46277.0\t0\t3\t46277.0\n46281.0\t0\t3\t46281.0\n46286.0\t0\t3\t46286.0\n46351.0\t0\t3\t46351.0\n46357.0\t0\t3\t46357.0\n46382.0\t1\t3\t46382.0\n46466.26\t0\t3\t46466.26171875\n46500.0\t0\t3\t46500.0\n46516.0\t0\t3\t46516.0\n46520.0\t1\t3\t46520.0\n46571.0\t0\t3\t46571.0\n46600.0\t1\t3\t46600.0\n46645.0\t1\t3\t46645.0\n46665.0\t0\t3\t46665.0\n46697.0\t0\t3\t46697.0\n46735.0\t0\t3\t46735.0\n46735.0\t1\t3\t46735.0\n46740.0\t1\t3\t46740.0\n46780.0\t0\t3\t46780.0\n46830.0\t0\t3\t46830.0\n46833.0\t1\t3\t46833.0\n46846.0\t0\t3\t46846.0\n46883.0\t0\t3\t46883.0\n46925.0\t1\t3\t46925.0\n46993.0\t0\t3\t46993.0\n47027.0\t1\t3\t47027.0\n47042.0\t0\t3\t47042.0\n47061.0\t0\t3\t47061.0\n47177.0\t0\t3\t47177.0\n47220.0\t0\t3\t47220.0\n47244.0\t1\t3\t47244.0\n47338.0\t0\t3\t47338.0\n47350.0\t1\t3\t47350.0\n47377.0\t0\t3\t47377.0\n47386.0\t0\t3\t47386.0\n47387.0\t1\t3\t47387.0\n47394.0\t1\t3\t47394.0\n47400.0\t0\t3\t47400.0\n47462.0\t0\t3\t47462.0\n47471.0\t1\t3\t47471.0\n47537.0\t0\t3\t47537.0\n47548.0\t0\t3\t47548.0\n47568.0\t0\t3\t47568.0\n47615.0\t0\t3\t47615.0\n47622.0\t0\t3\t47622.0\n47669.0\t0\t3\t47669.0\n47700.0\t0\t3\t47700.0\n47737.0\t0\t3\t47737.0\n47791.0\t0\t3\t47791.0\n47805.0\t0\t3\t47805.0\n47842.0\t0\t3\t47842.0\n47894.0\t0\t3\t47894.0\n47905.0\t0\t3\t47905.0\n47954.0\t0\t3\t47954.0\n47990.0\t0\t3\t47990.0\n48000.0\t0\t3\t48000.0\n48000.0\t1\t6\t48000.0\n48095.0\t0\t3\t48095.0\n48125.0\t0\t3\t48125.0\n48150.0\t0\t3\t48150.0\n48240.0\t0\t3\t48240.0\n48276.0\t0\t3\t48276.0\n48278.0\t1\t3\t48278.0\n48291.0\t0\t3\t48291.0\n48309.0\t0\t3\t48309.0\n48319.0\t0\t3\t48319.0\n48361.0\t0\t3\t48361.0\n48362.0\t0\t3\t48362.0\n48375.0\t0\t3\t48375.0\n48393.0\t0\t3\t48393.0\n48467.0\t0\t3\t48467.0\n48475.0\t0\t3\t48475.0\n48500.0\t0\t3\t48500.0\n48502.0\t1\t3\t48502.0\n48535.0\t0\t3\t48535.0\n48574.0\t1\t3\t48574.0\n48587.0\t0\t3\t48587.0\n48600.0\t1\t3\t48600.0\n48626.0\t0\t3\t48626.0\n48700.0\t1\t3\t48700.0\n48800.0\t0\t6\t48800.0\n48800.0\t1\t3\t48800.0\n48905.0\t0\t6\t48905.0\n48908.0\t0\t3\t48908.0\n48971.0\t0\t3\t48971.0\n49000.0\t0\t9\t49000.0\n49000.0\t1\t3\t49000.0\n49041.0\t0\t3\t49041.0\n49044.0\t0\t3\t49044.0\n49060.0\t1\t3\t49060.0\n49100.0\t0\t3\t49100.0\n49147.0\t0\t3\t49147.0\n49244.0\t0\t3\t49244.0\n49266.0\t0\t3\t49266.0\n49326.0\t1\t3\t49326.0\n49331.0\t0\t3\t49331.0\n49362.0\t0\t3\t49362.0\n49396.0\t0\t3\t49396.0\n49433.0\t0\t3\t49433.0\n49442.0\t0\t3\t49442.0\n49495.0\t0\t3\t49495.0\n49523.0\t0\t3\t49523.0\n49525.0\t0\t3\t49525.0\n49600.0\t0\t3\t49600.0\n49621.0\t0\t3\t49621.0\n49750.0\t1\t3\t49750.0\n49756.0\t1\t3\t49756.0\n49794.0\t0\t3\t49794.0\n49804.0\t0\t3\t49804.0\n49836.0\t0\t3\t49836.0\n49840.0\t1\t3\t49840.0\n49842.0\t0\t3\t49842.0\n49843.0\t0\t3\t49843.0\n49906.0\t0\t3\t49906.0\n49912.0\t0\t3\t49912.0\n49950.0\t0\t3\t49950.0\n49970.0\t1\t3\t49970.0\n50000.0\t0\t9\t50000.0\n50000.0\t1\t15\t50000.0\n50006.0\t0\t3\t50006.0\n50061.0\t0\t3\t50061.0\n50070.0\t0\t3\t50070.0\n50125.0\t1\t3\t50125.0\n50150.0\t0\t3\t50150.0\n50177.0\t0\t3\t50177.0\n50225.0\t0\t3\t50225.0\n50225.0\t1\t3\t50225.0\n50262.0\t0\t3\t50262.0\n50309.0\t0\t6\t50309.0\n50340.0\t0\t3\t50340.0\n50375.0\t0\t3\t50375.0\n50386.0\t0\t3\t50386.0\n50391.0\t0\t3\t50391.0\n50409.0\t0\t3\t50409.0\n50434.0\t0\t3\t50434.0\n50448.0\t0\t3\t50448.0\n50486.0\t0\t3\t50486.0\n50493.0\t0\t3\t50493.0\n50530.0\t0\t3\t50530.0\n50534.0\t0\t3\t50534.0\n50548.0\t0\t3\t50548.0\n50575.0\t0\t3\t50575.0\n50594.0\t0\t3\t50594.0\n50602.0\t0\t3\t50602.0\n50673.0\t0\t3\t50673.0\n50681.0\t1\t3\t50681.0\n50688.0\t0\t3\t50688.0\n50696.0\t0\t3\t50696.0\n50704.0\t0\t3\t50704.0\n50725.0\t1\t3\t50725.0\n50732.0\t0\t3\t50732.0\n50750.0\t0\t3\t50750.0\n50760.0\t0\t3\t50760.0\n50798.0\t0\t3\t50798.0\n50800.0\t1\t3\t50800.0\n50830.0\t1\t3\t50830.0\n50848.0\t0\t3\t50848.0\n50872.0\t0\t3\t50872.0\n50892.0\t0\t3\t50892.0\n50900.0\t0\t3\t50900.0\n50931.0\t0\t3\t50931.0\n50933.0\t0\t3\t50933.0\n50963.0\t0\t3\t50963.0\n51000.0\t0\t3\t51000.0\n51023.0\t0\t3\t51023.0\n51053.0\t0\t3\t51053.0\n51055.0\t0\t3\t51055.0\n51057.0\t1\t3\t51057.0\n51068.0\t0\t3\t51068.0\n51123.0\t0\t3\t51123.0\n51165.0\t0\t3\t51165.0\n51189.0\t0\t3\t51189.0\n51246.0\t0\t3\t51246.0\n51337.0\t0\t3\t51337.0\n51389.0\t0\t3\t51389.0\n51454.0\t0\t3\t51454.0\n51496.0\t0\t3\t51496.0\n51549.0\t0\t3\t51549.0\n51599.0\t0\t3\t51599.0\n51607.0\t0\t3\t51607.0\n51610.0\t1\t3\t51610.0\n51623.0\t0\t3\t51623.0\n51631.0\t0\t3\t51631.0\n51653.0\t0\t3\t51653.0\n51666.0\t0\t3\t51666.0\n51680.0\t0\t3\t51680.0\n51684.0\t0\t3\t51684.0\n51703.0\t0\t3\t51703.0\n51720.0\t0\t3\t51720.0\n51732.0\t0\t3\t51732.0\n51740.0\t0\t3\t51740.0\n51792.0\t0\t3\t51792.0\n51800.0\t0\t3\t51800.0\n51821.0\t0\t3\t51821.0\n51823.0\t0\t3\t51823.0\n51824.0\t0\t3\t51824.0\n51841.0\t0\t3\t51841.0\n51846.0\t0\t3\t51846.0\n51900.0\t1\t3\t51900.0\n51952.0\t0\t3\t51952.0\n51974.0\t0\t3\t51974.0\n51984.0\t0\t3\t51984.0\n51986.0\t0\t3\t51986.0\n51990.0\t0\t3\t51990.0\n51994.0\t0\t3\t51994.0\n52000.0\t0\t3\t52000.0\n52000.0\t1\t9\t52000.0\n52012.0\t1\t3\t52012.0\n52016.0\t0\t3\t52016.0\n52026.0\t0\t3\t52026.0\n52029.0\t0\t3\t52029.0\n52040.0\t0\t6\t52040.0\n52054.0\t0\t3\t52054.0\n52228.0\t0\t3\t52228.0\n52234.0\t0\t3\t52234.0\n52320.0\t0\t3\t52320.0\n52329.0\t0\t3\t52329.0\n52340.0\t0\t3\t52340.0\n52355.0\t0\t3\t52355.0\n52411.0\t0\t3\t52411.0\n52422.0\t0\t3\t52422.0\n52457.0\t0\t3\t52457.0\n52482.0\t0\t3\t52482.0\n52490.0\t1\t3\t52490.0\n52544.0\t0\t3\t52544.0\n52545.0\t1\t3\t52545.0\n52554.0\t0\t3\t52554.0\n52710.0\t0\t3\t52710.0\n52800.0\t0\t3\t52800.0\n52804.0\t0\t3\t52804.0\n52822.0\t0\t3\t52822.0\n52910.0\t0\t3\t52910.0\n52911.0\t0\t3\t52911.0\n52938.0\t0\t3\t52938.0\n52946.0\t0\t3\t52946.0\n53000.0\t0\t3\t53000.0\n53040.0\t0\t3\t53040.0\n53078.0\t0\t3\t53078.0\n53079.0\t0\t3\t53079.0\n53095.0\t1\t3\t53095.0\n53100.0\t1\t3\t53100.0\n53102.0\t0\t3\t53102.0\n53120.0\t0\t3\t53120.0\n53149.0\t0\t3\t53149.0\n53184.0\t0\t3\t53184.0\n53190.0\t0\t3\t53190.0\n53200.0\t0\t3\t53200.0\n53214.0\t0\t3\t53214.0\n53238.0\t0\t3\t53238.0\n53300.0\t0\t3\t53300.0\n53321.0\t0\t3\t53321.0\n53365.0\t0\t3\t53365.0\n53388.0\t0\t3\t53388.0\n53434.0\t0\t3\t53434.0\n53448.0\t0\t3\t53448.0\n53462.0\t0\t3\t53462.0\n53500.0\t1\t3\t53500.0\n53511.0\t0\t3\t53511.0\n53521.0\t0\t3\t53521.0\n53543.0\t0\t3\t53543.0\n53622.0\t0\t3\t53622.0\n53683.0\t0\t3\t53683.0\n53754.0\t0\t3\t53754.0\n53758.0\t0\t3\t53758.0\n53800.0\t1\t3\t53800.0\n53807.0\t0\t3\t53807.0\n53814.0\t0\t3\t53814.0\n53877.0\t0\t3\t53877.0\n53893.0\t0\t3\t53893.0\n53907.0\t0\t3\t53907.0\n53907.0\t1\t3\t53907.0\n53943.0\t0\t3\t53943.0\n53969.0\t1\t3\t53969.0\n54000.0\t0\t9\t54000.0\n54000.0\t1\t6\t54000.0\n54024.0\t0\t3\t54024.0\n54038.0\t0\t3\t54038.0\n54040.0\t0\t3\t54040.0\n54046.0\t0\t3\t54046.0\n54049.0\t1\t3\t54049.0\n54065.0\t0\t3\t54065.0\n54073.0\t0\t3\t54073.0\n54138.0\t0\t3\t54138.0\n54146.0\t1\t3\t54146.0\n54212.0\t0\t3\t54212.0\n54299.0\t0\t3\t54299.0\n54300.0\t1\t3\t54300.0\n54314.0\t0\t3\t54314.0\n54375.0\t1\t3\t54375.0\n54378.0\t0\t3\t54378.0\n54385.0\t0\t3\t54385.0\n54436.0\t0\t3\t54436.0\n54452.0\t0\t3\t54452.0\n54464.0\t0\t3\t54464.0\n54499.0\t0\t3\t54499.0\n54500.0\t1\t3\t54500.0\n54522.0\t0\t3\t54522.0\n54536.0\t1\t3\t54536.0\n54557.0\t0\t3\t54557.0\n54561.0\t0\t3\t54561.0\n54563.0\t0\t3\t54563.0\n54600.0\t1\t6\t54600.0\n54605.0\t0\t3\t54605.0\n54701.0\t0\t3\t54701.0\n54707.0\t0\t3\t54707.0\n54775.0\t0\t3\t54775.0\n54869.0\t1\t3\t54869.0\n54904.0\t1\t3\t54904.0\n54905.0\t0\t3\t54905.0\n54923.0\t0\t3\t54923.0\n54966.0\t0\t3\t54966.0\n54970.0\t0\t3\t54970.0\n54976.0\t0\t3\t54976.0\n54985.0\t0\t3\t54985.0\n55000.0\t0\t3\t55000.0\n55000.0\t1\t18\t55000.0\n55024.0\t0\t3\t55024.0\n55027.0\t0\t3\t55027.0\n55079.0\t0\t3\t55079.0\n55085.0\t0\t3\t55085.0\n55100.0\t0\t3\t55100.0\n55114.0\t0\t3\t55114.0\n55299.0\t0\t3\t55299.0\n55320.0\t0\t3\t55320.0\n55320.0\t1\t3\t55320.0\n55350.0\t0\t3\t55350.0\n55376.0\t0\t3\t55376.0\n55396.0\t0\t3\t55396.0\n55419.0\t0\t3\t55419.0\n55421.0\t0\t3\t55421.0\n55455.0\t0\t3\t55455.0\n55483.0\t0\t3\t55483.0\n55500.0\t0\t3\t55500.0\n55500.0\t1\t3\t55500.0\n55549.0\t0\t3\t55549.0\n55578.0\t0\t3\t55578.0\n55582.0\t0\t3\t55582.0\n55657.0\t1\t3\t55657.0\n55669.0\t0\t3\t55669.0\n55700.0\t0\t3\t55700.0\n55703.0\t0\t3\t55703.0\n55728.0\t0\t3\t55728.0\n55734.0\t0\t3\t55734.0\n55757.0\t0\t3\t55757.0\n55760.0\t0\t3\t55760.0\n55764.0\t0\t3\t55764.0\n55784.0\t0\t3\t55784.0\n55796.0\t0\t3\t55796.0\n55848.0\t0\t3\t55848.0\n56000.0\t1\t12\t56000.0\n56088.0\t0\t3\t56088.0\n56100.0\t0\t3\t56100.0\n56134.0\t0\t3\t56134.0\n56206.0\t0\t3\t56206.0\n56218.0\t0\t3\t56218.0\n56235.0\t0\t3\t56235.0\n56236.0\t0\t3\t56236.0\n56247.0\t1\t3\t56247.0\n56295.0\t0\t3\t56295.0\n56373.0\t0\t3\t56373.0\n56374.0\t0\t3\t56374.0\n56386.0\t0\t3\t56386.0\n56390.0\t0\t3\t56390.0\n56394.0\t0\t3\t56394.0\n56400.0\t0\t3\t56400.0\n56402.0\t0\t3\t56402.0\n56429.0\t0\t3\t56429.0\n56465.0\t0\t3\t56465.0\n56475.0\t0\t3\t56475.0\n56481.0\t0\t3\t56481.0\n56486.0\t0\t3\t56486.0\n56514.0\t0\t3\t56514.0\n56529.0\t1\t3\t56529.0\n56532.0\t0\t3\t56532.0\n56535.0\t0\t3\t56535.0\n56571.0\t0\t3\t56571.0\n56600.0\t0\t3\t56600.0\n56631.0\t0\t3\t56631.0\n56639.0\t0\t3\t56639.0\n56656.0\t0\t3\t56656.0\n56658.0\t0\t3\t56658.0\n56733.0\t0\t3\t56733.0\n56776.0\t0\t3\t56776.0\n56782.0\t0\t3\t56782.0\n56824.0\t0\t3\t56824.0\n56834.0\t0\t3\t56834.0\n56851.0\t0\t3\t56851.0\n56874.0\t1\t3\t56874.0\n56900.0\t0\t3\t56900.0\n56961.0\t0\t3\t56961.0\n57000.0\t0\t6\t57000.0\n57000.0\t1\t6\t57000.0\n57036.0\t0\t6\t57036.0\n57037.0\t1\t3\t57037.0\n57048.0\t0\t3\t57048.0\n57067.0\t0\t3\t57067.0\n57081.0\t0\t3\t57081.0\n57095.0\t0\t3\t57095.0\n57109.0\t0\t3\t57109.0\n57125.0\t0\t3\t57125.0\n57132.0\t0\t3\t57132.0\n57135.0\t0\t3\t57135.0\n57150.0\t0\t3\t57150.0\n57151.0\t0\t3\t57151.0\n57156.0\t0\t3\t57156.0\n57182.0\t0\t3\t57182.0\n57184.0\t0\t3\t57184.0\n57224.0\t0\t3\t57224.0\n57276.0\t0\t3\t57276.0\n57280.0\t0\t6\t57280.0\n57285.0\t0\t3\t57285.0\n57310.0\t0\t3\t57310.0\n57311.0\t0\t3\t57311.0\n57365.0\t0\t3\t57365.0\n57385.0\t1\t3\t57385.0\n57420.0\t0\t3\t57420.0\n57436.0\t0\t3\t57436.0\n57444.0\t0\t3\t57444.0\n57453.0\t1\t3\t57453.0\n57460.0\t0\t3\t57460.0\n57473.0\t0\t3\t57473.0\n57500.0\t0\t3\t57500.0\n57501.0\t0\t3\t57501.0\n57507.0\t0\t3\t57507.0\n57518.0\t1\t3\t57518.0\n57608.0\t0\t3\t57608.0\n57622.0\t0\t3\t57622.0\n57650.0\t0\t3\t57650.0\n57680.0\t0\t3\t57680.0\n57682.0\t0\t3\t57682.0\n57686.0\t0\t3\t57686.0\n57713.0\t0\t3\t57713.0\n57742.0\t0\t3\t57742.0\n57761.0\t0\t3\t57761.0\n57779.0\t0\t3\t57779.0\n57787.0\t0\t3\t57787.0\n57799.0\t0\t3\t57799.0\n57822.0\t0\t3\t57822.0\n57831.0\t0\t3\t57831.0\n57838.0\t0\t3\t57838.0\n57839.0\t0\t3\t57839.0\n57862.0\t0\t3\t57862.0\n57905.0\t0\t3\t57905.0\n57912.0\t0\t3\t57912.0\n57923.0\t0\t3\t57923.0\n57940.0\t0\t3\t57940.0\n57986.0\t0\t3\t57986.0\n57991.0\t0\t3\t57991.0\n58000.0\t1\t12\t58000.0\n58049.0\t0\t3\t58049.0\n58056.0\t0\t3\t58056.0\n58074.0\t0\t3\t58074.0\n58084.0\t0\t3\t58084.0\n58088.0\t1\t3\t58088.0\n58089.0\t0\t3\t58089.0\n58157.0\t0\t6\t58157.0\n58191.0\t0\t3\t58191.0\n58216.0\t0\t3\t58216.0\n58238.0\t1\t3\t58238.0\n58240.0\t0\t3\t58240.0\n58249.0\t0\t3\t58249.0\n58275.0\t1\t3\t58275.0\n58282.0\t0\t3\t58282.0\n58305.0\t0\t3\t58305.0\n58305.0\t1\t3\t58305.0\n58313.0\t0\t3\t58313.0\n58329.0\t0\t3\t58329.0\n58336.0\t0\t3\t58336.0\n58338.0\t0\t3\t58338.0\n58350.0\t1\t3\t58350.0\n58407.0\t0\t3\t58407.0\n58488.0\t1\t3\t58488.0\n58511.0\t0\t3\t58511.0\n58513.0\t0\t3\t58513.0\n58541.0\t0\t3\t58541.0\n58563.0\t0\t3\t58563.0\n58588.0\t0\t3\t58588.0\n58600.0\t0\t3\t58600.0\n58605.0\t0\t3\t58605.0\n58714.0\t0\t3\t58714.0\n58740.0\t1\t3\t58740.0\n58745.0\t0\t3\t58745.0\n58756.0\t0\t3\t58756.0\n58760.0\t1\t3\t58760.0\n58822.0\t0\t3\t58822.0\n58827.0\t0\t3\t58827.0\n58834.0\t0\t3\t58834.0\n58837.0\t0\t3\t58837.0\n58856.0\t0\t3\t58856.0\n58938.0\t0\t3\t58938.0\n58947.0\t0\t3\t58947.0\n58995.0\t1\t3\t58995.0\n59000.0\t0\t15\t59000.0\n59000.0\t1\t3\t59000.0\n59025.0\t0\t3\t59025.0\n59097.0\t0\t3\t59097.0\n59111.0\t0\t3\t59111.0\n59137.0\t0\t3\t59137.0\n59173.0\t0\t3\t59173.0\n59196.0\t0\t3\t59196.0\n59218.0\t0\t3\t59218.0\n59240.0\t0\t3\t59240.0\n59247.0\t0\t3\t59247.0\n59309.0\t0\t3\t59309.0\n59323.0\t0\t3\t59323.0\n59348.0\t1\t3\t59348.0\n59375.0\t0\t3\t59375.0\n59375.0\t1\t3\t59375.0\n59413.0\t0\t3\t59413.0\n59415.0\t0\t3\t59415.0\n59418.0\t0\t3\t59418.0\n59482.0\t0\t3\t59482.0\n59486.0\t0\t3\t59486.0\n59500.0\t0\t3\t59500.0\n59502.0\t0\t3\t59502.0\n59511.0\t0\t3\t59511.0\n"},{"type":"HTML","data":"<div class=\"result-alert alert-warning\" role=\"alert\"><button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button><strong>Output is truncated</strong> to 1000 rows. Learn more about <strong>common.max_count</strong></div>"}]},"apps":[],"jobName":"paragraph_1647043271950_-1619252059","id":"20220312-010111_1092472004","dateCreated":"2022-03-12T01:01:11+0100","dateStarted":"2022-03-12T01:03:23+0100","dateFinished":"2022-03-12T01:03:30+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37619"},{"title":"Répartition de la variable Loan en fonction de BAD","text":"%jdbc(hive)\n\nSELECT loan,bad, count(*) as count, avg(loan) as avg_loan\nfrom score.hmeq\ngroup by loan,bad","user":"imsduser","dateUpdated":"2022-03-12T19:37:57+0100","config":{"colWidth":6,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{}},"commonSetting":{},"keys":[{"name":"bad","index":1,"aggr":"sum"}],"groups":[],"values":[{"name":"avg_loan","index":3,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"loan\tbad\tcount\tavg_loan\n1300.0\t1\t1\t1300.0\n1500.0\t1\t2\t1500.0\n1700.0\t0\t1\t1700.0\n1700.0\t1\t1\t1700.0\n1800.0\t1\t2\t1800.0\n2000.0\t0\t1\t2000.0\n2000.0\t1\t5\t2000.0\n2100.0\t1\t1\t2100.0\n2200.0\t1\t3\t2200.0\n2300.0\t0\t1\t2300.0\n2300.0\t1\t2\t2300.0\n2400.0\t0\t1\t2400.0\n2400.0\t1\t5\t2400.0\n2500.0\t0\t2\t2500.0\n2500.0\t1\t2\t2500.0\n2800.0\t1\t2\t2800.0\n2900.0\t0\t2\t2900.0\n2900.0\t1\t3\t2900.0\n3000.0\t0\t3\t3000.0\n3000.0\t1\t9\t3000.0\n3100.0\t0\t1\t3100.0\n3100.0\t1\t1\t3100.0\n3200.0\t0\t2\t3200.0\n3200.0\t1\t4\t3200.0\n3300.0\t1\t2\t3300.0\n3400.0\t1\t1\t3400.0\n3500.0\t1\t2\t3500.0\n3600.0\t0\t4\t3600.0\n3600.0\t1\t3\t3600.0\n3700.0\t1\t1\t3700.0\n3800.0\t0\t3\t3800.0\n3800.0\t1\t1\t3800.0\n3900.0\t0\t2\t3900.0\n3900.0\t1\t3\t3900.0\n4000.0\t0\t8\t4000.0\n4000.0\t1\t11\t4000.0\n4100.0\t0\t1\t4100.0\n4100.0\t1\t2\t4100.0\n4200.0\t0\t5\t4200.0\n4200.0\t1\t1\t4200.0\n4300.0\t0\t3\t4300.0\n4400.0\t0\t2\t4400.0\n4400.0\t1\t1\t4400.0\n4500.0\t0\t5\t4500.0\n4500.0\t1\t6\t4500.0\n4700.0\t0\t4\t4700.0\n4700.0\t1\t2\t4700.0\n4800.0\t0\t3\t4800.0\n4900.0\t0\t7\t4900.0\n4900.0\t1\t3\t4900.0\n5000.0\t0\t22\t5000.0\n5000.0\t1\t28\t5000.0\n5100.0\t0\t11\t5100.0\n5100.0\t1\t4\t5100.0\n5200.0\t0\t6\t5200.0\n5200.0\t1\t2\t5200.0\n5300.0\t0\t10\t5300.0\n5300.0\t1\t2\t5300.0\n5400.0\t0\t8\t5400.0\n5400.0\t1\t3\t5400.0\n5500.0\t0\t11\t5500.0\n5500.0\t1\t8\t5500.0\n5600.0\t0\t6\t5600.0\n5600.0\t1\t2\t5600.0\n5700.0\t0\t14\t5700.0\n5700.0\t1\t5\t5700.0\n5800.0\t0\t8\t5800.0\n5800.0\t1\t1\t5800.0\n5900.0\t0\t5\t5900.0\n5900.0\t1\t4\t5900.0\n6000.0\t0\t13\t6000.0\n6000.0\t1\t15\t6000.0\n6100.0\t0\t11\t6100.0\n6100.0\t1\t1\t6100.0\n6200.0\t0\t16\t6200.0\n6200.0\t1\t2\t6200.0\n6300.0\t0\t13\t6300.0\n6300.0\t1\t3\t6300.0\n6400.0\t0\t16\t6400.0\n6400.0\t1\t1\t6400.0\n6500.0\t0\t15\t6500.0\n6500.0\t1\t6\t6500.0\n6600.0\t0\t8\t6600.0\n6700.0\t0\t12\t6700.0\n6700.0\t1\t4\t6700.0\n6800.0\t0\t13\t6800.0\n6800.0\t1\t2\t6800.0\n6900.0\t0\t10\t6900.0\n6900.0\t1\t4\t6900.0\n7000.0\t0\t22\t7000.0\n7000.0\t1\t15\t7000.0\n7100.0\t0\t10\t7100.0\n7100.0\t1\t2\t7100.0\n7200.0\t0\t10\t7200.0\n7200.0\t1\t5\t7200.0\n7300.0\t0\t6\t7300.0\n7300.0\t1\t4\t7300.0\n7400.0\t0\t14\t7400.0\n7400.0\t1\t2\t7400.0\n7500.0\t0\t15\t7500.0\n7500.0\t1\t21\t7500.0\n7600.0\t0\t8\t7600.0\n7700.0\t0\t11\t7700.0\n7700.0\t1\t1\t7700.0\n7800.0\t0\t14\t7800.0\n7800.0\t1\t1\t7800.0\n7900.0\t0\t13\t7900.0\n7900.0\t1\t3\t7900.0\n8000.0\t0\t28\t8000.0\n8000.0\t1\t16\t8000.0\n8100.0\t0\t17\t8100.0\n8100.0\t1\t2\t8100.0\n8200.0\t0\t28\t8200.0\n8200.0\t1\t2\t8200.0\n8300.0\t0\t17\t8300.0\n8300.0\t1\t3\t8300.0\n8400.0\t0\t25\t8400.0\n8400.0\t1\t5\t8400.0\n8500.0\t0\t22\t8500.0\n8500.0\t1\t4\t8500.0\n8600.0\t0\t20\t8600.0\n8600.0\t1\t3\t8600.0\n8700.0\t0\t27\t8700.0\n8700.0\t1\t2\t8700.0\n8800.0\t0\t11\t8800.0\n8800.0\t1\t7\t8800.0\n8900.0\t0\t9\t8900.0\n8900.0\t1\t7\t8900.0\n9000.0\t0\t25\t9000.0\n9000.0\t1\t8\t9000.0\n9100.0\t0\t13\t9100.0\n9100.0\t1\t4\t9100.0\n9200.0\t0\t10\t9200.0\n9200.0\t1\t2\t9200.0\n9300.0\t0\t22\t9300.0\n9300.0\t1\t4\t9300.0\n9400.0\t0\t27\t9400.0\n9400.0\t1\t1\t9400.0\n9500.0\t0\t14\t9500.0\n9500.0\t1\t4\t9500.0\n9600.0\t0\t16\t9600.0\n9600.0\t1\t2\t9600.0\n9700.0\t0\t18\t9700.0\n9700.0\t1\t5\t9700.0\n9800.0\t0\t25\t9800.0\n9800.0\t1\t1\t9800.0\n9900.0\t0\t22\t9900.0\n9900.0\t1\t6\t9900.0\n10000.0\t0\t37\t10000.0\n10000.0\t1\t44\t10000.0\n10100.0\t0\t23\t10100.0\n10100.0\t1\t2\t10100.0\n10200.0\t0\t27\t10200.0\n10200.0\t1\t4\t10200.0\n10300.0\t0\t21\t10300.0\n10300.0\t1\t2\t10300.0\n10400.0\t0\t14\t10400.0\n10400.0\t1\t2\t10400.0\n10500.0\t0\t23\t10500.0\n10500.0\t1\t5\t10500.0\n10600.0\t0\t31\t10600.0\n10600.0\t1\t3\t10600.0\n10700.0\t0\t19\t10700.0\n10700.0\t1\t4\t10700.0\n10800.0\t0\t26\t10800.0\n10800.0\t1\t7\t10800.0\n10900.0\t0\t12\t10900.0\n10900.0\t1\t3\t10900.0\n11000.0\t0\t33\t11000.0\n11000.0\t1\t14\t11000.0\n11100.0\t0\t26\t11100.0\n11100.0\t1\t4\t11100.0\n11200.0\t0\t14\t11200.0\n11200.0\t1\t3\t11200.0\n11300.0\t0\t20\t11300.0\n11300.0\t1\t4\t11300.0\n11400.0\t0\t19\t11400.0\n11500.0\t0\t17\t11500.0\n11500.0\t1\t4\t11500.0\n11600.0\t0\t16\t11600.0\n11600.0\t1\t4\t11600.0\n11700.0\t0\t22\t11700.0\n11700.0\t1\t6\t11700.0\n11800.0\t0\t18\t11800.0\n11800.0\t1\t2\t11800.0\n11900.0\t0\t22\t11900.0\n11900.0\t1\t6\t11900.0\n12000.0\t0\t46\t12000.0\n12000.0\t1\t23\t12000.0\n12100.0\t0\t27\t12100.0\n12100.0\t1\t4\t12100.0\n12200.0\t0\t17\t12200.0\n12200.0\t1\t2\t12200.0\n12300.0\t0\t24\t12300.0\n12300.0\t1\t9\t12300.0\n12400.0\t0\t17\t12400.0\n12400.0\t1\t4\t12400.0\n12500.0\t0\t25\t12500.0\n12500.0\t1\t7\t12500.0\n12600.0\t0\t20\t12600.0\n12600.0\t1\t5\t12600.0\n12700.0\t0\t26\t12700.0\n12700.0\t1\t1\t12700.0\n12800.0\t0\t27\t12800.0\n12800.0\t1\t6\t12800.0\n12900.0\t0\t30\t12900.0\n12900.0\t1\t4\t12900.0\n13000.0\t0\t34\t13000.0\n13000.0\t1\t16\t13000.0\n13100.0\t0\t17\t13100.0\n13100.0\t1\t3\t13100.0\n13200.0\t0\t15\t13200.0\n13200.0\t1\t2\t13200.0\n13300.0\t0\t25\t13300.0\n13300.0\t1\t5\t13300.0\n13400.0\t0\t20\t13400.0\n13400.0\t1\t4\t13400.0\n13500.0\t0\t23\t13500.0\n13500.0\t1\t6\t13500.0\n13600.0\t0\t25\t13600.0\n13600.0\t1\t2\t13600.0\n13700.0\t0\t28\t13700.0\n13700.0\t1\t3\t13700.0\n13800.0\t0\t18\t13800.0\n13800.0\t1\t3\t13800.0\n13900.0\t0\t27\t13900.0\n13900.0\t1\t7\t13900.0\n14000.0\t0\t19\t14000.0\n14000.0\t1\t10\t14000.0\n14100.0\t0\t11\t14100.0\n14100.0\t1\t3\t14100.0\n14200.0\t0\t14\t14200.0\n14200.0\t1\t3\t14200.0\n14300.0\t0\t21\t14300.0\n14300.0\t1\t2\t14300.0\n14400.0\t0\t20\t14400.0\n14500.0\t0\t14\t14500.0\n14500.0\t1\t3\t14500.0\n14600.0\t0\t19\t14600.0\n14600.0\t1\t3\t14600.0\n14700.0\t0\t20\t14700.0\n14700.0\t1\t4\t14700.0\n14800.0\t0\t20\t14800.0\n14800.0\t1\t2\t14800.0\n14900.0\t0\t25\t14900.0\n14900.0\t1\t4\t14900.0\n15000.0\t0\t45\t15000.0\n15000.0\t1\t60\t15000.0\n15100.0\t0\t23\t15100.0\n15100.0\t1\t3\t15100.0\n15200.0\t0\t29\t15200.0\n15200.0\t1\t3\t15200.0\n15300.0\t0\t27\t15300.0\n15300.0\t1\t4\t15300.0\n15400.0\t0\t23\t15400.0\n15400.0\t1\t2\t15400.0\n15500.0\t0\t22\t15500.0\n15500.0\t1\t6\t15500.0\n15600.0\t0\t17\t15600.0\n15600.0\t1\t3\t15600.0\n15700.0\t0\t25\t15700.0\n15700.0\t1\t5\t15700.0\n15800.0\t0\t23\t15800.0\n15800.0\t1\t6\t15800.0\n15900.0\t0\t28\t15900.0\n15900.0\t1\t3\t15900.0\n16000.0\t0\t33\t16000.0\n16000.0\t1\t6\t16000.0\n16100.0\t0\t20\t16100.0\n16100.0\t1\t4\t16100.0\n16200.0\t0\t19\t16200.0\n16200.0\t1\t6\t16200.0\n16300.0\t0\t15\t16300.0\n16300.0\t1\t4\t16300.0\n16400.0\t0\t25\t16400.0\n16400.0\t1\t2\t16400.0\n16500.0\t0\t28\t16500.0\n16500.0\t1\t9\t16500.0\n16600.0\t0\t18\t16600.0\n16600.0\t1\t1\t16600.0\n16700.0\t0\t19\t16700.0\n16700.0\t1\t1\t16700.0\n16800.0\t0\t17\t16800.0\n16800.0\t1\t7\t16800.0\n16900.0\t0\t17\t16900.0\n16900.0\t1\t2\t16900.0\n17000.0\t0\t37\t17000.0\n17000.0\t1\t14\t17000.0\n17100.0\t0\t20\t17100.0\n17100.0\t1\t1\t17100.0\n17200.0\t0\t26\t17200.0\n17200.0\t1\t3\t17200.0\n17300.0\t0\t19\t17300.0\n17300.0\t1\t2\t17300.0\n17400.0\t0\t22\t17400.0\n17400.0\t1\t3\t17400.0\n17500.0\t0\t18\t17500.0\n17500.0\t1\t5\t17500.0\n17600.0\t0\t23\t17600.0\n17600.0\t1\t1\t17600.0\n17700.0\t0\t18\t17700.0\n17700.0\t1\t1\t17700.0\n17800.0\t0\t21\t17800.0\n17900.0\t0\t13\t17900.0\n17900.0\t1\t4\t17900.0\n18000.0\t0\t32\t18000.0\n18000.0\t1\t8\t18000.0\n18100.0\t0\t17\t18100.0\n18100.0\t1\t1\t18100.0\n18200.0\t0\t20\t18200.0\n18200.0\t1\t4\t18200.0\n18300.0\t0\t18\t18300.0\n18300.0\t1\t1\t18300.0\n18400.0\t0\t16\t18400.0\n18400.0\t1\t4\t18400.0\n18500.0\t0\t19\t18500.0\n18600.0\t0\t25\t18600.0\n18600.0\t1\t4\t18600.0\n18700.0\t0\t20\t18700.0\n18700.0\t1\t3\t18700.0\n18800.0\t0\t12\t18800.0\n18800.0\t1\t3\t18800.0\n18900.0\t0\t21\t18900.0\n18900.0\t1\t4\t18900.0\n19000.0\t0\t19\t19000.0\n19000.0\t1\t9\t19000.0\n19100.0\t0\t9\t19100.0\n19200.0\t0\t13\t19200.0\n19200.0\t1\t1\t19200.0\n19300.0\t0\t16\t19300.0\n19300.0\t1\t4\t19300.0\n19400.0\t0\t11\t19400.0\n19400.0\t1\t2\t19400.0\n19500.0\t0\t14\t19500.0\n19500.0\t1\t3\t19500.0\n19600.0\t0\t7\t19600.0\n19600.0\t1\t3\t19600.0\n19700.0\t0\t10\t19700.0\n19700.0\t1\t2\t19700.0\n19800.0\t0\t9\t19800.0\n19900.0\t0\t14\t19900.0\n19900.0\t1\t1\t19900.0\n20000.0\t0\t46\t20000.0\n20000.0\t1\t28\t20000.0\n20100.0\t0\t18\t20100.0\n20100.0\t1\t2\t20100.0\n20200.0\t0\t19\t20200.0\n20200.0\t1\t2\t20200.0\n20300.0\t0\t11\t20300.0\n20300.0\t1\t4\t20300.0\n20400.0\t0\t16\t20400.0\n20400.0\t1\t1\t20400.0\n20500.0\t0\t20\t20500.0\n20500.0\t1\t5\t20500.0\n20600.0\t0\t18\t20600.0\n20600.0\t1\t2\t20600.0\n20700.0\t0\t13\t20700.0\n20800.0\t0\t21\t20800.0\n20800.0\t1\t2\t20800.0\n20900.0\t0\t18\t20900.0\n20900.0\t1\t4\t20900.0\n21000.0\t0\t19\t21000.0\n21000.0\t1\t8\t21000.0\n21100.0\t0\t9\t21100.0\n21100.0\t1\t1\t21100.0\n21200.0\t0\t16\t21200.0\n21200.0\t1\t2\t21200.0\n21300.0\t0\t22\t21300.0\n21300.0\t1\t1\t21300.0\n21400.0\t0\t18\t21400.0\n21400.0\t1\t3\t21400.0\n21500.0\t0\t22\t21500.0\n21500.0\t1\t1\t21500.0\n21600.0\t0\t19\t21600.0\n21600.0\t1\t2\t21600.0\n21700.0\t0\t24\t21700.0\n21700.0\t1\t2\t21700.0\n21800.0\t0\t14\t21800.0\n21800.0\t1\t3\t21800.0\n21900.0\t0\t20\t21900.0\n21900.0\t1\t2\t21900.0\n22000.0\t0\t19\t22000.0\n22000.0\t1\t5\t22000.0\n22100.0\t0\t14\t22100.0\n22100.0\t1\t1\t22100.0\n22200.0\t0\t14\t22200.0\n22300.0\t0\t15\t22300.0\n22300.0\t1\t3\t22300.0\n22400.0\t0\t29\t22400.0\n22400.0\t1\t4\t22400.0\n22500.0\t0\t16\t22500.0\n22500.0\t1\t1\t22500.0\n22600.0\t0\t20\t22600.0\n22600.0\t1\t3\t22600.0\n22700.0\t0\t14\t22700.0\n22700.0\t1\t1\t22700.0\n22800.0\t0\t17\t22800.0\n22800.0\t1\t1\t22800.0\n22900.0\t0\t21\t22900.0\n22900.0\t1\t2\t22900.0\n23000.0\t0\t19\t23000.0\n23000.0\t1\t6\t23000.0\n23100.0\t0\t13\t23100.0\n23200.0\t0\t8\t23200.0\n23200.0\t1\t2\t23200.0\n23300.0\t0\t10\t23300.0\n23300.0\t1\t4\t23300.0\n23400.0\t0\t12\t23400.0\n23500.0\t0\t24\t23500.0\n23500.0\t1\t4\t23500.0\n23600.0\t0\t17\t23600.0\n23700.0\t0\t15\t23700.0\n23700.0\t1\t2\t23700.0\n23800.0\t0\t9\t23800.0\n23800.0\t1\t3\t23800.0\n23900.0\t0\t18\t23900.0\n23900.0\t1\t1\t23900.0\n24000.0\t0\t12\t24000.0\n24000.0\t1\t5\t24000.0\n24100.0\t0\t9\t24100.0\n24100.0\t1\t2\t24100.0\n24200.0\t0\t11\t24200.0\n24200.0\t1\t4\t24200.0\n24300.0\t0\t13\t24300.0\n24400.0\t0\t18\t24400.0\n24400.0\t1\t3\t24400.0\n24500.0\t0\t15\t24500.0\n24500.0\t1\t1\t24500.0\n24600.0\t0\t7\t24600.0\n24600.0\t1\t1\t24600.0\n24700.0\t0\t9\t24700.0\n24700.0\t1\t1\t24700.0\n24800.0\t0\t9\t24800.0\n24800.0\t1\t3\t24800.0\n24900.0\t0\t9\t24900.0\n24900.0\t1\t2\t24900.0\n25000.0\t0\t36\t25000.0\n25000.0\t1\t37\t25000.0\n25100.0\t0\t23\t25100.0\n25200.0\t0\t13\t25200.0\n25300.0\t0\t12\t25300.0\n25400.0\t0\t11\t25400.0\n25400.0\t1\t3\t25400.0\n25500.0\t0\t16\t25500.0\n25500.0\t1\t2\t25500.0\n25600.0\t0\t15\t25600.0\n25600.0\t1\t4\t25600.0\n25700.0\t0\t13\t25700.0\n25700.0\t1\t1\t25700.0\n25800.0\t0\t8\t25800.0\n25900.0\t0\t11\t25900.0\n25900.0\t1\t4\t25900.0\n26000.0\t0\t13\t26000.0\n26000.0\t1\t3\t26000.0\n26100.0\t0\t11\t26100.0\n26100.0\t1\t1\t26100.0\n26200.0\t0\t9\t26200.0\n26200.0\t1\t1\t26200.0\n26300.0\t0\t17\t26300.0\n26400.0\t0\t13\t26400.0\n26500.0\t0\t17\t26500.0\n26500.0\t1\t3\t26500.0\n26600.0\t0\t8\t26600.0\n26600.0\t1\t2\t26600.0\n26700.0\t0\t10\t26700.0\n26800.0\t0\t11\t26800.0\n26800.0\t1\t3\t26800.0\n26900.0\t0\t13\t26900.0\n26900.0\t1\t1\t26900.0\n27000.0\t0\t13\t27000.0\n27000.0\t1\t2\t27000.0\n27100.0\t0\t8\t27100.0\n27100.0\t1\t1\t27100.0\n27200.0\t0\t9\t27200.0\n27200.0\t1\t1\t27200.0\n27300.0\t0\t14\t27300.0\n27300.0\t1\t1\t27300.0\n27400.0\t0\t8\t27400.0\n27400.0\t1\t2\t27400.0\n27500.0\t0\t9\t27500.0\n27500.0\t1\t2\t27500.0\n27600.0\t0\t18\t27600.0\n27700.0\t0\t14\t27700.0\n27700.0\t1\t6\t27700.0\n27800.0\t0\t7\t27800.0\n27900.0\t0\t10\t27900.0\n27900.0\t1\t2\t27900.0\n28000.0\t0\t8\t28000.0\n28000.0\t1\t2\t28000.0\n28100.0\t0\t6\t28100.0\n28100.0\t1\t3\t28100.0\n28200.0\t0\t14\t28200.0\n28200.0\t1\t1\t28200.0\n28300.0\t0\t9\t28300.0\n28300.0\t1\t1\t28300.0\n28400.0\t0\t12\t28400.0\n28500.0\t0\t9\t28500.0\n28500.0\t1\t1\t28500.0\n28600.0\t0\t8\t28600.0\n28600.0\t1\t1\t28600.0\n28700.0\t0\t5\t28700.0\n28700.0\t1\t1\t28700.0\n28800.0\t0\t7\t28800.0\n28900.0\t0\t11\t28900.0\n28900.0\t1\t1\t28900.0\n29000.0\t0\t2\t29000.0\n29000.0\t1\t4\t29000.0\n29200.0\t0\t4\t29200.0\n29300.0\t0\t2\t29300.0\n29400.0\t0\t3\t29400.0\n29400.0\t1\t1\t29400.0\n29500.0\t0\t3\t29500.0\n29500.0\t1\t1\t29500.0\n29600.0\t0\t1\t29600.0\n29700.0\t0\t2\t29700.0\n29800.0\t0\t3\t29800.0\n29900.0\t0\t4\t29900.0\n29900.0\t1\t1\t29900.0\n30000.0\t0\t12\t30000.0\n30000.0\t1\t4\t30000.0\n30100.0\t0\t5\t30100.0\n30100.0\t1\t1\t30100.0\n30200.0\t0\t4\t30200.0\n30200.0\t1\t2\t30200.0\n30300.0\t0\t5\t30300.0\n30300.0\t1\t1\t30300.0\n30400.0\t0\t4\t30400.0\n30500.0\t0\t7\t30500.0\n30500.0\t1\t1\t30500.0\n30600.0\t0\t4\t30600.0\n30700.0\t0\t2\t30700.0\n30800.0\t0\t7\t30800.0\n30800.0\t1\t1\t30800.0\n30900.0\t0\t3\t30900.0\n30900.0\t1\t1\t30900.0\n31000.0\t0\t5\t31000.0\n31000.0\t1\t2\t31000.0\n31100.0\t0\t2\t31100.0\n31200.0\t0\t5\t31200.0\n31200.0\t1\t1\t31200.0\n31300.0\t0\t4\t31300.0\n31400.0\t0\t3\t31400.0\n31500.0\t0\t3\t31500.0\n31500.0\t1\t4\t31500.0\n31600.0\t0\t2\t31600.0\n31700.0\t0\t2\t31700.0\n31800.0\t0\t8\t31800.0\n31800.0\t1\t1\t31800.0\n31900.0\t0\t6\t31900.0\n32000.0\t0\t4\t32000.0\n32000.0\t1\t2\t32000.0\n32100.0\t0\t2\t32100.0\n32200.0\t0\t4\t32200.0\n32300.0\t0\t8\t32300.0\n32300.0\t1\t1\t32300.0\n32400.0\t0\t2\t32400.0\n32400.0\t1\t1\t32400.0\n32500.0\t0\t3\t32500.0\n32600.0\t0\t3\t32600.0\n32700.0\t0\t2\t32700.0\n32800.0\t0\t4\t32800.0\n32900.0\t0\t4\t32900.0\n32900.0\t1\t1\t32900.0\n33000.0\t0\t6\t33000.0\n33000.0\t1\t1\t33000.0\n33100.0\t0\t2\t33100.0\n33100.0\t1\t1\t33100.0\n33200.0\t0\t5\t33200.0\n33200.0\t1\t1\t33200.0\n33300.0\t0\t1\t33300.0\n33400.0\t0\t2\t33400.0\n33400.0\t1\t1\t33400.0\n33500.0\t0\t6\t33500.0\n33500.0\t1\t1\t33500.0\n33600.0\t0\t3\t33600.0\n33700.0\t0\t9\t33700.0\n33800.0\t0\t1\t33800.0\n33900.0\t0\t4\t33900.0\n34000.0\t0\t3\t34000.0\n34100.0\t0\t4\t34100.0\n34200.0\t0\t1\t34200.0\n34300.0\t0\t3\t34300.0\n34400.0\t0\t1\t34400.0\n34400.0\t1\t1\t34400.0\n34500.0\t0\t1\t34500.0\n34600.0\t0\t2\t34600.0\n34600.0\t1\t1\t34600.0\n34700.0\t0\t1\t34700.0\n34800.0\t0\t3\t34800.0\n34800.0\t1\t1\t34800.0\n34900.0\t0\t2\t34900.0\n35000.0\t0\t4\t35000.0\n35000.0\t1\t2\t35000.0\n35100.0\t0\t2\t35100.0\n35200.0\t0\t3\t35200.0\n35300.0\t0\t1\t35300.0\n35400.0\t0\t1\t35400.0\n35500.0\t0\t1\t35500.0\n35600.0\t0\t3\t35600.0\n35700.0\t0\t1\t35700.0\n35800.0\t0\t2\t35800.0\n36000.0\t0\t4\t36000.0\n36000.0\t1\t1\t36000.0\n36100.0\t0\t2\t36100.0\n36100.0\t1\t1\t36100.0\n36200.0\t0\t3\t36200.0\n36300.0\t0\t6\t36300.0\n36400.0\t0\t4\t36400.0\n36500.0\t0\t4\t36500.0\n36500.0\t1\t1\t36500.0\n36600.0\t0\t1\t36600.0\n36600.0\t1\t1\t36600.0\n36800.0\t0\t3\t36800.0\n36800.0\t1\t1\t36800.0\n36900.0\t1\t1\t36900.0\n37000.0\t0\t2\t37000.0\n37000.0\t1\t1\t37000.0\n37200.0\t0\t3\t37200.0\n37300.0\t1\t1\t37300.0\n37400.0\t0\t1\t37400.0\n37500.0\t0\t2\t37500.0\n37600.0\t0\t2\t37600.0\n37700.0\t0\t3\t37700.0\n37800.0\t0\t2\t37800.0\n37900.0\t0\t2\t37900.0\n38000.0\t0\t2\t38000.0\n38000.0\t1\t4\t38000.0\n38100.0\t0\t4\t38100.0\n38200.0\t0\t3\t38200.0\n38300.0\t0\t1\t38300.0\n38400.0\t0\t1\t38400.0\n38600.0\t0\t2\t38600.0\n38700.0\t0\t1\t38700.0\n38700.0\t1\t2\t38700.0\n38800.0\t1\t1\t38800.0\n38900.0\t0\t3\t38900.0\n38900.0\t1\t1\t38900.0\n39000.0\t0\t1\t39000.0\n39000.0\t1\t2\t39000.0\n39100.0\t0\t2\t39100.0\n39300.0\t0\t1\t39300.0\n39300.0\t1\t1\t39300.0\n39400.0\t0\t1\t39400.0\n39400.0\t1\t1\t39400.0\n39500.0\t0\t3\t39500.0\n39500.0\t1\t1\t39500.0\n39600.0\t0\t1\t39600.0\n39600.0\t1\t1\t39600.0\n39700.0\t0\t3\t39700.0\n39800.0\t0\t1\t39800.0\n40000.0\t0\t4\t40000.0\n40000.0\t1\t8\t40000.0\n40100.0\t0\t2\t40100.0\n40300.0\t0\t2\t40300.0\n40400.0\t0\t2\t40400.0\n40400.0\t1\t1\t40400.0\n40500.0\t0\t2\t40500.0\n40600.0\t0\t3\t40600.0\n40700.0\t0\t3\t40700.0\n40800.0\t0\t2\t40800.0\n40900.0\t0\t4\t40900.0\n40900.0\t1\t1\t40900.0\n41100.0\t0\t3\t41100.0\n41200.0\t0\t2\t41200.0\n41200.0\t1\t1\t41200.0\n41300.0\t1\t1\t41300.0\n41400.0\t0\t2\t41400.0\n41500.0\t0\t1\t41500.0\n41600.0\t0\t3\t41600.0\n41600.0\t1\t1\t41600.0\n41700.0\t0\t2\t41700.0\n41700.0\t1\t2\t41700.0\n41800.0\t0\t2\t41800.0\n41800.0\t1\t1\t41800.0\n42000.0\t0\t1\t42000.0\n42000.0\t1\t4\t42000.0\n42100.0\t0\t2\t42100.0\n42200.0\t0\t3\t42200.0\n42300.0\t0\t2\t42300.0\n42400.0\t1\t1\t42400.0\n42500.0\t0\t2\t42500.0\n42600.0\t0\t3\t42600.0\n42700.0\t0\t1\t42700.0\n42800.0\t0\t3\t42800.0\n42800.0\t1\t1\t42800.0\n42900.0\t0\t3\t42900.0\n43000.0\t0\t1\t43000.0\n43100.0\t0\t2\t43100.0\n43200.0\t0\t3\t43200.0\n43200.0\t1\t1\t43200.0\n43300.0\t0\t4\t43300.0\n43300.0\t1\t2\t43300.0\n43500.0\t0\t2\t43500.0\n43500.0\t1\t1\t43500.0\n43700.0\t0\t2\t43700.0\n43800.0\t0\t2\t43800.0\n43900.0\t0\t2\t43900.0\n44000.0\t0\t1\t44000.0\n44000.0\t1\t2\t44000.0\n44100.0\t0\t1\t44100.0\n44400.0\t0\t1\t44400.0\n44400.0\t1\t1\t44400.0\n44500.0\t0\t1\t44500.0\n44900.0\t0\t1\t44900.0\n45000.0\t0\t2\t45000.0\n45000.0\t1\t1\t45000.0\n45100.0\t1\t1\t45100.0\n45200.0\t0\t1\t45200.0\n45700.0\t0\t1\t45700.0\n45700.0\t1\t1\t45700.0\n45900.0\t1\t1\t45900.0\n46100.0\t0\t1\t46100.0\n46200.0\t0\t1\t46200.0\n46300.0\t0\t1\t46300.0\n46300.0\t1\t1\t46300.0\n46700.0\t0\t1\t46700.0\n46900.0\t0\t1\t46900.0\n47000.0\t0\t2\t47000.0\n47000.0\t1\t3\t47000.0\n47100.0\t0\t1\t47100.0\n47500.0\t0\t3\t47500.0\n47600.0\t0\t2\t47600.0\n47700.0\t0\t1\t47700.0\n47800.0\t1\t1\t47800.0\n47900.0\t0\t1\t47900.0\n48000.0\t0\t1\t48000.0\n48200.0\t0\t1\t48200.0\n48400.0\t0\t1\t48400.0\n48800.0\t0\t1\t48800.0\n48900.0\t0\t2\t48900.0\n49200.0\t0\t1\t49200.0\n49300.0\t0\t1\t49300.0\n49500.0\t1\t2\t49500.0\n49800.0\t0\t1\t49800.0\n49900.0\t0\t1\t49900.0\n50000.0\t0\t5\t50000.0\n50000.0\t1\t11\t50000.0\n50100.0\t0\t3\t50100.0\n50100.0\t1\t1\t50100.0\n50200.0\t0\t2\t50200.0\n50200.0\t1\t2\t50200.0\n50300.0\t0\t1\t50300.0\n50400.0\t0\t4\t50400.0\n50400.0\t1\t1\t50400.0\n50500.0\t1\t1\t50500.0\n50600.0\t0\t1\t50600.0\n50700.0\t0\t1\t50700.0\n50800.0\t0\t4\t50800.0\n50900.0\t0\t4\t50900.0\n51000.0\t0\t1\t51000.0\n51100.0\t0\t2\t51100.0\n51300.0\t0\t1\t51300.0\n51400.0\t0\t1\t51400.0\n51500.0\t0\t2\t51500.0\n51600.0\t0\t2\t51600.0\n51700.0\t0\t2\t51700.0\n51800.0\t0\t1\t51800.0\n52000.0\t0\t2\t52000.0\n52200.0\t0\t3\t52200.0\n52300.0\t0\t1\t52300.0\n52400.0\t0\t1\t52400.0\n52700.0\t0\t2\t52700.0\n52800.0\t0\t1\t52800.0\n52900.0\t0\t1\t52900.0\n53000.0\t0\t1\t53000.0\n53200.0\t0\t1\t53200.0\n53300.0\t0\t1\t53300.0\n53400.0\t1\t1\t53400.0\n53500.0\t0\t1\t53500.0\n53600.0\t1\t2\t53600.0\n53700.0\t0\t4\t53700.0\n53800.0\t0\t1\t53800.0\n53800.0\t1\t1\t53800.0\n53900.0\t0\t1\t53900.0\n54000.0\t0\t1\t54000.0\n56800.0\t1\t1\t56800.0\n57000.0\t0\t1\t57000.0\n58000.0\t0\t1\t58000.0\n58100.0\t0\t1\t58100.0\n58900.0\t0\t1\t58900.0\n59200.0\t0\t2\t59200.0\n59500.0\t0\t1\t59500.0\n59700.0\t0\t1\t59700.0\n59800.0\t0\t1\t59800.0\n60000.0\t0\t2\t60000.0\n60000.0\t1\t1\t60000.0\n60500.0\t0\t1\t60500.0\n61400.0\t1\t1\t61400.0\n62500.0\t0\t1\t62500.0\n62700.0\t0\t1\t62700.0\n62900.0\t0\t1\t62900.0\n63300.0\t1\t1\t63300.0\n63900.0\t0\t1\t63900.0\n64200.0\t0\t1\t64200.0\n64900.0\t0\t1\t64900.0\n65100.0\t0\t1\t65100.0\n65200.0\t0\t3\t65200.0\n65500.0\t1\t1\t65500.0\n65800.0\t0\t2\t65800.0\n66000.0\t0\t1\t66000.0\n66400.0\t0\t1\t66400.0\n66500.0\t0\t1\t66500.0\n67400.0\t0\t1\t67400.0\n68000.0\t0\t1\t68000.0\n68100.0\t0\t1\t68100.0\n68700.0\t0\t1\t68700.0\n69000.0\t0\t1\t69000.0\n69600.0\t0\t1\t69600.0\n69700.0\t0\t2\t69700.0\n70300.0\t0\t1\t70300.0\n70500.0\t0\t1\t70500.0\n70800.0\t0\t1\t70800.0\n71200.0\t0\t1\t71200.0\n72300.0\t1\t1\t72300.0\n75400.0\t1\t1\t75400.0\n76500.0\t1\t1\t76500.0\n77200.0\t1\t1\t77200.0\n77400.0\t1\t1\t77400.0\n78400.0\t0\t1\t78400.0\n78700.0\t0\t1\t78700.0\n79100.0\t0\t1\t79100.0\n79200.0\t0\t2\t79200.0\n79900.0\t0\t1\t79900.0\n80300.0\t0\t1\t80300.0\n80600.0\t0\t1\t80600.0\n81200.0\t0\t1\t81200.0\n81400.0\t0\t2\t81400.0\n82200.0\t0\t2\t82200.0\n86000.0\t0\t1\t86000.0\n87000.0\t0\t1\t87000.0\n87500.0\t0\t1\t87500.0\n88300.0\t0\t1\t88300.0\n88500.0\t0\t1\t88500.0\n88800.0\t0\t1\t88800.0\n88900.0\t0\t2\t88900.0\n89000.0\t0\t1\t89000.0\n89200.0\t0\t1\t89200.0\n89800.0\t0\t1\t89800.0\n89900.0\t0\t1\t89900.0\n"}]},"apps":[],"jobName":"paragraph_1647043485121_1782816496","id":"20220312-010445_735379101","dateCreated":"2022-03-12T01:04:45+0100","dateStarted":"2022-03-12T19:37:45+0100","dateFinished":"2022-03-12T19:37:48+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37620"},{"text":"%md\nNous pouvons constater que plus VALUE est élevé (plus la valeur de la propriété actuelle de l’individu est élevée), plus l’emprunteur semble ne pas être en défaut. \nOn remarque également que le montant du prêt accordé est plus élevé chez les individus qui ont remboursé leur emprunt.\n","user":"imsduser","dateUpdated":"2022-03-15T23:16:40+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Nous pouvons constater que plus VALUE est élevé (plus la valeur de la propriété actuelle de l’individu est élevée), plus l’emprunteur semble ne pas être en défaut.\n<br  />On remarque également que le montant du prêt accordé est plus élevé chez les individus qui ont remboursé leur emprunt.</p>\n"}]},"apps":[],"jobName":"paragraph_1647043586063_1339555115","id":"20220312-010626_1440192200","dateCreated":"2022-03-12T01:06:26+0100","dateStarted":"2022-03-15T23:15:24+0100","dateFinished":"2022-03-15T23:15:25+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37621"},{"text":"%md\nOn remarque à partir de la Figure ci-dessous , que les montants prêtés augmentent avec la hausse de la valeur du bien. La valeur du prêt est positivement corrélée à l'expérience professionnelle et à la valeur du logement. On remarquera également que les prêts en défaut sont ceux des individus avec un montant d'hypothèque inférieur à 200.000 $ ont des prêts inférieurs à 40.000 $.\n","user":"imsduser","dateUpdated":"2022-03-16T16:43:54+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>On remarque à partir de la Figure ci-dessous , que les montants prêtés augmentent avec la hausse de la valeur du bien. La valeur du prêt est positivement corrélée à l'expérience professionnelle et à la valeur du logement. On remarquera également que les prêts en défaut sont ceux des individus avec un montant d'hypothèque inférieur à 200.000 $ ont des prêts inférieurs à 40.000 $.</p>\n"}]},"apps":[],"jobName":"paragraph_1646930987867_-1188673499","id":"20220310-174947_1360705428","dateCreated":"2022-03-10T17:49:47+0100","dateStarted":"2022-03-16T16:43:54+0100","dateFinished":"2022-03-16T16:43:54+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37622"},{"title":"Montant du prêt en fonction de la valeur du logement","text":"%jdbc(hive)\nSELECT value, loan, bad, count(*) as count\nfrom score.hmeq\nWhere value is NOT NULL\ngroup by value, loan, bad","user":"imsduser","dateUpdated":"2022-03-16T16:43:09+0100","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"scatterChart","height":300,"optionOpen":false,"setting":{"scatterChart":{"xAxis":{"name":"value","index":0,"aggr":"sum"},"yAxis":{"name":"loan","index":1,"aggr":"sum"},"size":{"name":"count","index":3,"aggr":"sum"},"group":{"name":"bad","index":2,"aggr":"sum"}}}},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"value\tloan\tbad\tcount\n8000.0\t18600.0\t0\t1\n8800.0\t3000.0\t1\t1\n9100.0\t5000.0\t1\t1\n9500.0\t5200.0\t1\t1\n11550.0\t9100.0\t1\t1\n11702.0\t7800.0\t1\t1\n12414.0\t19400.0\t0\t1\n12500.0\t22000.0\t1\t1\n12737.0\t20000.0\t0\t1\n12972.0\t5500.0\t1\t1\n13770.0\t5500.0\t1\t1\n13930.0\t19500.0\t0\t1\n13933.0\t19200.0\t0\t1\n14100.0\t3000.0\t1\t1\n14500.0\t3000.0\t1\t1\n14580.0\t21700.0\t0\t1\n14609.0\t19800.0\t0\t1\n16020.0\t4000.0\t1\t1\n16365.0\t10900.0\t1\t1\n16700.0\t1500.0\t1\t1\n17180.0\t2400.0\t1\t1\n18000.0\t4000.0\t1\t1\n18361.0\t8800.0\t1\t1\n18600.0\t10500.0\t1\t1\n19000.0\t15000.0\t1\t1\n19132.0\t4100.0\t1\t1\n20200.0\t2500.0\t1\t1\n20300.0\t3000.0\t1\t1\n20494.0\t3500.0\t1\t1\n20631.0\t6700.0\t1\t1\n20700.0\t18600.0\t0\t1\n21144.0\t3700.0\t1\t1\n21500.0\t18000.0\t1\t1\n21510.0\t18200.0\t0\t1\n22092.0\t3900.0\t1\t1\n22399.0\t22300.0\t0\t1\n22971.0\t20100.0\t0\t1\n23031.0\t4900.0\t1\t1\n23200.0\t19000.0\t1\t1\n23400.0\t10000.0\t0\t1\n23636.0\t19900.0\t0\t1\n24457.0\t19700.0\t0\t1\n24770.0\t21400.0\t0\t1\n24808.0\t21900.0\t0\t1\n24811.0\t22500.0\t0\t1\n24869.0\t13000.0\t1\t1\n24894.0\t20600.0\t0\t1\n25000.0\t7000.0\t1\t1\n25000.0\t8600.0\t1\t1\n25010.0\t10000.0\t1\t1\n25250.0\t5000.0\t1\t1\n25300.0\t10100.0\t1\t1\n25425.0\t13000.0\t0\t1\n25552.0\t13000.0\t0\t1\n25566.0\t21800.0\t0\t1\n25850.0\t6000.0\t1\t1\n26000.0\t5200.0\t0\t1\n26100.0\t15000.0\t1\t1\n26140.0\t9200.0\t0\t1\n26400.0\t11100.0\t1\t1\n26450.0\t21100.0\t0\t1\n26500.0\t23900.0\t0\t1\n26507.0\t20000.0\t0\t1\n26550.0\t5000.0\t0\t1\n26600.0\t7000.0\t0\t1\n26699.0\t20200.0\t0\t1\n26715.0\t5100.0\t0\t1\n26732.0\t20800.0\t0\t1\n26809.0\t5000.0\t1\t1\n26850.0\t7500.0\t0\t1\n26958.0\t7700.0\t0\t1\n27136.0\t13300.0\t0\t1\n27410.0\t6800.0\t1\t1\n27439.0\t11400.0\t0\t1\n27500.0\t15000.0\t1\t1\n27750.0\t6000.0\t1\t1\n27779.0\t13900.0\t0\t1\n27781.0\t16800.0\t1\t1\n27873.0\t8500.0\t0\t1\n28000.0\t5900.0\t1\t1\n28198.0\t15700.0\t0\t1\n28291.0\t5100.0\t0\t1\n28437.5\t4900.0\t0\t1\n28593.0\t7600.0\t0\t1\n28600.0\t11300.0\t0\t1\n28635.0\t20600.0\t0\t1\n28639.0\t19000.0\t0\t1\n28900.0\t24400.0\t0\t1\n28981.0\t13000.0\t0\t1\n28992.0\t14000.0\t1\t1\n29025.0\t15000.0\t1\t1\n29115.0\t14300.0\t0\t1\n29168.0\t16500.0\t0\t1\n29374.0\t11400.0\t0\t1\n29375.0\t7500.0\t1\t1\n29375.0\t11000.0\t0\t1\n29387.0\t16700.0\t0\t1\n29412.0\t20100.0\t1\t1\n29512.0\t28300.0\t0\t1\n29725.0\t16100.0\t0\t1\n29750.0\t3000.0\t1\t1\n29792.0\t6300.0\t0\t1\n29800.0\t2000.0\t1\t1\n30000.0\t5500.0\t1\t1\n30000.0\t19500.0\t0\t1\n30198.0\t18200.0\t0\t1\n30320.0\t7800.0\t0\t1\n30395.0\t15800.0\t0\t1\n30436.0\t11800.0\t0\t1\n30451.0\t5100.0\t1\t1\n30455.0\t9400.0\t0\t1\n30500.0\t6000.0\t1\t1\n30544.0\t6700.0\t0\t1\n30625.0\t14500.0\t0\t1\n30695.0\t16100.0\t1\t1\n30700.0\t9300.0\t0\t1\n30807.0\t21500.0\t0\t1\n30809.0\t13200.0\t0\t1\n30813.0\t20300.0\t0\t1\n31196.0\t23900.0\t0\t1\n31200.0\t7000.0\t0\t1\n31352.0\t8000.0\t1\t1\n31414.0\t12400.0\t0\t1\n31531.0\t14900.0\t0\t1\n31602.0\t7900.0\t0\t1\n31666.0\t7200.0\t0\t1\n31671.0\t14200.0\t0\t1\n31681.0\t27100.0\t0\t1\n31777.0\t25500.0\t0\t1\n31843.0\t12500.0\t0\t1\n31900.0\t9800.0\t0\t1\n31920.0\t20000.0\t0\t1\n31953.0\t17900.0\t1\t1\n31960.0\t4000.0\t1\t1\n32200.0\t6000.0\t1\t1\n32220.0\t10500.0\t0\t1\n32221.0\t8800.0\t0\t1\n32287.0\t7700.0\t0\t1\n32289.0\t15100.0\t0\t1\n32357.0\t13800.0\t0\t1\n32365.0\t8500.0\t0\t1\n32480.0\t5000.0\t1\t1\n32500.0\t7000.0\t1\t1\n32559.0\t6300.0\t1\t1\n32584.0\t8100.0\t0\t1\n32855.0\t8700.0\t0\t1\n32907.0\t8500.0\t0\t1\n32981.0\t8100.0\t0\t1\n33000.0\t3000.0\t1\t1\n33100.0\t5900.0\t1\t1\n33100.0\t7700.0\t1\t1\n33269.0\t24900.0\t0\t1\n33353.0\t11600.0\t0\t1\n33382.0\t16000.0\t0\t1\n33438.0\t6400.0\t0\t1\n33450.0\t5700.0\t0\t1\n33540.0\t8200.0\t0\t1\n33580.0\t7100.0\t0\t1\n33664.0\t13400.0\t0\t1\n33879.0\t12000.0\t1\t1\n33888.0\t25900.0\t0\t1\n33909.0\t6200.0\t0\t1\n33926.0\t22200.0\t0\t1\n33938.0\t12100.0\t0\t1\n33975.0\t25300.0\t0\t1\n34000.0\t5100.0\t1\t1\n34000.0\t25000.0\t1\t1\n34225.0\t5000.0\t1\t1\n34226.0\t8000.0\t0\t1\n34254.0\t8200.0\t0\t1\n34294.0\t15700.0\t0\t1\n34443.0\t12100.0\t0\t1\n34462.0\t9100.0\t0\t1\n34477.0\t13200.0\t0\t1\n34687.0\t2200.0\t1\t1\n34704.0\t5800.0\t0\t1\n34705.0\t12100.0\t0\t1\n34777.0\t11000.0\t0\t1\n34800.0\t13100.0\t1\t1\n34846.0\t5000.0\t0\t1\n34886.0\t20900.0\t0\t1\n34900.0\t5000.0\t1\t1\n35000.0\t5000.0\t0\t1\n35000.0\t15000.0\t1\t1\n35000.0\t25000.0\t0\t1\n35000.0\t31500.0\t1\t1\n35183.0\t14500.0\t0\t1\n35184.0\t27200.0\t1\t1\n35200.0\t10600.0\t1\t1\n35250.0\t6100.0\t0\t1\n35250.0\t9500.0\t0\t1\n35261.0\t10200.0\t0\t1\n35271.0\t26100.0\t0\t1\n35300.0\t15000.0\t0\t1\n35396.0\t13600.0\t0\t1\n35397.0\t26900.0\t0\t1\n35402.0\t5500.0\t0\t1\n35422.0\t7900.0\t0\t1\n35461.0\t5700.0\t0\t1\n35500.0\t10000.0\t1\t1\n35543.0\t24500.0\t0\t1\n35675.0\t5500.0\t1\t1\n35684.0\t27000.0\t0\t1\n35792.0\t10900.0\t0\t1\n35836.0\t6500.0\t0\t1\n35875.06\t30000.0\t0\t1\n35900.0\t6000.0\t1\t1\n35910.0\t7500.0\t1\t1\n36002.0\t12500.0\t0\t1\n36078.0\t5300.0\t1\t1\n36082.0\t31400.0\t0\t1\n36100.0\t3100.0\t1\t1\n36133.0\t9000.0\t0\t1\n36191.0\t6900.0\t0\t1\n36195.0\t6700.0\t0\t1\n36277.0\t26100.0\t0\t1\n36300.0\t32000.0\t0\t1\n36350.0\t2500.0\t1\t1\n36369.0\t7700.0\t0\t1\n36375.0\t5000.0\t0\t1\n36385.0\t5800.0\t0\t1\n36392.0\t28900.0\t1\t1\n36425.0\t5200.0\t0\t1\n36474.0\t11600.0\t0\t1\n36486.0\t34100.0\t0\t1\n36524.0\t5700.0\t0\t1\n36527.0\t8100.0\t0\t1\n36600.0\t9900.0\t1\t1\n36605.0\t9900.0\t0\t1\n36672.0\t12400.0\t0\t1\n36721.0\t9100.0\t1\t1\n36739.0\t8000.0\t1\t1\n36793.0\t9300.0\t0\t1\n36810.0\t5000.0\t1\t1\n36811.0\t7500.0\t1\t1\n36892.0\t7500.0\t0\t1\n36922.0\t11500.0\t0\t1\n37076.0\t35200.0\t0\t1\n37079.0\t35200.0\t0\t1\n37125.0\t7900.0\t0\t1\n37125.0\t9300.0\t1\t1\n37200.0\t4000.0\t1\t1\n37244.0\t9900.0\t0\t1\n37245.0\t13000.0\t0\t1\n37286.0\t8200.0\t0\t1\n37310.0\t26300.0\t0\t1\n37333.0\t30800.0\t0\t1\n37345.0\t6500.0\t0\t1\n37363.0\t33400.0\t0\t1\n37391.0\t17400.0\t0\t1\n37433.0\t16200.0\t0\t1\n37448.0\t6500.0\t0\t1\n37500.0\t5000.0\t1\t1\n37531.0\t27300.0\t0\t1\n37533.0\t8800.0\t1\t1\n37539.0\t18500.0\t0\t1\n37598.0\t34900.0\t0\t1\n37700.0\t10000.0\t1\t1\n37717.0\t11500.0\t0\t1\n37881.0\t12900.0\t0\t1\n37882.0\t12600.0\t0\t1\n37980.0\t17300.0\t0\t1\n38000.0\t14300.0\t0\t1\n38000.0\t24000.0\t1\t1\n38000.0\t30000.0\t0\t1\n38061.0\t7200.0\t0\t1\n38094.0\t30000.0\t0\t1\n38246.0\t11400.0\t0\t1\n38290.0\t9000.0\t0\t1\n38311.0\t22400.0\t0\t1\n38356.0\t27000.0\t0\t1\n38412.0\t33900.0\t0\t1\n38437.0\t13200.0\t0\t1\n38441.0\t27000.0\t0\t1\n38480.0\t15300.0\t1\t1\n38500.0\t8000.0\t1\t1\n38575.0\t5000.0\t1\t1\n38577.0\t12700.0\t0\t1\n38583.0\t32600.0\t0\t1\n38584.0\t32700.0\t0\t1\n38648.0\t8200.0\t0\t1\n38666.0\t3500.0\t1\t1\n38750.0\t12100.0\t1\t1\n38774.0\t14800.0\t0\t1\n38900.0\t15000.0\t1\t1\n38952.0\t11500.0\t1\t1\n38964.0\t26500.0\t0\t1\n39000.0\t3900.0\t1\t1\n39000.0\t10500.0\t0\t1\n39000.0\t12300.0\t1\t1\n39000.0\t27700.0\t1\t1\n39050.0\t6300.0\t0\t1\n39052.0\t5700.0\t0\t1\n39102.0\t14700.0\t0\t1\n39106.0\t8400.0\t0\t1\n39188.0\t15500.0\t0\t1\n39200.0\t12500.0\t0\t1\n39264.0\t12800.0\t0\t1\n39285.0\t15800.0\t0\t1\n39293.0\t9900.0\t1\t1\n39326.0\t8400.0\t0\t1\n39333.0\t30200.0\t0\t1\n39401.0\t35000.0\t0\t1\n39431.0\t8100.0\t1\t1\n39433.0\t11900.0\t0\t1\n39527.0\t5200.0\t1\t1\n39604.0\t27900.0\t1\t1\n39605.0\t15200.0\t0\t1\n39660.0\t7200.0\t1\t1\n39710.0\t8800.0\t0\t1\n39723.0\t18100.0\t0\t1\n39746.0\t15500.0\t0\t1\n39750.0\t10800.0\t1\t1\n39816.0\t8100.0\t1\t1\n39858.0\t27400.0\t0\t1\n39880.0\t9300.0\t0\t1\n39907.0\t5600.0\t0\t1\n39992.0\t10200.0\t1\t1\n40000.0\t9500.0\t1\t1\n40000.0\t15000.0\t1\t1\n40000.0\t32600.0\t0\t1\n40098.0\t18600.0\t0\t1\n40116.0\t10400.0\t0\t1\n40143.0\t13700.0\t0\t1\n40150.0\t2300.0\t1\t1\n40150.0\t7500.0\t1\t1\n40150.0\t9400.0\t0\t1\n40185.0\t7100.0\t0\t1\n40200.0\t8500.0\t1\t1\n40268.0\t33200.0\t0\t1\n40300.0\t9100.0\t1\t1\n40320.0\t1700.0\t1\t1\n40341.0\t7600.0\t0\t1\n40356.0\t30100.0\t0\t1\n40456.0\t22400.0\t1\t1\n40515.0\t32300.0\t0\t1\n40700.0\t13800.0\t1\t1\n40739.0\t12400.0\t0\t1\n40754.0\t14200.0\t0\t1\n40798.0\t18900.0\t1\t1\n40800.0\t2400.0\t1\t1\n40807.0\t27500.0\t0\t1\n40834.0\t3200.0\t1\t1\n40848.0\t35000.0\t0\t1\n40881.0\t13900.0\t0\t1\n40908.0\t15000.0\t0\t1\n41055.0\t17700.0\t0\t1\n41075.0\t13700.0\t0\t1\n41119.0\t5800.0\t0\t1\n41250.0\t10000.0\t1\t1\n41299.0\t12600.0\t0\t1\n41396.0\t12700.0\t0\t1\n41396.0\t17600.0\t0\t1\n41438.0\t8300.0\t0\t1\n41500.0\t39000.0\t1\t1\n41600.0\t46300.0\t1\t1\n41657.0\t6200.0\t0\t1\n41677.0\t16500.0\t0\t1\n41763.0\t28500.0\t0\t1\n41835.0\t14300.0\t0\t1\n41856.0\t5900.0\t1\t1\n41870.0\t14300.0\t0\t1\n41879.0\t16800.0\t0\t1\n41900.0\t23800.0\t1\t1\n41950.0\t8000.0\t1\t1\n41987.0\t14400.0\t0\t1\n42000.0\t6800.0\t1\t1\n42000.0\t7500.0\t1\t1\n42013.0\t33500.0\t0\t1\n42050.0\t7300.0\t1\t1\n42075.0\t15000.0\t1\t1\n42189.0\t34100.0\t0\t1\n42289.0\t8600.0\t1\t1\n42309.0\t8900.0\t0\t1\n42320.0\t36500.0\t0\t1\n42328.0\t33500.0\t0\t1\n42408.0\t9500.0\t0\t1\n42495.0\t6700.0\t1\t1\n42497.0\t10000.0\t0\t1\n42500.0\t14000.0\t1\t1\n42500.0\t21500.0\t0\t1\n42515.0\t27700.0\t0\t1\n42517.0\t25100.0\t0\t1\n42590.0\t22300.0\t0\t1\n42623.0\t34600.0\t0\t1\n42629.0\t16300.0\t0\t1\n42634.0\t33700.0\t0\t1\n42682.0\t13000.0\t0\t1\n42695.0\t12900.0\t0\t1\n42722.0\t15300.0\t0\t1\n42751.0\t14700.0\t0\t1\n42770.0\t8500.0\t1\t1\n42800.0\t22500.0\t0\t1\n42834.0\t36300.0\t0\t1\n42845.01\t12000.0\t1\t1\n42894.0\t16500.0\t0\t1\n42980.0\t8500.0\t0\t1\n43026.0\t35700.0\t0\t1\n43028.0\t35200.0\t0\t1\n43031.0\t25500.0\t0\t1\n43034.0\t1800.0\t1\t1\n43040.0\t31500.0\t1\t1\n43076.0\t10200.0\t0\t1\n43078.0\t15400.0\t0\t1\n43082.0\t13800.0\t0\t1\n43132.0\t5500.0\t1\t1\n43157.0\t12000.0\t0\t1\n43218.0\t31900.0\t0\t1\n43277.0\t27300.0\t0\t1\n43300.0\t6000.0\t0\t1\n43310.0\t17200.0\t0\t1\n43334.0\t15400.0\t0\t1\n43358.0\t32000.0\t0\t1\n43371.0\t32800.0\t0\t1\n43403.0\t23900.0\t0\t1\n43472.0\t26300.0\t0\t1\n43475.0\t14800.0\t0\t1\n43500.0\t9600.0\t1\t1\n43531.0\t15500.0\t0\t1\n43600.0\t13600.0\t1\t1\n43683.0\t6000.0\t1\t1\n43684.0\t17400.0\t0\t1\n43726.0\t33800.0\t0\t1\n43740.0\t19300.0\t1\t1\n43790.0\t15800.0\t0\t1\n43823.0\t36300.0\t0\t1\n43880.0\t16600.0\t0\t1\n43899.0\t15400.0\t0\t1\n43900.0\t15500.0\t1\t1\n43962.0\t20400.0\t1\t1\n43982.0\t33500.0\t0\t1\n44000.0\t39600.0\t1\t1\n44066.0\t14900.0\t0\t1\n44083.0\t42800.0\t1\t1\n44092.0\t13800.0\t0\t1\n44108.0\t9300.0\t0\t1\n44138.0\t9900.0\t0\t1\n44144.0\t15800.0\t0\t1\n44157.0\t41600.0\t1\t1\n44165.0\t16600.0\t0\t1\n44166.0\t25500.0\t1\t1\n44195.0\t13300.0\t0\t1\n44195.0\t14700.0\t0\t1\n44218.0\t13000.0\t0\t1\n44220.0\t31600.0\t0\t1\n44379.0\t33100.0\t0\t1\n44417.0\t13800.0\t0\t1\n44459.0\t13800.0\t0\t1\n44461.0\t15300.0\t0\t1\n44516.0\t2500.0\t0\t1\n44605.0\t14600.0\t1\t1\n44651.0\t7400.0\t0\t1\n44707.0\t25500.0\t0\t1\n44716.0\t10600.0\t0\t1\n44735.0\t30800.0\t0\t1\n44761.0\t28800.0\t0\t1\n44849.0\t11400.0\t0\t1\n44866.0\t16200.0\t0\t1\n44901.0\t13000.0\t0\t1\n45000.0\t4700.0\t1\t1\n45000.0\t7700.0\t0\t1\n45000.0\t21800.0\t1\t1\n45000.0\t24000.0\t0\t1\n45000.0\t26500.0\t1\t1\n45119.0\t17600.0\t0\t1\n45167.0\t24800.0\t0\t1\n45175.0\t8500.0\t0\t1\n45187.0\t5200.0\t0\t1\n45197.0\t9800.0\t0\t1\n45200.0\t6400.0\t1\t1\n45209.0\t16700.0\t0\t1\n45270.0\t32300.0\t0\t1\n45369.0\t25400.0\t0\t1\n45495.0\t30800.0\t0\t1\n45550.0\t11100.0\t0\t1\n45557.0\t32300.0\t0\t1\n45640.0\t33700.0\t0\t1\n45654.0\t9500.0\t1\t1\n45657.0\t15100.0\t0\t1\n45744.0\t22600.0\t0\t1\n45760.0\t4000.0\t0\t1\n45764.0\t25000.0\t0\t1\n45819.0\t13700.0\t0\t1\n45841.0\t7900.0\t0\t1\n45900.0\t3000.0\t1\t1\n45900.0\t8500.0\t1\t1\n45906.0\t9300.0\t0\t1\n45913.0\t26300.0\t0\t1\n45924.0\t43300.0\t1\t1\n45956.0\t8400.0\t1\t1\n45960.0\t3900.0\t1\t1\n46000.0\t4500.0\t1\t1\n46000.0\t18000.0\t0\t1\n46000.0\t41400.0\t0\t1\n46045.0\t3800.0\t0\t1\n46053.0\t14700.0\t0\t1\n46091.0\t33100.0\t0\t1\n46140.0\t16000.0\t0\t1\n46195.0\t9000.0\t1\t1\n46200.0\t2300.0\t1\t1\n46200.0\t30000.0\t1\t1\n46277.0\t12300.0\t0\t1\n46281.0\t5000.0\t0\t1\n46286.0\t33000.0\t0\t1\n46351.0\t6400.0\t0\t1\n46357.0\t31200.0\t0\t1\n46382.0\t16200.0\t1\t1\n46466.26\t8000.0\t0\t1\n46500.0\t20000.0\t0\t1\n46516.0\t6600.0\t0\t1\n46520.0\t7000.0\t1\t1\n46571.0\t43500.0\t0\t1\n46600.0\t10000.0\t1\t1\n46645.0\t5500.0\t1\t1\n46665.0\t23700.0\t0\t1\n46697.0\t35600.0\t0\t1\n46735.0\t5100.0\t1\t1\n46735.0\t27100.0\t0\t1\n46740.0\t2000.0\t1\t1\n46780.0\t10800.0\t0\t1\n46830.0\t6100.0\t0\t1\n46833.0\t5800.0\t1\t1\n46846.0\t23000.0\t0\t1\n46883.0\t20100.0\t0\t1\n46925.0\t16500.0\t1\t1\n46993.0\t14600.0\t0\t1\n47027.0\t19000.0\t1\t1\n47042.0\t11600.0\t0\t1\n47061.0\t25100.0\t0\t1\n47177.0\t27500.0\t0\t1\n47220.0\t11200.0\t0\t1\n47244.0\t8300.0\t1\t1\n47338.0\t15400.0\t0\t1\n47350.0\t5000.0\t1\t1\n47377.0\t10100.0\t0\t1\n47386.0\t21500.0\t0\t1\n47387.0\t12700.0\t1\t1\n47394.0\t15000.0\t1\t1\n47400.0\t6100.0\t0\t1\n47462.0\t7000.0\t0\t1\n47471.0\t2400.0\t1\t1\n47537.0\t21300.0\t0\t1\n47548.0\t20000.0\t0\t1\n47568.0\t13100.0\t0\t1\n47615.0\t15600.0\t0\t1\n47622.0\t24200.0\t0\t1\n47669.0\t22600.0\t0\t1\n47700.0\t13000.0\t0\t1\n47737.0\t11100.0\t0\t1\n47791.0\t8600.0\t0\t1\n47805.0\t31900.0\t0\t1\n47842.0\t10700.0\t0\t1\n47894.0\t33300.0\t0\t1\n47905.0\t13800.0\t0\t1\n47954.0\t5600.0\t0\t1\n47990.0\t13400.0\t0\t1\n48000.0\t8000.0\t1\t1\n48000.0\t10000.0\t1\t1\n48000.0\t12100.0\t0\t1\n48095.0\t15300.0\t0\t1\n48125.0\t14000.0\t0\t1\n48150.0\t11200.0\t0\t1\n48240.0\t7200.0\t0\t1\n48276.0\t15400.0\t0\t1\n48278.0\t12300.0\t1\t1\n48291.0\t24900.0\t0\t1\n48309.0\t12800.0\t0\t1\n48319.0\t41600.0\t0\t1\n48361.0\t21700.0\t0\t1\n48362.0\t12700.0\t0\t1\n48375.0\t25100.0\t0\t1\n48393.0\t12300.0\t0\t1\n48467.0\t14400.0\t0\t1\n48475.0\t24300.0\t0\t1\n48500.0\t14000.0\t0\t1\n48502.0\t5500.0\t1\t1\n48535.0\t43700.0\t0\t1\n48574.0\t11900.0\t1\t1\n48587.0\t13000.0\t0\t1\n48600.0\t10000.0\t1\t1\n48626.0\t9600.0\t0\t1\n48700.0\t25000.0\t1\t1\n48800.0\t6600.0\t0\t1\n48800.0\t15000.0\t0\t1\n48800.0\t24000.0\t1\t1\n48905.0\t9700.0\t0\t1\n48905.0\t33700.0\t0\t1\n48908.0\t43300.0\t0\t1\n48971.0\t17400.0\t0\t1\n49000.0\t7000.0\t0\t1\n49000.0\t8000.0\t0\t1\n49000.0\t8400.0\t1\t1\n49000.0\t22100.0\t0\t1\n49041.0\t20800.0\t0\t1\n49044.0\t4500.0\t0\t1\n49060.0\t14200.0\t1\t1\n49100.0\t17300.0\t0\t1\n49147.0\t8900.0\t0\t1\n49244.0\t14600.0\t0\t1\n49266.0\t10000.0\t0\t1\n49326.0\t13000.0\t1\t1\n49331.0\t8200.0\t0\t1\n49362.0\t8200.0\t0\t1\n49396.0\t5300.0\t0\t1\n49433.0\t24100.0\t0\t1\n49442.0\t18900.0\t0\t1\n49495.0\t10800.0\t0\t1\n49523.0\t25000.0\t0\t1\n49525.0\t28900.0\t0\t1\n49600.0\t10000.0\t0\t1\n49621.0\t21800.0\t0\t1\n49750.0\t7500.0\t1\t1\n49756.0\t10700.0\t1\t1\n49794.0\t14300.0\t0\t1\n49804.0\t7500.0\t0\t1\n49836.0\t27700.0\t0\t1\n49840.0\t7000.0\t1\t1\n49842.0\t23900.0\t0\t1\n49843.0\t20200.0\t0\t1\n49906.0\t23000.0\t0\t1\n49912.0\t29000.0\t0\t1\n49950.0\t8400.0\t0\t1\n49970.0\t14500.0\t1\t1\n50000.0\t4500.0\t0\t1\n50000.0\t7200.0\t1\t1\n50000.0\t11600.0\t0\t1\n50000.0\t15000.0\t1\t1\n50000.0\t20000.0\t1\t1\n50000.0\t30000.0\t1\t1\n50000.0\t35000.0\t0\t1\n50000.0\t39500.0\t1\t1\n50006.0\t8300.0\t0\t1\n50061.0\t8200.0\t0\t1\n50070.0\t8700.0\t0\t1\n50125.0\t7500.0\t1\t1\n50150.0\t20000.0\t0\t1\n50177.0\t23300.0\t0\t1\n50225.0\t4200.0\t1\t1\n50225.0\t10600.0\t0\t1\n50262.0\t11100.0\t0\t1\n50309.0\t7800.0\t0\t1\n50309.0\t15900.0\t0\t1\n50340.0\t5000.0\t0\t1\n50375.0\t24000.0\t0\t1\n50386.0\t8600.0\t0\t1\n50391.0\t9100.0\t0\t1\n50409.0\t28600.0\t0\t1\n50434.0\t8100.0\t0\t1\n50448.0\t8300.0\t0\t1\n50486.0\t6600.0\t0\t1\n50493.0\t14600.0\t0\t1\n50530.0\t12300.0\t0\t1\n50534.0\t26100.0\t0\t1\n50548.0\t10300.0\t0\t1\n50575.0\t9400.0\t0\t1\n50594.0\t27800.0\t0\t1\n50602.0\t24000.0\t0\t1\n50673.0\t5300.0\t0\t1\n50681.0\t42000.0\t1\t1\n50688.0\t25300.0\t0\t1\n50696.0\t44500.0\t0\t1\n50704.0\t39000.0\t0\t1\n50725.0\t9000.0\t1\t1\n50732.0\t16600.0\t0\t1\n50750.0\t18000.0\t0\t1\n50760.0\t44000.0\t0\t1\n50798.0\t7400.0\t0\t1\n50800.0\t45700.0\t1\t1\n50830.0\t5000.0\t1\t1\n50848.0\t13600.0\t0\t1\n50872.0\t25100.0\t0\t1\n50892.0\t15200.0\t0\t1\n50900.0\t7500.0\t0\t1\n50931.0\t14800.0\t0\t1\n50933.0\t17600.0\t0\t1\n50963.0\t25200.0\t0\t1\n51000.0\t10000.0\t0\t1\n51023.0\t26300.0\t0\t1\n51053.0\t10300.0\t0\t1\n51055.0\t26300.0\t0\t1\n51057.0\t8800.0\t1\t1\n51068.0\t20000.0\t0\t1\n51123.0\t12800.0\t0\t1\n51165.0\t44100.0\t0\t1\n51189.0\t5900.0\t0\t1\n51246.0\t11800.0\t0\t1\n51337.0\t21600.0\t0\t1\n51389.0\t37700.0\t0\t1\n51454.0\t16400.0\t0\t1\n51496.0\t43500.0\t0\t1\n51549.0\t16900.0\t0\t1\n51599.0\t28600.0\t0\t1\n51607.0\t23500.0\t0\t1\n51610.0\t7500.0\t1\t1\n51623.0\t24500.0\t0\t1\n51631.0\t22300.0\t0\t1\n51653.0\t14700.0\t0\t1\n51666.0\t6400.0\t0\t1\n51680.0\t9300.0\t0\t1\n51684.0\t10000.0\t0\t1\n51703.0\t8600.0\t0\t1\n51720.0\t14500.0\t0\t1\n51732.0\t6200.0\t0\t1\n51740.0\t9000.0\t0\t1\n51792.0\t16000.0\t0\t1\n51800.0\t25700.0\t0\t1\n51821.0\t11600.0\t0\t1\n51823.0\t35600.0\t0\t1\n51824.0\t25800.0\t0\t1\n51841.0\t9000.0\t0\t1\n51846.0\t8400.0\t0\t1\n51900.0\t12000.0\t1\t1\n51952.0\t6900.0\t0\t1\n51974.0\t25600.0\t0\t1\n51984.0\t11800.0\t0\t1\n51986.0\t8300.0\t0\t1\n51990.0\t9700.0\t0\t1\n51994.0\t16400.0\t0\t1\n52000.0\t3400.0\t1\t1\n52000.0\t5000.0\t1\t1\n52000.0\t16100.0\t1\t1\n52000.0\t20000.0\t0\t1\n52012.0\t4000.0\t1\t1\n52016.0\t13600.0\t0\t1\n52026.0\t12500.0\t0\t1\n52029.0\t14400.0\t0\t1\n52040.0\t5400.0\t0\t1\n52040.0\t21700.0\t0\t1\n52054.0\t23000.0\t0\t1\n52228.0\t24500.0\t0\t1\n52234.0\t15900.0\t0\t1\n52320.0\t10400.0\t0\t1\n52329.0\t25500.0\t0\t1\n52340.0\t22100.0\t0\t1\n52355.0\t10900.0\t0\t1\n52411.0\t12400.0\t0\t1\n52422.0\t7800.0\t0\t1\n52457.0\t14600.0\t0\t1\n52482.0\t16000.0\t0\t1\n52490.0\t3600.0\t1\t1\n52544.0\t11900.0\t0\t1\n52545.0\t30300.0\t1\t1\n52554.0\t9800.0\t0\t1\n52710.0\t9500.0\t0\t1\n52800.0\t15700.0\t0\t1\n52804.0\t22900.0\t0\t1\n52822.0\t15500.0\t0\t1\n52910.0\t11100.0\t0\t1\n52911.0\t11300.0\t0\t1\n52938.0\t12000.0\t0\t1\n52946.0\t9100.0\t0\t1\n53000.0\t7900.0\t0\t1\n53040.0\t16500.0\t0\t1\n53078.0\t41600.0\t0\t1\n53079.0\t12000.0\t0\t1\n53095.0\t10000.0\t1\t1\n53100.0\t30000.0\t1\t1\n53102.0\t6500.0\t0\t1\n53120.0\t36800.0\t0\t1\n53149.0\t13000.0\t0\t1\n53184.0\t15300.0\t0\t1\n53190.0\t6000.0\t0\t1\n53200.0\t13900.0\t0\t1\n53214.0\t17900.0\t0\t1\n53238.0\t15100.0\t0\t1\n53300.0\t21500.0\t0\t1\n53321.0\t14100.0\t0\t1\n53365.0\t18000.0\t0\t1\n53388.0\t6100.0\t0\t1\n53434.0\t43300.0\t0\t1\n53448.0\t5000.0\t0\t1\n53462.0\t26700.0\t0\t1\n53500.0\t7000.0\t1\t1\n53511.0\t12700.0\t0\t1\n53521.0\t5200.0\t0\t1\n53543.0\t7900.0\t0\t1\n53622.0\t36200.0\t0\t1\n53683.0\t11300.0\t0\t1\n53754.0\t10500.0\t0\t1\n53758.0\t12900.0\t0\t1\n53800.0\t10000.0\t1\t1\n53807.0\t21700.0\t0\t1\n53814.0\t19300.0\t0\t1\n53877.0\t10500.0\t0\t1\n53893.0\t5600.0\t0\t1\n53907.0\t10500.0\t0\t1\n53907.0\t26800.0\t1\t1\n53943.0\t21700.0\t0\t1\n53969.0\t12000.0\t1\t1\n54000.0\t8000.0\t0\t1\n54000.0\t9800.0\t1\t1\n54000.0\t12000.0\t0\t1\n54000.0\t14300.0\t1\t1\n54000.0\t16000.0\t0\t1\n54024.0\t24700.0\t0\t1\n54038.0\t20400.0\t0\t1\n54040.0\t10400.0\t0\t1\n54046.0\t43800.0\t0\t1\n54049.0\t22400.0\t1\t1\n54065.0\t15100.0\t0\t1\n54073.0\t8600.0\t0\t1\n54138.0\t7400.0\t0\t1\n54146.0\t10000.0\t1\t1\n54212.0\t21600.0\t0\t1\n54299.0\t11900.0\t0\t1\n54300.0\t10000.0\t1\t1\n54314.0\t8400.0\t0\t1\n54375.0\t17000.0\t1\t1\n54378.0\t7100.0\t0\t1\n54385.0\t9700.0\t0\t1\n54436.0\t21100.0\t0\t1\n54452.0\t36200.0\t0\t1\n54464.0\t25100.0\t0\t1\n54499.0\t25700.0\t0\t1\n54500.0\t10000.0\t1\t1\n54522.0\t28100.0\t0\t1\n54536.0\t9700.0\t1\t1\n54557.0\t15700.0\t0\t1\n54561.0\t17600.0\t0\t1\n54563.0\t26000.0\t0\t1\n54600.0\t6000.0\t1\t1\n54600.0\t10000.0\t1\t1\n54605.0\t10100.0\t0\t1\n54701.0\t22700.0\t0\t1\n54707.0\t8400.0\t0\t1\n54775.0\t24400.0\t0\t1\n54869.0\t15000.0\t1\t1\n54904.0\t6000.0\t1\t1\n54905.0\t8600.0\t0\t1\n54923.0\t20800.0\t0\t1\n54966.0\t6100.0\t0\t1\n54970.0\t15300.0\t0\t1\n54976.0\t38900.0\t0\t1\n54985.0\t14500.0\t0\t1\n55000.0\t2000.0\t1\t1\n55000.0\t7100.0\t1\t1\n55000.0\t8400.0\t0\t1\n55000.0\t10300.0\t1\t1\n55000.0\t21000.0\t1\t1\n55000.0\t23000.0\t1\t1\n55000.0\t49500.0\t1\t1\n55024.0\t20600.0\t0\t1\n55027.0\t20300.0\t0\t1\n55079.0\t12000.0\t0\t1\n55085.0\t4200.0\t0\t1\n55100.0\t35100.0\t0\t1\n55114.0\t11200.0\t0\t1\n55299.0\t10400.0\t0\t1\n55320.0\t5000.0\t0\t1\n55320.0\t13400.0\t1\t1\n55350.0\t9300.0\t0\t1\n55376.0\t22600.0\t0\t1\n55396.0\t6700.0\t0\t1\n55419.0\t22600.0\t0\t1\n55421.0\t15400.0\t0\t1\n55455.0\t9600.0\t0\t1\n55483.0\t26700.0\t0\t1\n55500.0\t8600.0\t0\t1\n55500.0\t15000.0\t1\t1\n55549.0\t23700.0\t0\t1\n55578.0\t42200.0\t0\t1\n55582.0\t20900.0\t0\t1\n55657.0\t32900.0\t1\t1\n55669.0\t23800.0\t0\t1\n55700.0\t25000.0\t0\t1\n55703.0\t20300.0\t0\t1\n55728.0\t10100.0\t0\t1\n55734.0\t18100.0\t0\t1\n55757.0\t7900.0\t0\t1\n55760.0\t5400.0\t0\t1\n55764.0\t9400.0\t0\t1\n55784.0\t10500.0\t0\t1\n55796.0\t17700.0\t0\t1\n55848.0\t8200.0\t0\t1\n56000.0\t8400.0\t1\t1\n56000.0\t9000.0\t1\t1\n56000.0\t9700.0\t1\t1\n56000.0\t10000.0\t1\t1\n56088.0\t10300.0\t0\t1\n56100.0\t8000.0\t0\t1\n56134.0\t9100.0\t0\t1\n56206.0\t10200.0\t0\t1\n56218.0\t10600.0\t0\t1\n56235.0\t8000.0\t0\t1\n56236.0\t36100.0\t0\t1\n56247.0\t10500.0\t1\t1\n56295.0\t20100.0\t0\t1\n56373.0\t20000.0\t0\t1\n56374.0\t16700.0\t0\t1\n56386.0\t8100.0\t0\t1\n56390.0\t23000.0\t0\t1\n56394.0\t13300.0\t0\t1\n56400.0\t3000.0\t0\t1\n56402.0\t17700.0\t0\t1\n56429.0\t9100.0\t0\t1\n56465.0\t16700.0\t0\t1\n56475.0\t10000.0\t0\t1\n56481.0\t20600.0\t0\t1\n56486.0\t6700.0\t0\t1\n56514.0\t11600.0\t0\t1\n56529.0\t10900.0\t1\t1\n56532.0\t36300.0\t0\t1\n56535.0\t21200.0\t0\t1\n56571.0\t13600.0\t0\t1\n56600.0\t11400.0\t0\t1\n56631.0\t16600.0\t0\t1\n56639.0\t22400.0\t0\t1\n56656.0\t12300.0\t0\t1\n56658.0\t18200.0\t0\t1\n56733.0\t25700.0\t0\t1\n56776.0\t28800.0\t0\t1\n56782.0\t9000.0\t0\t1\n56824.0\t22400.0\t0\t1\n56834.0\t15400.0\t0\t1\n56851.0\t11000.0\t0\t1\n56874.0\t27400.0\t1\t1\n56900.0\t9600.0\t0\t1\n56961.0\t16900.0\t0\t1\n57000.0\t10200.0\t0\t1\n57000.0\t12600.0\t1\t1\n57000.0\t25000.0\t1\t1\n57000.0\t30000.0\t0\t1\n57036.0\t9300.0\t0\t1\n57036.0\t21900.0\t0\t1\n57037.0\t1800.0\t1\t1\n57048.0\t24500.0\t0\t1\n57067.0\t6900.0\t0\t1\n57081.0\t12500.0\t0\t1\n57095.0\t14900.0\t0\t1\n57109.0\t22900.0\t0\t1\n57125.0\t14000.0\t0\t1\n57132.0\t11800.0\t0\t1\n57135.0\t15400.0\t0\t1\n57150.0\t6800.0\t0\t1\n57151.0\t19100.0\t0\t1\n57156.0\t22700.0\t0\t1\n57182.0\t9300.0\t0\t1\n57184.0\t15400.0\t0\t1\n57224.0\t10800.0\t0\t1\n57276.0\t8500.0\t0\t1\n57280.0\t9500.0\t0\t1\n57280.0\t23600.0\t0\t1\n57285.0\t7900.0\t0\t1\n57310.0\t15000.0\t0\t1\n57311.0\t36400.0\t0\t1\n57365.0\t9800.0\t0\t1\n57385.0\t6200.0\t1\t1\n57420.0\t17700.0\t0\t1\n57436.0\t33000.0\t0\t1\n57444.0\t12400.0\t0\t1\n57453.0\t5400.0\t1\t1\n57460.0\t6000.0\t0\t1\n57473.0\t8600.0\t0\t1\n57500.0\t7800.0\t0\t1\n57501.0\t26500.0\t0\t1\n57507.0\t9700.0\t0\t1\n57518.0\t25900.0\t1\t1\n57608.0\t13300.0\t0\t1\n57622.0\t17800.0\t0\t1\n57650.0\t9300.0\t0\t1\n57680.0\t9500.0\t0\t1\n57682.0\t10500.0\t0\t1\n57686.0\t10600.0\t0\t1\n57713.0\t13000.0\t0\t1\n57742.0\t10800.0\t0\t1\n57761.0\t22800.0\t0\t1\n57779.0\t6300.0\t0\t1\n57787.0\t12900.0\t0\t1\n57799.0\t7500.0\t0\t1\n57822.0\t16000.0\t0\t1\n57831.0\t17200.0\t0\t1\n57838.0\t12900.0\t0\t1\n57839.0\t8300.0\t0\t1\n57862.0\t16100.0\t0\t1\n57905.0\t20300.0\t0\t1\n57912.0\t6800.0\t0\t1\n57923.0\t12400.0\t0\t1\n57940.0\t15100.0\t0\t1\n57986.0\t23900.0\t0\t1\n57991.0\t15300.0\t0\t1\n58000.0\t12000.0\t1\t1\n58000.0\t13000.0\t1\t1\n58000.0\t15000.0\t1\t1\n58000.0\t24100.0\t1\t1\n58049.0\t20500.0\t0\t1\n58056.0\t9900.0\t0\t1\n58074.0\t27000.0\t0\t1\n58084.0\t6700.0\t0\t1\n58088.0\t6900.0\t1\t1\n58089.0\t31500.0\t0\t1\n58157.0\t6400.0\t0\t1\n58157.0\t36600.0\t0\t1\n58191.0\t5800.0\t0\t1\n58216.0\t27200.0\t0\t1\n58238.0\t4700.0\t1\t1\n58240.0\t10000.0\t0\t1\n58249.0\t5700.0\t0\t1\n58275.0\t9000.0\t1\t1\n58282.0\t37800.0\t0\t1\n58305.0\t6000.0\t1\t1\n"},{"type":"HTML","data":"<div class=\"result-alert alert-warning\" role=\"alert\"><button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button><strong>Output is truncated</strong> to 1000 rows. Learn more about <strong>common.max_count</strong></div>"}]},"apps":[],"jobName":"paragraph_1647043955972_-1128520423","id":"20220312-011235_1493776278","dateCreated":"2022-03-12T01:12:35+0100","dateStarted":"2022-03-12T19:38:04+0100","dateFinished":"2022-03-12T19:38:12+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37623"},{"text":"%md\n\n<h2 style=\"font-family: Verdana\"><font color=\"#7133FF\"><strong> III- Nettoyage et traitement des données sous Pyspark </strong></font></h2>","user":"imsduser","dateUpdated":"2022-03-15T23:45:34+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2 style=\"font-family: Verdana\"><font color=\"#7133FF\"><strong> III- Nettoyage et traitement des données sous Pyspark </strong></font></h2>\n"}]},"apps":[],"jobName":"paragraph_1646900704472_-2098806333","id":"20220310-092504_1328639245","dateCreated":"2022-03-10T09:25:04+0100","dateStarted":"2022-03-15T23:45:34+0100","dateFinished":"2022-03-15T23:45:34+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37624"},{"text":"%pyspark\n# Suppression des éventuels doublons\ndff = dff.drop_duplicates()\n\ntrain, test = dff.randomSplit([0.8, 0.2], seed=1337)\nprint(\"data shape\", (dff.count(), len(dff.columns)))\nprint(\"train shape\", (train.count(), len(train.columns)))\nprint(\"test shape\", (test.count(), len(test.columns)))\n","user":"imsduser","dateUpdated":"2022-03-15T03:16:00+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"('data shape', (5960, 13))\n('train shape', (4776, 13))\n('test shape', (1184, 13))\n"}]},"apps":[],"jobName":"paragraph_1647306849036_1261963931","id":"20220315-021409_1681141716","dateCreated":"2022-03-15T02:14:09+0100","dateStarted":"2022-03-15T03:16:00+0100","dateFinished":"2022-03-15T03:16:08+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37625"},{"text":"%md\n\n<h3 style=\"font-family: Verdana\"><font color=\"#FF33F6\"><strong>1 - Traitement des valeurs manquantes </strong></font></h3>","user":"imsduser","dateUpdated":"2022-03-15T23:46:58+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3 style=\"font-family: Verdana\"><font color=\"#FF33F6\"><strong>1 - Traitement des valeurs manquantes </strong></font></h3>\n"}]},"apps":[],"jobName":"paragraph_1647380997604_-479569549","id":"20220315-224957_1170498285","dateCreated":"2022-03-15T22:49:57+0100","dateStarted":"2022-03-15T23:46:18+0100","dateFinished":"2022-03-15T23:46:18+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37626"},{"text":"%md\nIl est important de comprendre pourquoi on a des données manquantes pour une colonne donnée dans un ensemble de données. Parmi les raisons possibles de l’absence de données on cite :\n  - Ce champ n’est pas applicable à tous les clients\n  - Ce champ contient des informations facultatives que les clients ne sont pas tenus de fournir\n  - L’information n’est pas disponible parce que elle n’a pas pas été demandée au client, ou parce qu’elle a été demandée et que le client ne l’a pas fournie\n  - Les informations pour les champs n’ont pas été collectées avant ou après une date spécifique.\n\nSelon la nature et la raison pour laquelle l’information est manquante, certaines colonnes de données doivent être traitées avec des techniques permettant de traiter des valeurs  manquantes","user":"imsduser","dateUpdated":"2022-03-15T22:49:50+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Il est important de comprendre pourquoi on a des données manquantes pour une colonne donnée dans un ensemble de données. Parmi les raisons possibles de l’absence de données on cite :</p>\n<ul>\n<li>Ce champ n’est pas applicable à tous les clients</li>\n<li>Ce champ contient des informations facultatives que les clients ne sont pas tenus de fournir</li>\n<li>L’information n’est pas disponible parce que elle n’a pas pas été demandée au client, ou parce qu’elle a été demandée et que le client ne l’a pas fournie</li>\n<li>Les informations pour les champs n’ont pas été collectées avant ou après une date spécifique.</li>\n</ul>\n<p>Selon la nature et la raison pour laquelle l’information est manquante, certaines colonnes de données doivent être traitées avec des techniques permettant de traiter des valeurs  manquantes</p>\n"}]},"apps":[],"jobName":"paragraph_1647008214710_-211836402","id":"20220311-151654_1252830396","dateCreated":"2022-03-11T15:16:54+0100","dateStarted":"2022-03-15T14:09:20+0100","dateFinished":"2022-03-15T14:09:20+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37627"},{"text":"%md\nOn considère qu'au delà de 40% de valeurs manquantes, une stratégie d'imputation risque d'introduire un biais dans l'analyse, donc nous ne la mettrons pas en oeuvre dans ce cas.\n\nLa méthodologie employée pour imputer les données manquantes est la suivante :\n\n   - Variables quantitatives : On va se baser sur la distribution de la variable, si sa distribution est asymétrique, on va imputer par la médiane et sinon par la moyenne.\n    Les variables asymétriques sont : dans le train et dans le test MORTDUE, VALUE, DEROG, DELINQ, CLAGE, NINQ,  DEBTINC\n    Les  variables symétriques dans le Train set sont : YOJ et CLNO \n   - Variables qualitatives : On va considérer le % de données manquantes, si celui-ci est inférieur à 15%, on va imputer par la valeur la plus fréquente (donc le mode), sinon on sera amené à créer une nouvelle classe nommée \"autres\".\n    \n   - Les  variables avec - de 15% de Nan sont, dans le Train set : REASON et JOB. Les mêmes dans le Test set.\n   - Aucune variable n'a + 15% de Nan ni dans le train ni dans le test set\nLes valeurs imputées dans le train set seront répercutées dans le test set.\n\n","user":"imsduser","dateUpdated":"2022-03-15T14:13:26+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>On considère qu'au delà de 40% de valeurs manquantes, une stratégie d'imputation risque d'introduire un biais dans l'analyse, donc nous ne la mettrons pas en oeuvre dans ce cas.</p>\n<p>La méthodologie employée pour imputer les données manquantes est la suivante :</p>\n<ul>\n<li><p>Variables quantitatives : On va se baser sur la distribution de la variable, si sa distribution est asymétrique, on va imputer par la médiane et sinon par la moyenne.\n<br  />Les variables asymétriques sont : dans le train et dans le test MORTDUE, VALUE, DEROG, DELINQ, CLAGE, NINQ,  DEBTINC\n<br  />Les  variables symétriques dans le Train set sont : YOJ et CLNO</p>\n</li>\n<li><p>Variables qualitatives : On va considérer le % de données manquantes, si celui-ci est inférieur à 15%, on va imputer par la valeur la plus fréquente (donc le mode), sinon on sera amené à créer une nouvelle classe nommée &ldquo;autres&rdquo;.</p>\n</li>\n<li><p>Les  variables avec - de 15% de Nan sont, dans le Train set : REASON et JOB. Les mêmes dans le Test set.</p>\n</li>\n<li><p>Aucune variable n'a + 15% de Nan ni dans le train ni dans le test set\n<br  />Les valeurs imputées dans le train set seront répercutées dans le test set.</p>\n</li>\n</ul>\n"}]},"apps":[],"jobName":"paragraph_1647299345564_-101051690","id":"20220315-000905_1771487683","dateCreated":"2022-03-15T00:09:05+0100","dateStarted":"2022-03-15T14:13:14+0100","dateFinished":"2022-03-15T14:13:14+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37628"},{"text":"%spark2.pyspark\n# Nombre de valeurs manquantes\nprint(\"---- Nombre de valeurs manquantes dans le Train\")\ntrain.select([count(when(col(c).contains('NULL') | \\\n                            (col(c) == '' ) | \\\n                            col(c).isNull() | \\\n                            isnan(c), c \n                           )).alias(c)\n                    for c in train.columns]).show()\n                    \nprint(\"---- Nombre de valeurs manquantes dans le Test\")\ntest.select([count(when(col(c).contains('NULL') | \\\n                            (col(c) == '' ) | \\\n                            col(c).isNull() | \\\n                            isnan(c), c \n                           )).alias(c)\n                    for c in test.columns]).show()","user":"imsduser","dateUpdated":"2022-03-15T23:14:05+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"---- Nombre de valeurs manquantes dans le Train\n+---+----+-------+-----+------+---+---+-----+------+-----+----+----+-------+\n|bad|loan|mortdue|value|reason|job|yoj|derog|delinq|clage|ninq|clno|debtinc|\n+---+----+-------+-----+------+---+---+-----+------+-----+----+----+-------+\n|  0|   0|    405|   88|   210|226|423|  573|   466|  251| 410| 180|   1018|\n+---+----+-------+-----+------+---+---+-----+------+-----+----+----+-------+\n\n---- Nombre de valeurs manquantes dans le Test\n+---+----+-------+-----+------+---+---+-----+------+-----+----+----+-------+\n|bad|loan|mortdue|value|reason|job|yoj|derog|delinq|clage|ninq|clno|debtinc|\n+---+----+-------+-----+------+---+---+-----+------+-----+----+----+-------+\n|  0|   0|    113|   24|    42| 53| 92|  135|   114|   57| 100|  42|    249|\n+---+----+-------+-----+------+---+---+-----+------+-----+----+----+-------+\n\n"}]},"apps":[],"jobName":"paragraph_1647046170842_-2046173386","id":"20220312-014930_1132517411","dateCreated":"2022-03-12T01:49:30+0100","dateStarted":"2022-03-15T03:16:44+0100","dateFinished":"2022-03-15T03:16:50+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37629"},{"text":"%spark2.pyspark\nprint(\"---- Pourcentage de valeurs manquantes dans le Train\")\nnan = train.select([(count(when(col(c).contains('NULL') | \\\n                            (col(c) == '' ) | \\\n                            col(c).isNull() | \\\n                            isnan(c), c \n                           ))/train.count()*100).alias(c)\n                    for c in train.columns]).show()\n                    \nprint(\"---- Pourcentage de valeurs manquantes dans le Test\")                 \nnan = test.select([(count(when(col(c).contains('NULL') | \\\n                            (col(c) == '' ) | \\\n                            col(c).isNull() | \\\n                            isnan(c), c \n                           ))/test.count()*100).alias(c)\n                    for c in test.columns]).show()","user":"imsduser","dateUpdated":"2022-03-15T23:14:05+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"---- Pourcentage de valeurs manquantes dans le Train\n+---+----+-----------------+------------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+----------------+------------------+------------------+\n|bad|loan|          mortdue|             value|           reason|              job|              yoj|            derog|           delinq|            clage|            ninq|              clno|           debtinc|\n+---+----+-----------------+------------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+----------------+------------------+------------------+\n|0.0| 0.0|8.479899497487438|1.8425460636515913|4.396984924623116|4.731993299832496|8.856783919597989|11.99748743718593|9.757118927973199|5.255443886097153|8.58458961474037|3.7688442211055273|21.314907872696818|\n+---+----+-----------------+------------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+----------------+------------------+------------------+\n\n---- Pourcentage de valeurs manquantes dans le Test\n+---+----+----------------+-----------------+------------------+-----------------+----------------+------------------+-----------------+------------------+-----------------+------------------+------------------+\n|bad|loan|         mortdue|            value|            reason|              job|             yoj|             derog|           delinq|             clage|             ninq|              clno|           debtinc|\n+---+----+----------------+-----------------+------------------+-----------------+----------------+------------------+-----------------+------------------+-----------------+------------------+------------------+\n|0.0| 0.0|9.54391891891892|2.027027027027027|3.5472972972972974|4.476351351351352|7.77027027027027|11.402027027027026|9.628378378378379|4.8141891891891895|8.445945945945946|3.5472972972972974|21.030405405405407|\n+---+----+----------------+-----------------+------------------+-----------------+----------------+------------------+-----------------+------------------+-----------------+------------------+------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1647291441869_664721288","id":"20220314-215721_457819326","dateCreated":"2022-03-14T21:57:21+0100","dateStarted":"2022-03-15T03:17:29+0100","dateFinished":"2022-03-15T03:18:30+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37630"},{"text":"%md\n\n<h3 style=\"font-family: Verdana\"><font color=\"#FF33F6\"><strong>2 - Imputation des variables quantitatives </strong></font></h3>\n","user":"imsduser","dateUpdated":"2022-03-15T23:46:58+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3 style=\"font-family: Verdana\"><font color=\"#FF33F6\"><strong>2 - Imputation des variables quantitatives </strong></font></h3>\n"}]},"apps":[],"jobName":"paragraph_1647296654576_-1298633809","id":"20220314-232414_1094531058","dateCreated":"2022-03-14T23:24:14+0100","dateStarted":"2022-03-15T23:46:47+0100","dateFinished":"2022-03-15T23:46:47+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37631"},{"text":"%spark2.pyspark\nintCols         = [item[0] for item in dff.dtypes if item[1].startswith('int')]\ncontinuousCols  = [item[0] for item in dff.dtypes if item[1].startswith('float')]\nnumsCols        = intCols + continuousCols\nnumsCols","user":"imsduser","dateUpdated":"2022-03-15T03:17:34+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"['yoj', 'derog', 'delinq', 'ninq', 'clno', 'loan', 'mortdue', 'value', 'clage', 'debtinc']\n"}]},"apps":[],"jobName":"paragraph_1647296757723_-89029240","id":"20220314-232557_92157719","dateCreated":"2022-03-14T23:25:57+0100","dateStarted":"2022-03-15T03:17:34+0100","dateFinished":"2022-03-15T03:18:30+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37632"},{"text":"%spark2.pyspark\n# Train set\nfor col in numsCols:\n    train.select(skewness(col)).show(truncate=False)","user":"imsduser","dateUpdated":"2022-03-15T23:14:30+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------------+\n|skewness(yoj)     |\n+------------------+\n|0.9733121441758525|\n+------------------+\n\n+-----------------+\n|skewness(derog)  |\n+-----------------+\n|5.300698400327045|\n+-----------------+\n\n+-----------------+\n|skewness(delinq) |\n+-----------------+\n|3.801505474348424|\n+-----------------+\n\n+-----------------+\n|skewness(ninq)   |\n+-----------------+\n|2.632859927912825|\n+-----------------+\n\n+------------------+\n|skewness(clno)    |\n+------------------+\n|0.8108323890569925|\n+------------------+\n\n+------------------+\n|skewness(loan)    |\n+------------------+\n|2.0174398469985824|\n+------------------+\n\n+------------------+\n|skewness(mortdue) |\n+------------------+\n|1.7428225000307533|\n+------------------+\n\n+------------------+\n|skewness(value)   |\n+------------------+\n|3.2507956421752833|\n+------------------+\n\n+------------------+\n|skewness(clage)   |\n+------------------+\n|1.4328564921334837|\n+------------------+\n\n+------------------+\n|skewness(debtinc) |\n+------------------+\n|1.7526136345809444|\n+------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1647296779313_1506386531","id":"20220314-232619_1280432810","dateCreated":"2022-03-14T23:26:19+0100","dateStarted":"2022-03-15T03:18:30+0100","dateFinished":"2022-03-15T03:18:48+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37633"},{"text":"%spark2.pyspark\n# Test set\nfor col in numsCols:\n    test.select(skewness(col)).show(truncate=False)","user":"imsduser","dateUpdated":"2022-03-15T03:18:31+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------------+\n|skewness(yoj)     |\n+------------------+\n|1.0242511888051766|\n+------------------+\n\n+----------------+\n|skewness(derog) |\n+----------------+\n|5.33648219699897|\n+----------------+\n\n+------------------+\n|skewness(delinq)  |\n+------------------+\n|4.8985829397914715|\n+------------------+\n\n+-----------------+\n|skewness(ninq)   |\n+-----------------+\n|2.531830307677544|\n+-----------------+\n\n+------------------+\n|skewness(clno)    |\n+------------------+\n|0.6254204146309098|\n+------------------+\n\n+-----------------+\n|skewness(loan)   |\n+-----------------+\n|2.046767458645449|\n+-----------------+\n\n+------------------+\n|skewness(mortdue) |\n+------------------+\n|2.0863725973414127|\n+------------------+\n\n+------------------+\n|skewness(value)   |\n+------------------+\n|2.0092767973852235|\n+------------------+\n\n+------------------+\n|skewness(clage)   |\n+------------------+\n|0.8307313178118615|\n+------------------+\n\n+-----------------+\n|skewness(debtinc)|\n+-----------------+\n|5.559103207164994|\n+-----------------+\n\n"}]},"apps":[],"jobName":"paragraph_1647308082594_874295215","id":"20220315-023442_730208245","dateCreated":"2022-03-15T02:34:42+0100","dateStarted":"2022-03-15T03:18:31+0100","dateFinished":"2022-03-15T03:19:06+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37634"},{"text":"%md\nOn va imputer les variables \"mortdue\", \"value\",\"derog\",\"delinq\",\"clage\",\"ninq\",\"debtinc\" par la médiane (car leur skweness est strictement différente de 0, donc leurs distributions sont asymétriques) et les variables \"yoj\",\"clno\" par leur moyenne.","user":"imsduser","dateUpdated":"2022-03-15T14:13:58+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>On va imputer les variables &ldquo;mortdue&rdquo;, &ldquo;value&rdquo;,&ldquo;derog&rdquo;,&ldquo;delinq&rdquo;,&ldquo;clage&rdquo;,&ldquo;ninq&rdquo;,&ldquo;debtinc&rdquo; par la médiane (car leur skweness est strictement différente de 0, donc leurs distributions sont asymétriques) et les variables &ldquo;yoj&rdquo;,&ldquo;clno&rdquo; par leur moyenne.</p>\n"}]},"apps":[],"jobName":"paragraph_1647297621119_1888649626","id":"20220314-234021_1474253370","dateCreated":"2022-03-14T23:40:21+0100","dateStarted":"2022-03-15T14:13:58+0100","dateFinished":"2022-03-15T14:13:58+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37635"},{"text":"%pyspark\ntrain = train.withColumn(\"derog\", train[\"derog\"].cast(FloatType()))\ntrain = train.withColumn(\"yoj\", train[\"yoj\"].cast(FloatType()))\ntrain = train.withColumn(\"delinq\", train[\"delinq\"].cast(FloatType()))\ntrain = train.withColumn(\"ninq\", train[\"ninq\"].cast(FloatType()))\ntrain = train.withColumn(\"clno\", train[\"clno\"].cast(FloatType()))\n\ntest = test.withColumn(\"derog\", test[\"derog\"].cast(FloatType()))\ntest = test.withColumn(\"yoj\", test[\"yoj\"].cast(FloatType()))\ntest = test.withColumn(\"delinq\", test[\"delinq\"].cast(FloatType()))\ntest = test.withColumn(\"ninq\", test[\"ninq\"].cast(FloatType()))\ntest = test.withColumn(\"clno\", test[\"clno\"].cast(FloatType()))\n","user":"imsduser","dateUpdated":"2022-03-15T23:14:53+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1647309545257_-1984550053","id":"20220315-025905_1134158439","dateCreated":"2022-03-15T02:59:05+0100","dateStarted":"2022-03-15T03:18:48+0100","dateFinished":"2022-03-15T03:19:06+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37636"},{"text":"%spark2.pyspark\n# train\nimputeCols = [\"mortdue\", \"value\",\"derog\",\"delinq\",\"clage\",\"ninq\",\"debtinc\"]\nimputer_tr = Imputer(strategy=\"median\", inputCols=imputeCols, outputCols=imputeCols)\nimputerModel_tr = imputer_tr.fit(train)\nimputed_df_tr = imputerModel_tr.transform(train)\n\nimputeCols2 = [\"yoj\",\"clno\"]\nimputer2_tr = Imputer(strategy=\"mean\", inputCols=imputeCols2, outputCols=imputeCols2)\nimputerModel2_tr = imputer2_tr.fit(imputed_df_tr)\nimputed_df_tr = imputerModel2_tr.transform(imputed_df_tr)\n\n\n# test\nimputeCols = [\"mortdue\", \"value\",\"derog\",\"delinq\",\"clage\",\"ninq\",\"debtinc\"]\nimputer_ts = Imputer(strategy=\"median\", inputCols=imputeCols, outputCols=imputeCols)\nimputerModel_ts = imputer_ts.fit(test)\nimputed_df_ts = imputerModel_ts.transform(test)\n\nimputeCols2 = [\"yoj\",\"clno\"]\nimputer2_ts = Imputer(strategy=\"mean\", inputCols=imputeCols2, outputCols=imputeCols2)\nimputerModel2_ts = imputer2_ts.fit(imputed_df_ts)\nimputed_df_ts = imputerModel2_ts.transform(imputed_df_ts)\n\n","user":"imsduser","dateUpdated":"2022-03-15T23:14:53+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":true},"editorMode":"ace/mode/python","editorHide":false,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1647291705478_-396833220","id":"20220314-220145_1059666735","dateCreated":"2022-03-14T22:01:45+0100","dateStarted":"2022-03-15T03:19:06+0100","dateFinished":"2022-03-15T03:19:18+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37637"},{"text":"%md\n\n<h3 style=\"font-family: Verdana\"><font color=\"#FF33F6\"><strong>3 - Imputation des variables catégorielles </strong></font></h3>","user":"imsduser","dateUpdated":"2022-03-15T23:47:45+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3 style=\"font-family: Verdana\"><font color=\"#FF33F6\"><strong>3 - Imputation des variables catégorielles </strong></font></h3>\n"}]},"apps":[],"jobName":"paragraph_1647297785145_214620841","id":"20220314-234305_1621518475","dateCreated":"2022-03-14T23:43:05+0100","dateStarted":"2022-03-15T23:47:27+0100","dateFinished":"2022-03-15T23:47:27+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37638"},{"text":"%spark2.pyspark\nprint(\"---- Train\")\nimputed_df_tr.select([(count(when(col(c).contains('NULL') | \\\n                            (col(c) == '' ) | \\\n                            col(c).isNull() | \\\n                            isnan(c), c \n                           ))/imputed_df_tr.count()*100).alias(c)\n                    for c in imputed_df_tr.columns]).show()\n                    \nprint(\"---- Test\")  \nimputed_df_ts.select([(count(when(col(c).contains('NULL') | \\\n                            (col(c) == '' ) | \\\n                            col(c).isNull() | \\\n                            isnan(c), c \n                           ))/imputed_df_ts.count()*100).alias(c)\n                    for c in imputed_df_ts.columns]).show()","user":"imsduser","dateUpdated":"2022-03-15T23:15:52+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1647310391155_1163904392","id":"20220315-031311_87522695","dateCreated":"2022-03-15T03:13:11+0100","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:37639"},{"text":"%md\nComme 'reason' et 'job' ont des pourcentages de valeurs manquantes inférieurs à 15%, on va les imputer par le mode.\n","user":"imsduser","dateUpdated":"2022-03-15T22:02:56+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Comme 'reason' et 'job' ont des pourcentages de valeurs manquantes inférieurs à 15%, on va les imputer par le mode.</p>\n"}]},"apps":[],"jobName":"paragraph_1647298010587_-557864650","id":"20220314-234650_1721234729","dateCreated":"2022-03-14T23:46:50+0100","dateStarted":"2022-03-15T22:02:49+0100","dateFinished":"2022-03-15T22:02:49+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37640"},{"text":"%pyspark\ntrain.show()\n","user":"imsduser","dateUpdated":"2022-03-15T03:20:47+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+-------+--------+--------+-------+-------+----+-----+------+----------+----+----+---------+\n|bad|   loan| mortdue|   value| reason|    job| yoj|derog|delinq|     clage|ninq|clno|  debtinc|\n+---+-------+--------+--------+-------+-------+----+-----+------+----------+----+----+---------+\n|  0| 7000.0| 46225.0| 59000.0|DebtCon|  Other|16.0|  0.0|   4.0| 219.13333| 0.0|37.0|     null|\n|  0| 8700.0| 54768.0| 87268.0|HomeImp|  Other|18.0|  0.0|   0.0| 187.58057| 0.0|28.0|26.367134|\n|  0|10200.0| 55539.0| 65357.0|DebtCon|    Mgr| 5.0|  0.0|   0.0| 190.94594| 1.0|17.0|28.640823|\n|  0|13000.0| 44875.0| 57713.0|DebtCon|  Other| 0.0|  1.0|   0.0| 184.99033| 1.0|12.0|28.602076|\n|  0|13200.0| 69697.0| 91722.0|HomeImp| Office|24.0|  1.0|   0.0| 183.52373| 1.0|14.0| 39.75217|\n|  0|14200.0| 46320.0| 62044.0|DebtCon|  Other| 6.0|  0.0|   0.0|106.983894| 2.0|49.0|29.057909|\n|  0|14300.0| 67018.0| 81805.0|DebtCon|  Other| 1.0|  0.0|   0.0| 253.59245| 3.0|25.0|30.686218|\n|  0|14800.0| 16448.0| 38774.0|DebtCon| Office| 7.0|  0.0|   0.0|  91.00554| 0.0|16.0| 19.24035|\n|  0|15300.0| 42100.0| 65000.0|DebtCon|  Other| 7.0|  0.0|   0.0| 95.333336| 3.0|15.0|     null|\n|  0|17600.0| 62996.0| 86817.0|HomeImp|ProfExe|12.0|  0.0|   1.0| 152.78265| 0.0|14.0|29.203655|\n|  0|18000.0| 56000.0| 78000.0|DebtCon|       | 4.0|  0.0|   0.0| 108.53333| 0.0|16.0|     null|\n|  0|18300.0| 93728.0|153093.0|HomeImp|ProfExe| 5.0|  0.0|   0.0|109.337105| 0.0|16.0| 36.21399|\n|  0|18600.0| 49385.0| 70220.0|DebtCon|ProfExe| 6.0|  0.0|   0.0| 229.47491| 2.0|32.0|30.731396|\n|  0|21200.0| 70400.0| 96999.0|HomeImp| Office|14.0|  0.0|   0.0| 135.26454| 0.0|13.0| 38.82317|\n|  0|21800.0|133812.0|166893.0|DebtCon|ProfExe| 6.0|  0.0|   0.0| 169.76715| 0.0|37.0|20.059526|\n|  0|22900.0|107241.0|138883.0|DebtCon|    Mgr| 9.0|  1.0|   0.0| 201.78575| 5.0|18.0| 41.14075|\n|  0|23300.0| 91957.0|135827.0|DebtCon|ProfExe|null|  0.0|   1.0| 203.07169| 0.0|20.0|27.833357|\n|  0|24300.0|123686.0|153184.0|DebtCon|    Mgr| 4.0|  0.0|   0.0| 298.28293| 0.0|25.0|36.336563|\n|  0|25500.0| 84267.0|117833.0|DebtCon|ProfExe|12.0|  0.0|   1.0| 123.75686| 0.0|18.0|27.471157|\n|  0|25600.0|196689.0|247025.0|DebtCon|  Other| 8.0|  0.0|   0.0|105.425354| 1.0|25.0|42.670277|\n+---+-------+--------+--------+-------+-------+----+-----+------+----------+----+----+---------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1647310833494_164911236","id":"20220315-032033_2114139387","dateCreated":"2022-03-15T03:20:33+0100","dateStarted":"2022-03-15T03:20:47+0100","dateFinished":"2022-03-15T03:20:47+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37641"},{"text":"%pyspark\ntest.show()","user":"imsduser","dateUpdated":"2022-03-15T03:21:10+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+-------+--------+--------+-------+------+----+-----+------+----------+----+----+---------+\n|bad|   loan| mortdue|   value| reason|   job| yoj|derog|delinq|     clage|ninq|clno|  debtinc|\n+---+-------+--------+--------+-------+------+----+-----+------+----------+----+----+---------+\n|  0|10000.0|    null| 56475.0|HomeImp| Other| 9.0|  2.0|   0.0|  309.2645| 2.0|12.0|34.487186|\n|  0|14600.0| 86199.0| 95034.0|HomeImp|Office|null|  0.0|   0.0| 164.29504| 1.0|25.0|   41.546|\n|  0|20900.0| 63038.0| 86870.0|DebtCon|      | 3.0|  0.0|   0.0| 113.69883| 0.0|16.0| 38.73252|\n|  0|25500.0|235839.0|267506.0|HomeImp|  Self| 5.0|  0.0|   0.0| 240.21701| 3.0|51.0|39.048428|\n|  1| 8000.0| 32100.0| 36739.0|HomeImp| Other| 4.0|  0.0|   0.0|  79.45885| 2.0| 8.0|31.276716|\n|  0| 6400.0| 51436.0| 91284.0|DebtCon|      | 4.0|  0.0|   0.0|  209.6429| 2.0|30.0|31.971972|\n|  0| 6900.0|    null| 57067.0|       |      |null| null|  null|      null|null|null|14.370986|\n|  0| 8500.0|    null| 42980.0|HomeImp| Other|null| null|   1.0|  76.01075| 0.0| 9.0|37.659668|\n|  0| 9500.0| 43210.0| 59692.0|HomeImp| Other| 1.0|  1.0|  null|103.089485|null|13.0|38.704987|\n|  0|12700.0| 27459.0| 38577.0|HomeImp|   Mgr|16.0|  0.0|   0.0| 72.329575| 0.0| 9.0|31.605665|\n|  0|16600.0| 95860.0|123546.0|DebtCon|Office| 0.0| null|   2.0| 252.75749| 1.0|29.0|40.608566|\n|  0|26400.0|122105.0|165000.0|DebtCon|   Mgr| 1.0|  0.0|   0.0|     234.4| 2.0|24.0|     null|\n|  1|24200.0| 10286.0|    null|DebtCon| Other|24.0|  0.0|   1.0| 216.13333| 4.0|32.0|     null|\n|  0| 9600.0| 77359.0|101365.0|HomeImp| Other| 1.0|  0.0|   0.0| 182.80351| 0.0|31.0| 33.48191|\n|  0|18200.0| 63852.0| 93356.0|DebtCon| Other| 1.0|  0.0|   0.0| 181.91177| 0.0|31.0|33.209408|\n|  0|18700.0| 59929.0| 89526.0|DebtCon|Office| 0.0|  0.0|   0.0|  64.45473| 0.0|22.0| 35.08735|\n|  1|13200.0| 65997.0| 88000.0|DebtCon| Other| 2.0|  0.0|   0.0| 113.23333| 2.0|25.0|     null|\n|  1|15500.0| 48100.0| 67000.0|DebtCon| Other|15.0| null|  null|      null|null|null|     null|\n|  0| 8700.0| 77930.0| 80164.0|HomeImp| Other|20.0|  0.0|   0.0|  350.5284| 1.0|47.0| 29.66236|\n|  0|12000.0| 94000.0|112125.0|HomeImp|Office| 2.0|  0.0|   0.0| 143.03334| 1.0|22.0|     null|\n+---+-------+--------+--------+-------+------+----+-----+------+----------+----+----+---------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1647310862961_1946714041","id":"20220315-032102_1991681525","dateCreated":"2022-03-15T03:21:02+0100","dateStarted":"2022-03-15T03:21:10+0100","dateFinished":"2022-03-15T03:21:11+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37642"},{"text":"%spark2.pyspark\n\nprint(\"---- Mode des variables catégorielles dans le Train\")\ndfc_tr = train.select(\"job\", \"reason\")\n[[i,dfc_tr.groupby(i).count().orderBy(\"count\", ascending=False).first()[0]] for i in dfc_tr.columns]\n","user":"imsduser","dateUpdated":"2022-03-15T03:22:29+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"---- Mode des variables catégorielles dans le Train\n[['job', u'Other'], ['reason', u'DebtCon']]\n"}]},"apps":[],"jobName":"paragraph_1647310437215_-54733293","id":"20220315-031357_459373359","dateCreated":"2022-03-15T03:13:57+0100","dateStarted":"2022-03-15T03:22:29+0100","dateFinished":"2022-03-15T03:22:35+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37643"},{"text":"%spark2.pyspark\nprint(\"---- Mode des variables catégorielles dans le Test\")\ndfc_ts = test.select(\"job\", \"reason\")\n[[i,dfc_ts.groupby(i).count().orderBy(\"count\", ascending=False).first()[0]] for i in dfc_ts.columns]","user":"imsduser","dateUpdated":"2022-03-15T03:22:33+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"---- Mode des variables catégorielles dans le Test\n[['job', u'Other'], ['reason', u'DebtCon']]\n"}]},"apps":[],"jobName":"paragraph_1647310914989_2144383030","id":"20220315-032154_1852879359","dateCreated":"2022-03-15T03:21:54+0100","dateStarted":"2022-03-15T03:22:33+0100","dateFinished":"2022-03-15T03:22:40+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37644"},{"text":"%spark2.pyspark\n\n# Imputation des variables catégorielles dans le train\nimputed_df_tr = imputed_df_tr.na.replace('', value='Other',subset=[\"job\"])\nimputed_df_tr = imputed_df_tr.na.replace('', value='DebtCon',subset=[\"reason\"])\n\n# Imputation des variables catégorielles dans le Test\nimputed_df_ts = imputed_df_ts.na.replace('', value='Other',subset=[\"job\"])\nimputed_df_ts = imputed_df_ts.na.replace('', value='DebtCon',subset=[\"reason\"])\n","user":"imsduser","dateUpdated":"2022-03-15T03:30:05+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1647298882090_-1667604192","id":"20220315-000122_23923269","dateCreated":"2022-03-15T00:01:22+0100","dateStarted":"2022-03-15T03:22:58+0100","dateFinished":"2022-03-15T03:22:58+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37645"},{"text":"%spark2.pyspark\nimputed_df_ts.show()","user":"imsduser","dateUpdated":"2022-03-15T03:27:46+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+-------+--------+--------+-------+------+--------+-----+------+----------+----+---------+---------+\n|bad|   loan| mortdue|   value| reason|   job|     yoj|derog|delinq|     clage|ninq|     clno|  debtinc|\n+---+-------+--------+--------+-------+------+--------+-----+------+----------+----+---------+---------+\n|  0|10000.0| 66095.0| 56475.0|HomeImp| Other|     9.0|  2.0|   0.0|  309.2645| 2.0|     12.0|34.487186|\n|  0|14600.0| 86199.0| 95034.0|HomeImp|Office|8.518315|  0.0|   0.0| 164.29504| 1.0|     25.0|   41.546|\n|  0|20900.0| 63038.0| 86870.0|DebtCon| Other|     3.0|  0.0|   0.0| 113.69883| 0.0|     16.0| 38.73252|\n|  0|25500.0|235839.0|267506.0|HomeImp|  Self|     5.0|  0.0|   0.0| 240.21701| 3.0|     51.0|39.048428|\n|  1| 8000.0| 32100.0| 36739.0|HomeImp| Other|     4.0|  0.0|   0.0|  79.45885| 2.0|      8.0|31.276716|\n|  0| 6400.0| 51436.0| 91284.0|DebtCon| Other|     4.0|  0.0|   0.0|  209.6429| 2.0|     30.0|31.971972|\n|  0| 6900.0| 66095.0| 57067.0|DebtCon| Other|8.518315|  0.0|   0.0| 166.12608| 1.0|21.553415|14.370986|\n|  0| 8500.0| 66095.0| 42980.0|HomeImp| Other|8.518315|  0.0|   1.0|  76.01075| 0.0|      9.0|37.659668|\n|  0| 9500.0| 43210.0| 59692.0|HomeImp| Other|     1.0|  1.0|   0.0|103.089485| 1.0|     13.0|38.704987|\n|  0|12700.0| 27459.0| 38577.0|HomeImp|   Mgr|    16.0|  0.0|   0.0| 72.329575| 0.0|      9.0|31.605665|\n|  0|16600.0| 95860.0|123546.0|DebtCon|Office|     0.0|  0.0|   2.0| 252.75749| 1.0|     29.0|40.608566|\n|  0|26400.0|122105.0|165000.0|DebtCon|   Mgr|     1.0|  0.0|   0.0|     234.4| 2.0|     24.0|34.698162|\n|  1|24200.0| 10286.0| 89082.0|DebtCon| Other|    24.0|  0.0|   1.0| 216.13333| 4.0|     32.0|34.698162|\n|  0| 9600.0| 77359.0|101365.0|HomeImp| Other|     1.0|  0.0|   0.0| 182.80351| 0.0|     31.0| 33.48191|\n|  0|18200.0| 63852.0| 93356.0|DebtCon| Other|     1.0|  0.0|   0.0| 181.91177| 0.0|     31.0|33.209408|\n|  0|18700.0| 59929.0| 89526.0|DebtCon|Office|     0.0|  0.0|   0.0|  64.45473| 0.0|     22.0| 35.08735|\n|  1|13200.0| 65997.0| 88000.0|DebtCon| Other|     2.0|  0.0|   0.0| 113.23333| 2.0|     25.0|34.698162|\n|  1|15500.0| 48100.0| 67000.0|DebtCon| Other|    15.0|  0.0|   0.0| 166.12608| 1.0|21.553415|34.698162|\n|  0| 8700.0| 77930.0| 80164.0|HomeImp| Other|    20.0|  0.0|   0.0|  350.5284| 1.0|     47.0| 29.66236|\n|  0|12000.0| 94000.0|112125.0|HomeImp|Office|     2.0|  0.0|   0.0| 143.03334| 1.0|     22.0|34.698162|\n+---+-------+--------+--------+-------+------+--------+-----+------+----------+----+---------+---------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1647311252263_1596776432","id":"20220315-032732_1162994315","dateCreated":"2022-03-15T03:27:32+0100","dateStarted":"2022-03-15T03:27:46+0100","dateFinished":"2022-03-15T03:27:46+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37646"},{"text":"%spark2.pyspark\nprint(\"---- Valeurs manquantes dans le Train\")\nimputed_df_tr.select([count(when(isnan(c), c)).alias(c) for c in imputed_df_tr.columns]).show()\nprint(\"---- Valeurs manquantes dans le  Test\")\nimputed_df_ts.select([count(when(isnan(c), c)).alias(c) for c in imputed_df_ts.columns]).show()","user":"imsduser","dateUpdated":"2022-03-15T23:15:52+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"---- Valeurs manquantes dans le Train\n+---+----+-------+-----+------+---+---+-----+------+-----+----+----+-------+\n|bad|loan|mortdue|value|reason|job|yoj|derog|delinq|clage|ninq|clno|debtinc|\n+---+----+-------+-----+------+---+---+-----+------+-----+----+----+-------+\n|  0|   0|      0|    0|     0|  0|  0|    0|     0|    0|   0|   0|      0|\n+---+----+-------+-----+------+---+---+-----+------+-----+----+----+-------+\n\n---- Valeurs manquantes dans le  Test\n+---+----+-------+-----+------+---+---+-----+------+-----+----+----+-------+\n|bad|loan|mortdue|value|reason|job|yoj|derog|delinq|clage|ninq|clno|debtinc|\n+---+----+-------+-----+------+---+---+-----+------+-----+----+----+-------+\n|  0|   0|      0|    0|     0|  0|  0|    0|     0|    0|   0|   0|      0|\n+---+----+-------+-----+------+---+---+-----+------+-----+----+----+-------+\n\n"}]},"apps":[],"jobName":"paragraph_1647311478511_-794146823","id":"20220315-033118_1891412942","dateCreated":"2022-03-15T03:31:18+0100","dateStarted":"2022-03-15T03:32:22+0100","dateFinished":"2022-03-15T03:32:27+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37647"},{"text":"%md\n\n<h3 style=\"font-family: Verdana\"><font color=\"#FF33F6\"><strong>4 - Corrélation entre les variables </strong></font></h3>","user":"imsduser","dateUpdated":"2022-03-15T23:48:52+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3 style=\"font-family: Verdana\"><font color=\"#FF33F6\"><strong>4 - Corrélation entre les variables </strong></font></h3>\n"}]},"apps":[],"jobName":"paragraph_1647370161406_-1719242761","id":"20220315-194921_1087183447","dateCreated":"2022-03-15T19:49:21+0100","dateStarted":"2022-03-15T23:48:24+0100","dateFinished":"2022-03-15T23:48:24+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37648"},{"text":"%spark2.pyspark\ncolonnes = ['loan', 'mortdue', 'value', 'yoj', 'derog',\n       'delinq', 'clage', 'ninq', 'clno', 'debtinc']\n\nvector_col = \"Corrélation_des_variables\"\n\nassembler = VectorAssembler(inputCols=colonnes, outputCol=vector_col)\ndf_vector = assembler.transform(imputed_df_tr).select(vector_col)","user":"imsduser","dateUpdated":"2022-03-15T23:15:53+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":true},"editorMode":"ace/mode/python","editorHide":false,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1647370175366_-1001454555","id":"20220315-194935_1048645651","dateCreated":"2022-03-15T19:49:35+0100","dateStarted":"2022-03-15T19:52:22+0100","dateFinished":"2022-03-15T19:52:22+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37649"},{"text":"%spark2.pyspark\n# Matrice des corrélations\nmatrix = Correlation.corr(df_vector, vector_col).collect()[0][0]","user":"imsduser","dateUpdated":"2022-03-15T23:15:53+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1647370268446_-2074195786","id":"20220315-195108_358908498","dateCreated":"2022-03-15T19:51:08+0100","dateStarted":"2022-03-15T19:52:28+0100","dateFinished":"2022-03-15T19:52:32+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37650"},{"text":"%spark2.pyspark\n\nrows = matrix.toArray().tolist()\ncorrelation = spark.createDataFrame(rows, ['loan', 'mortdue', 'value', 'yoj', 'derog',\n       'delinq', 'clage', 'ninq', 'clno', 'debtinc'])\n       \nz.show(correlation)","user":"imsduser","dateUpdated":"2022-03-15T22:51:24+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"loan\tmortdue\tvalue\tyoj\tderog\tdelinq\tclage\tninq\tclno\tdebtinc\n1.0\t0.2246057868626062\t0.33761212564557663\t0.1019108426009406\t9.923810094370662E-4\t-0.02220160934386462\t0.09053030737715145\t0.042341872016669266\t0.06953616829038527\t0.07308005148831336\n0.2246057868626062\t1.0\t0.778042414427467\t-0.07845147697159119\t-0.044752171410673294\t0.006451873338522865\t0.13610623757629334\t0.03188558007021949\t0.3191955803841707\t0.13612577229654277\n0.33761212564557663\t0.778042414427467\t1.0\t0.01811037544947938\t-0.03866169245817585\t-0.004882034013937736\t0.17305590372335777\t-0.006057680006041085\t0.25584064192612754\t0.11453534441965288\n0.1019108426009406\t-0.07845147697159119\t0.01811037544947938\t1.0\t-0.062255068383227134\t0.03055678224847057\t0.19362242480714265\t-0.07656532542695502\t0.023669392096177216\t-0.05369706425393916\n9.923810094370662E-4\t-0.044752171410673294\t-0.03866169245817585\t-0.062255068383227134\t1.0\t0.16338976652633228\t-0.08809375761009625\t0.15437783840327712\t0.0487603022674115\t0.019862286940024027\n-0.02220160934386462\t0.006451873338522865\t-0.004882034013937736\t0.03055678224847057\t0.16338976652633228\t1.0\t0.022339005451327533\t0.057384825830518245\t0.16530439644132158\t0.061655170402759044\n0.09053030737715145\t0.13610623757629334\t0.17305590372335777\t0.19362242480714265\t-0.08809375761009625\t0.022339005451327533\t1.0\t-0.11842730191022197\t0.226903697731506\t-0.03721502470447482\n0.042341872016669266\t0.03188558007021949\t-0.006057680006041085\t-0.07656532542695502\t0.15437783840327712\t0.057384825830518245\t-0.11842730191022197\t1.0\t0.07771803141283103\t0.13282543833291274\n0.06953616829038527\t0.3191955803841707\t0.25584064192612754\t0.023669392096177216\t0.0487603022674115\t0.16530439644132158\t0.226903697731506\t0.07771803141283103\t1.0\t0.15321944793348802\n0.07308005148831336\t0.13612577229654277\t0.11453534441965288\t-0.05369706425393916\t0.019862286940024027\t0.061655170402759044\t-0.03721502470447482\t0.13282543833291274\t0.15321944793348802\t1.0\n"}]},"apps":[],"jobName":"paragraph_1647370298346_2111933544","id":"20220315-195138_545984877","dateCreated":"2022-03-15T19:51:38+0100","dateStarted":"2022-03-15T19:52:34+0100","dateFinished":"2022-03-15T19:52:35+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37651"},{"text":"%md\nLe corrélogramme ci-dessus nous montre qu’il y a une corrélation entre MORTDUE et VALUE ce qui est logique étant donné que la première variable dénote le montant dû sur l’hypothèque existante et VALUE la valeur actuelle de ce même bien. En revanche, les autres variables sont très faiblement corrélées ce qui est un bon indicateur pour avoir des coefficients de régression significatifs en absence de corrélations entre les variables explicatives.\n","user":"imsduser","dateUpdated":"2022-03-15T19:53:46+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Le corrélogramme ci-dessus nous montre qu’il y a une corrélation entre MORTDUE et VALUE ce qui est logique étant donné que la première variable dénote le montant dû sur l’hypothèque existante et VALUE la valeur actuelle de ce même bien. En revanche, les autres variables sont très faiblement corrélées ce qui est un bon indicateur pour avoir des coefficients de régression significatifs en absence de corrélations entre les variables explicatives.</p>\n"}]},"apps":[],"jobName":"paragraph_1647370409046_-1031744094","id":"20220315-195329_1069533250","dateCreated":"2022-03-15T19:53:29+0100","dateStarted":"2022-03-15T19:53:37+0100","dateFinished":"2022-03-15T19:53:37+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37652"},{"text":"%md\n<h2 style=\"font-family: Verdana\"><font color=\"#7133FF\"><strong> IV -  Sélection du modèle et validation </strong></font></h2>\n","user":"imsduser","dateUpdated":"2022-03-15T22:58:56+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2 style=\"font-family: Verdana\"><font color=\"#7133FF\"><strong> IV -  Sélection du modèle et validation </strong></font></h2>\n"}]},"apps":[],"jobName":"paragraph_1646604013666_-420234615","id":"20220306-230013_73369108","dateCreated":"2022-03-06T23:00:13+0100","dateStarted":"2022-03-15T22:58:46+0100","dateFinished":"2022-03-15T22:58:46+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37653"},{"text":"%pyspark\ndff.printSchema()","user":"imsduser","dateUpdated":"2022-03-15T00:51:26+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- bad: string (nullable = true)\n |-- loan: float (nullable = true)\n |-- mortdue: float (nullable = true)\n |-- value: float (nullable = true)\n |-- reason: string (nullable = true)\n |-- job: string (nullable = true)\n |-- yoj: float (nullable = true)\n |-- derog: float (nullable = true)\n |-- delinq: float (nullable = true)\n |-- clage: float (nullable = true)\n |-- ninq: float (nullable = true)\n |-- clno: float (nullable = true)\n |-- debtinc: float (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1646659950826_1249846227","id":"20220307-143230_817773794","dateCreated":"2022-03-07T14:32:30+0100","dateStarted":"2022-03-15T00:51:26+0100","dateFinished":"2022-03-15T00:51:26+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37654"},{"text":"%pyspark\ntrain_tr = imputed_df_tr\ntest_tr = imputed_df_ts\ncategoricalCols = [item[0] for item in train.dtypes if item[1].startswith('string')]\nintCols         = [item[0] for item in train.dtypes if item[1].startswith('int')]\ncontinuousCols  = [item[0] for item in train.dtypes if item[1].startswith('float')]\nnumsCols        = intCols + continuousCols\nprint(\"numsCols : \", numsCols)\nprint(\"categoricalCols : \", categoricalCols)","user":"imsduser","dateUpdated":"2022-03-15T03:39:37+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"('numsCols : ', ['loan', 'mortdue', 'value', 'yoj', 'derog', 'delinq', 'clage', 'ninq', 'clno', 'debtinc'])\n('categoricalCols : ', ['bad', 'reason', 'job'])\n"}]},"apps":[],"jobName":"paragraph_1646661286788_-1996376598","id":"20220307-145446_555393300","dateCreated":"2022-03-07T14:54:46+0100","dateStarted":"2022-03-15T03:39:37+0100","dateFinished":"2022-03-15T03:39:38+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37655"},{"text":"%md\n<h4 style=\"font-family: Verdana\"><font color=\"#D30543\"><strong> OneHotEncoding </strong></font></h4>\n\nCertains algorithmes peuvent travailler directement avec des données catégorielles. Par exemple, un arbre de décision peut apprendre directement à partir de données catégorielles sans qu'aucune transformation des données ne soit nécessaire (cela dépend de l'implémentation spécifique). De nombreux algorithmes d'apprentissage automatique ne peuvent pas fonctionner directement sur des données d'étiquettes. Ils exigent que toutes les variables d'entrée et de sortie soient numériques.\nEn général, il s'agit davantage d'une contrainte liée à la mise en œuvre efficace des algorithmes d'apprentissage automatique que de limitations strictes des algorithmes eux-mêmes.\n\nCela signifie que les données catégorielles doivent être converties en une forme numérique. Si la variable catégorielle est une variable de sortie, vous pouvez également souhaiter reconvertir les prédictions du modèle sous une forme catégorielle afin de les présenter ou de les utiliser dans une application quelconque. Pour les variables catégorielles où une telle relation ordinale n'existe pas, l'encodage des nombres entiers n'est pas suffisant. En fait, l'utilisation de cet encodage et le fait de laisser le modèle supposer un ordre naturel entre les catégories peut entraîner des performances médiocres ou des résultats inattendus (prédictions à mi-chemin entre les catégories). Dans ce cas, un encodage en un coup peut être appliqué à la représentation entière. Dans ce cas, la variable codée en entier est supprimée et une nouvelle variable binaire est ajoutée pour chaque valeur entière unique.\n","user":"imsduser","dateUpdated":"2022-03-16T16:46:13+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h4 style=\"font-family: Verdana\"><font color=\"#D30543\"><strong> OneHotEncoding </strong></font></h4>\n<p>Certains algorithmes peuvent travailler directement avec des données catégorielles. Par exemple, un arbre de décision peut apprendre directement à partir de données catégorielles sans qu'aucune transformation des données ne soit nécessaire (cela dépend de l'implémentation spécifique). De nombreux algorithmes d'apprentissage automatique ne peuvent pas fonctionner directement sur des données d'étiquettes. Ils exigent que toutes les variables d'entrée et de sortie soient numériques.\n<br  />En général, il s'agit davantage d'une contrainte liée à la mise en œuvre efficace des algorithmes d'apprentissage automatique que de limitations strictes des algorithmes eux-mêmes.</p>\n<p>Cela signifie que les données catégorielles doivent être converties en une forme numérique. Si la variable catégorielle est une variable de sortie, vous pouvez également souhaiter reconvertir les prédictions du modèle sous une forme catégorielle afin de les présenter ou de les utiliser dans une application quelconque. Pour les variables catégorielles où une telle relation ordinale n'existe pas, l'encodage des nombres entiers n'est pas suffisant. En fait, l'utilisation de cet encodage et le fait de laisser le modèle supposer un ordre naturel entre les catégories peut entraîner des performances médiocres ou des résultats inattendus (prédictions à mi-chemin entre les catégories). Dans ce cas, un encodage en un coup peut être appliqué à la représentation entière. Dans ce cas, la variable codée en entier est supprimée et une nouvelle variable binaire est ajoutée pour chaque valeur entière unique.</p>\n"}]},"apps":[],"jobName":"paragraph_1646694759584_1867476234","id":"20220308-001239_525257454","dateCreated":"2022-03-08T00:12:39+0100","dateStarted":"2022-03-16T16:46:13+0100","dateFinished":"2022-03-16T16:46:13+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37656"},{"text":"%pyspark\nimputed_df_tr.show()\n","user":"imsduser","dateUpdated":"2022-03-15T03:40:36+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+-------+--------+--------+-------+-------+-------+-----+------+----------+----+----+---------+\n|bad|   loan| mortdue|   value| reason|    job|    yoj|derog|delinq|     clage|ninq|clno|  debtinc|\n+---+-------+--------+--------+-------+-------+-------+-----+------+----------+----+----+---------+\n|  0| 7000.0| 46225.0| 59000.0|DebtCon|  Other|   16.0|  0.0|   4.0| 219.13333| 0.0|37.0|34.863598|\n|  0| 8700.0| 54768.0| 87268.0|HomeImp|  Other|   18.0|  0.0|   0.0| 187.58057| 0.0|28.0|26.367134|\n|  0|10200.0| 55539.0| 65357.0|DebtCon|    Mgr|    5.0|  0.0|   0.0| 190.94594| 1.0|17.0|28.640823|\n|  0|13000.0| 44875.0| 57713.0|DebtCon|  Other|    0.0|  1.0|   0.0| 184.99033| 1.0|12.0|28.602076|\n|  0|13200.0| 69697.0| 91722.0|HomeImp| Office|   24.0|  1.0|   0.0| 183.52373| 1.0|14.0| 39.75217|\n|  0|14200.0| 46320.0| 62044.0|DebtCon|  Other|    6.0|  0.0|   0.0|106.983894| 2.0|49.0|29.057909|\n|  0|14300.0| 67018.0| 81805.0|DebtCon|  Other|    1.0|  0.0|   0.0| 253.59245| 3.0|25.0|30.686218|\n|  0|14800.0| 16448.0| 38774.0|DebtCon| Office|    7.0|  0.0|   0.0|  91.00554| 0.0|16.0| 19.24035|\n|  0|15300.0| 42100.0| 65000.0|DebtCon|  Other|    7.0|  0.0|   0.0| 95.333336| 3.0|15.0|34.863598|\n|  0|17600.0| 62996.0| 86817.0|HomeImp|ProfExe|   12.0|  0.0|   1.0| 152.78265| 0.0|14.0|29.203655|\n|  0|18000.0| 56000.0| 78000.0|DebtCon|  Other|    4.0|  0.0|   0.0| 108.53333| 0.0|16.0|34.863598|\n|  0|18300.0| 93728.0|153093.0|HomeImp|ProfExe|    5.0|  0.0|   0.0|109.337105| 0.0|16.0| 36.21399|\n|  0|18600.0| 49385.0| 70220.0|DebtCon|ProfExe|    6.0|  0.0|   0.0| 229.47491| 2.0|32.0|30.731396|\n|  0|21200.0| 70400.0| 96999.0|HomeImp| Office|   14.0|  0.0|   0.0| 135.26454| 0.0|13.0| 38.82317|\n|  0|21800.0|133812.0|166893.0|DebtCon|ProfExe|    6.0|  0.0|   0.0| 169.76715| 0.0|37.0|20.059526|\n|  0|22900.0|107241.0|138883.0|DebtCon|    Mgr|    9.0|  1.0|   0.0| 201.78575| 5.0|18.0| 41.14075|\n|  0|23300.0| 91957.0|135827.0|DebtCon|ProfExe|9.00023|  0.0|   1.0| 203.07169| 0.0|20.0|27.833357|\n|  0|24300.0|123686.0|153184.0|DebtCon|    Mgr|    4.0|  0.0|   0.0| 298.28293| 0.0|25.0|36.336563|\n|  0|25500.0| 84267.0|117833.0|DebtCon|ProfExe|   12.0|  0.0|   1.0| 123.75686| 0.0|18.0|27.471157|\n|  0|25600.0|196689.0|247025.0|DebtCon|  Other|    8.0|  0.0|   0.0|105.425354| 1.0|25.0|42.670277|\n+---+-------+--------+--------+-------+-------+-------+-----+------+----------+----+----+---------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1647312007145_-1560403523","id":"20220315-034007_1465228281","dateCreated":"2022-03-15T03:40:07+0100","dateStarted":"2022-03-15T03:40:36+0100","dateFinished":"2022-03-15T03:40:37+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37657"},{"text":"%pyspark\ncategoricalColumns =  [ 'reason','job']\n#categoricalColumnsclassVec = [c + \"classVec\" for c in categoricalColumns]\ntrain = imputed_df_tr\ntest = imputed_df_ts\n\n# train\nfor categoricalColumn in categoricalColumns:\n  stringIndexer = StringIndexer(inputCol=categoricalColumn, outputCol = categoricalColumn+\"Index\").setHandleInvalid(\"skip\")\n  train = stringIndexer.fit(train).transform(train)\n  encoder_tr = OneHotEncoder(inputCol=categoricalColumn+\"Index\", outputCol=categoricalColumn+\"classVec\")\n  train = encoder_tr.transform(train)\n\ntrain.show()\n\n# test\nfor categoricalColumn in categoricalColumns:\n  stringIndexer = StringIndexer(inputCol=categoricalColumn, outputCol = categoricalColumn+\"Index\").setHandleInvalid(\"skip\")\n  test = stringIndexer.fit(test).transform(test)\n  encoder_ts = OneHotEncoder(inputCol=categoricalColumn+\"Index\", outputCol=categoricalColumn+\"classVec\")\n  test = encoder_ts.transform(test)\n","user":"imsduser","dateUpdated":"2022-03-15T23:15:54+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+-------+--------+--------+-------+-------+-------+-----+------+----------+----+----+---------+-----------+--------------+--------+-------------+\n|bad|   loan| mortdue|   value| reason|    job|    yoj|derog|delinq|     clage|ninq|clno|  debtinc|reasonIndex|reasonclassVec|jobIndex|  jobclassVec|\n+---+-------+--------+--------+-------+-------+-------+-----+------+----------+----+----+---------+-----------+--------------+--------+-------------+\n|  0| 7000.0| 46225.0| 59000.0|DebtCon|  Other|   16.0|  0.0|   4.0| 219.13333| 0.0|37.0|34.863598|        0.0| (1,[0],[1.0])|     0.0|(5,[0],[1.0])|\n|  0| 8700.0| 54768.0| 87268.0|HomeImp|  Other|   18.0|  0.0|   0.0| 187.58057| 0.0|28.0|26.367134|        1.0|     (1,[],[])|     0.0|(5,[0],[1.0])|\n|  0|10200.0| 55539.0| 65357.0|DebtCon|    Mgr|    5.0|  0.0|   0.0| 190.94594| 1.0|17.0|28.640823|        0.0| (1,[0],[1.0])|     3.0|(5,[3],[1.0])|\n|  0|13000.0| 44875.0| 57713.0|DebtCon|  Other|    0.0|  1.0|   0.0| 184.99033| 1.0|12.0|28.602076|        0.0| (1,[0],[1.0])|     0.0|(5,[0],[1.0])|\n|  0|13200.0| 69697.0| 91722.0|HomeImp| Office|   24.0|  1.0|   0.0| 183.52373| 1.0|14.0| 39.75217|        1.0|     (1,[],[])|     2.0|(5,[2],[1.0])|\n|  0|14200.0| 46320.0| 62044.0|DebtCon|  Other|    6.0|  0.0|   0.0|106.983894| 2.0|49.0|29.057909|        0.0| (1,[0],[1.0])|     0.0|(5,[0],[1.0])|\n|  0|14300.0| 67018.0| 81805.0|DebtCon|  Other|    1.0|  0.0|   0.0| 253.59245| 3.0|25.0|30.686218|        0.0| (1,[0],[1.0])|     0.0|(5,[0],[1.0])|\n|  0|14800.0| 16448.0| 38774.0|DebtCon| Office|    7.0|  0.0|   0.0|  91.00554| 0.0|16.0| 19.24035|        0.0| (1,[0],[1.0])|     2.0|(5,[2],[1.0])|\n|  0|15300.0| 42100.0| 65000.0|DebtCon|  Other|    7.0|  0.0|   0.0| 95.333336| 3.0|15.0|34.863598|        0.0| (1,[0],[1.0])|     0.0|(5,[0],[1.0])|\n|  0|17600.0| 62996.0| 86817.0|HomeImp|ProfExe|   12.0|  0.0|   1.0| 152.78265| 0.0|14.0|29.203655|        1.0|     (1,[],[])|     1.0|(5,[1],[1.0])|\n|  0|18000.0| 56000.0| 78000.0|DebtCon|  Other|    4.0|  0.0|   0.0| 108.53333| 0.0|16.0|34.863598|        0.0| (1,[0],[1.0])|     0.0|(5,[0],[1.0])|\n|  0|18300.0| 93728.0|153093.0|HomeImp|ProfExe|    5.0|  0.0|   0.0|109.337105| 0.0|16.0| 36.21399|        1.0|     (1,[],[])|     1.0|(5,[1],[1.0])|\n|  0|18600.0| 49385.0| 70220.0|DebtCon|ProfExe|    6.0|  0.0|   0.0| 229.47491| 2.0|32.0|30.731396|        0.0| (1,[0],[1.0])|     1.0|(5,[1],[1.0])|\n|  0|21200.0| 70400.0| 96999.0|HomeImp| Office|   14.0|  0.0|   0.0| 135.26454| 0.0|13.0| 38.82317|        1.0|     (1,[],[])|     2.0|(5,[2],[1.0])|\n|  0|21800.0|133812.0|166893.0|DebtCon|ProfExe|    6.0|  0.0|   0.0| 169.76715| 0.0|37.0|20.059526|        0.0| (1,[0],[1.0])|     1.0|(5,[1],[1.0])|\n|  0|22900.0|107241.0|138883.0|DebtCon|    Mgr|    9.0|  1.0|   0.0| 201.78575| 5.0|18.0| 41.14075|        0.0| (1,[0],[1.0])|     3.0|(5,[3],[1.0])|\n|  0|23300.0| 91957.0|135827.0|DebtCon|ProfExe|9.00023|  0.0|   1.0| 203.07169| 0.0|20.0|27.833357|        0.0| (1,[0],[1.0])|     1.0|(5,[1],[1.0])|\n|  0|24300.0|123686.0|153184.0|DebtCon|    Mgr|    4.0|  0.0|   0.0| 298.28293| 0.0|25.0|36.336563|        0.0| (1,[0],[1.0])|     3.0|(5,[3],[1.0])|\n|  0|25500.0| 84267.0|117833.0|DebtCon|ProfExe|   12.0|  0.0|   1.0| 123.75686| 0.0|18.0|27.471157|        0.0| (1,[0],[1.0])|     1.0|(5,[1],[1.0])|\n|  0|25600.0|196689.0|247025.0|DebtCon|  Other|    8.0|  0.0|   0.0|105.425354| 1.0|25.0|42.670277|        0.0| (1,[0],[1.0])|     0.0|(5,[0],[1.0])|\n+---+-------+--------+--------+-------+-------+-------+-----+------+----------+----+----+---------+-----------+--------------+--------+-------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1646694934577_1130341670","id":"20220308-001534_988471352","dateCreated":"2022-03-08T00:15:34+0100","dateStarted":"2022-03-15T03:42:25+0100","dateFinished":"2022-03-15T03:42:35+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37658"},{"text":"%pyspark\n# Convertir les labels en index à l'aide de StringIndexer\nlabel = \"bad\"\nlabel_stringIndexer = StringIndexer(inputCol = label, outputCol = \"label\").setHandleInvalid(\"skip\")\ntrain = label_stringIndexer.fit(train).transform(train)\ntest = label_stringIndexer.fit(test).transform(test)\ntrain.show()","user":"imsduser","dateUpdated":"2022-03-15T03:43:25+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python","editorHide":false,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+-------+--------+--------+-------+-------+-------+-----+------+----------+----+----+---------+-----------+--------------+--------+-------------+-----+\n|bad|   loan| mortdue|   value| reason|    job|    yoj|derog|delinq|     clage|ninq|clno|  debtinc|reasonIndex|reasonclassVec|jobIndex|  jobclassVec|label|\n+---+-------+--------+--------+-------+-------+-------+-----+------+----------+----+----+---------+-----------+--------------+--------+-------------+-----+\n|  0| 7000.0| 46225.0| 59000.0|DebtCon|  Other|   16.0|  0.0|   4.0| 219.13333| 0.0|37.0|34.863598|        0.0| (1,[0],[1.0])|     0.0|(5,[0],[1.0])|  0.0|\n|  0| 8700.0| 54768.0| 87268.0|HomeImp|  Other|   18.0|  0.0|   0.0| 187.58057| 0.0|28.0|26.367134|        1.0|     (1,[],[])|     0.0|(5,[0],[1.0])|  0.0|\n|  0|10200.0| 55539.0| 65357.0|DebtCon|    Mgr|    5.0|  0.0|   0.0| 190.94594| 1.0|17.0|28.640823|        0.0| (1,[0],[1.0])|     3.0|(5,[3],[1.0])|  0.0|\n|  0|13000.0| 44875.0| 57713.0|DebtCon|  Other|    0.0|  1.0|   0.0| 184.99033| 1.0|12.0|28.602076|        0.0| (1,[0],[1.0])|     0.0|(5,[0],[1.0])|  0.0|\n|  0|13200.0| 69697.0| 91722.0|HomeImp| Office|   24.0|  1.0|   0.0| 183.52373| 1.0|14.0| 39.75217|        1.0|     (1,[],[])|     2.0|(5,[2],[1.0])|  0.0|\n|  0|14200.0| 46320.0| 62044.0|DebtCon|  Other|    6.0|  0.0|   0.0|106.983894| 2.0|49.0|29.057909|        0.0| (1,[0],[1.0])|     0.0|(5,[0],[1.0])|  0.0|\n|  0|14300.0| 67018.0| 81805.0|DebtCon|  Other|    1.0|  0.0|   0.0| 253.59245| 3.0|25.0|30.686218|        0.0| (1,[0],[1.0])|     0.0|(5,[0],[1.0])|  0.0|\n|  0|14800.0| 16448.0| 38774.0|DebtCon| Office|    7.0|  0.0|   0.0|  91.00554| 0.0|16.0| 19.24035|        0.0| (1,[0],[1.0])|     2.0|(5,[2],[1.0])|  0.0|\n|  0|15300.0| 42100.0| 65000.0|DebtCon|  Other|    7.0|  0.0|   0.0| 95.333336| 3.0|15.0|34.863598|        0.0| (1,[0],[1.0])|     0.0|(5,[0],[1.0])|  0.0|\n|  0|17600.0| 62996.0| 86817.0|HomeImp|ProfExe|   12.0|  0.0|   1.0| 152.78265| 0.0|14.0|29.203655|        1.0|     (1,[],[])|     1.0|(5,[1],[1.0])|  0.0|\n|  0|18000.0| 56000.0| 78000.0|DebtCon|  Other|    4.0|  0.0|   0.0| 108.53333| 0.0|16.0|34.863598|        0.0| (1,[0],[1.0])|     0.0|(5,[0],[1.0])|  0.0|\n|  0|18300.0| 93728.0|153093.0|HomeImp|ProfExe|    5.0|  0.0|   0.0|109.337105| 0.0|16.0| 36.21399|        1.0|     (1,[],[])|     1.0|(5,[1],[1.0])|  0.0|\n|  0|18600.0| 49385.0| 70220.0|DebtCon|ProfExe|    6.0|  0.0|   0.0| 229.47491| 2.0|32.0|30.731396|        0.0| (1,[0],[1.0])|     1.0|(5,[1],[1.0])|  0.0|\n|  0|21200.0| 70400.0| 96999.0|HomeImp| Office|   14.0|  0.0|   0.0| 135.26454| 0.0|13.0| 38.82317|        1.0|     (1,[],[])|     2.0|(5,[2],[1.0])|  0.0|\n|  0|21800.0|133812.0|166893.0|DebtCon|ProfExe|    6.0|  0.0|   0.0| 169.76715| 0.0|37.0|20.059526|        0.0| (1,[0],[1.0])|     1.0|(5,[1],[1.0])|  0.0|\n|  0|22900.0|107241.0|138883.0|DebtCon|    Mgr|    9.0|  1.0|   0.0| 201.78575| 5.0|18.0| 41.14075|        0.0| (1,[0],[1.0])|     3.0|(5,[3],[1.0])|  0.0|\n|  0|23300.0| 91957.0|135827.0|DebtCon|ProfExe|9.00023|  0.0|   1.0| 203.07169| 0.0|20.0|27.833357|        0.0| (1,[0],[1.0])|     1.0|(5,[1],[1.0])|  0.0|\n|  0|24300.0|123686.0|153184.0|DebtCon|    Mgr|    4.0|  0.0|   0.0| 298.28293| 0.0|25.0|36.336563|        0.0| (1,[0],[1.0])|     3.0|(5,[3],[1.0])|  0.0|\n|  0|25500.0| 84267.0|117833.0|DebtCon|ProfExe|   12.0|  0.0|   1.0| 123.75686| 0.0|18.0|27.471157|        0.0| (1,[0],[1.0])|     1.0|(5,[1],[1.0])|  0.0|\n|  0|25600.0|196689.0|247025.0|DebtCon|  Other|    8.0|  0.0|   0.0|105.425354| 1.0|25.0|42.670277|        0.0| (1,[0],[1.0])|     0.0|(5,[0],[1.0])|  0.0|\n+---+-------+--------+--------+-------+-------+-------+-----+------+----------+----+----+---------+-----------+--------------+--------+-------------+-----+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1646663104107_-1888273668","id":"20220307-152504_1013864134","dateCreated":"2022-03-07T15:25:04+0100","dateStarted":"2022-03-15T03:43:25+0100","dateFinished":"2022-03-15T03:43:30+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37659"},{"text":"%pyspark\ncategoricalColumnclassvec = ['reasonclassVec', 'jobclassVec']\nassemblerInputs = categoricalColumnclassvec + numsCols\nprint(assemblerInputs)\nassembler = VectorAssembler(inputCols = assemblerInputs, outputCol=\"features\")\ntrain = assembler.transform(train)\ntest = assembler.transform(test)","user":"imsduser","dateUpdated":"2022-03-15T03:44:23+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"['reasonclassVec', 'jobclassVec', 'loan', 'mortdue', 'value', 'yoj', 'derog', 'delinq', 'clage', 'ninq', 'clno', 'debtinc']\n"}]},"apps":[],"jobName":"paragraph_1646695223982_2005090458","id":"20220308-002023_806723205","dateCreated":"2022-03-08T00:20:23+0100","dateStarted":"2022-03-15T03:44:24+0100","dateFinished":"2022-03-15T03:44:24+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37660"},{"text":"%pyspark\n\n# Colonnes pertinentes\nselectedcols = [\"label\", \"features\"]\ntrain = train.select(selectedcols)\ntest = test.select(selectedcols)\n\ntrain.show()\n","user":"imsduser","dateUpdated":"2022-03-15T03:45:25+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----+--------------------+\n|label|            features|\n+-----+--------------------+\n|  0.0|[1.0,1.0,0.0,0.0,...|\n|  0.0|(16,[1,6,7,8,9,12...|\n|  0.0|[1.0,0.0,0.0,0.0,...|\n|  0.0|[1.0,1.0,0.0,0.0,...|\n|  0.0|[0.0,0.0,0.0,1.0,...|\n|  0.0|[1.0,1.0,0.0,0.0,...|\n|  0.0|[1.0,1.0,0.0,0.0,...|\n|  0.0|(16,[0,3,6,7,8,9,...|\n|  0.0|[1.0,1.0,0.0,0.0,...|\n|  0.0|(16,[2,6,7,8,9,11...|\n|  0.0|(16,[0,1,6,7,8,9,...|\n|  0.0|(16,[2,6,7,8,9,12...|\n|  0.0|[1.0,0.0,1.0,0.0,...|\n|  0.0|(16,[3,6,7,8,9,12...|\n|  0.0|(16,[0,2,6,7,8,9,...|\n|  0.0|[1.0,0.0,0.0,0.0,...|\n|  0.0|[1.0,0.0,1.0,0.0,...|\n|  0.0|(16,[0,4,6,7,8,9,...|\n|  0.0|[1.0,0.0,1.0,0.0,...|\n|  0.0|[1.0,1.0,0.0,0.0,...|\n+-----+--------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1646688807015_1865062713","id":"20220307-223327_411503241","dateCreated":"2022-03-07T22:33:27+0100","dateStarted":"2022-03-15T03:45:25+0100","dateFinished":"2022-03-15T03:45:26+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37661"},{"text":"%md\n<h4 style=\"font-family: Verdana\"><font color=\"#D30543\"><strong>  Normalisation </strong></font></h4>\nLa normalisation standardise la moyenne et l'écart-type de tout type de distribution de données, ce qui permet de simplifier le problème d'apprentissage en s'affranchissant de ces deux paramètres. La normalisation standard, également appelée standardisation ou normalisation z-score, consiste à soustraire la moyenne et à la diviser par l'écart type. Dans ce cas, chaque valeur refléterait la distance par rapport à la moyenne en unités d'écart-type. L'échelle standard est utilisée pour redimensionner la distribution des valeurs de sorte que la moyenne des valeurs observées soit égale à 0, et que l'écart type soit égal à 1.","user":"imsduser","dateUpdated":"2022-03-15T23:50:43+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h4 style=\"font-family: Verdana\"><font color=\"#D30543\"><strong>  Normalisation </strong></font></h4>\n<p>La normalisation standardise la moyenne et l'écart-type de tout type de distribution de données, ce qui permet de simplifier le problème d'apprentissage en s'affranchissant de ces deux paramètres. La normalisation standard, également appelée standardisation ou normalisation z-score, consiste à soustraire la moyenne et à la diviser par l'écart type. Dans ce cas, chaque valeur refléterait la distance par rapport à la moyenne en unités d'écart-type. L'échelle standard est utilisée pour redimensionner la distribution des valeurs de sorte que la moyenne des valeurs observées soit égale à 0, et que l'écart type soit égal à 1.</p>\n"}]},"apps":[],"jobName":"paragraph_1646783807089_1697794352","id":"20220309-005647_1154272698","dateCreated":"2022-03-09T00:56:47+0100","dateStarted":"2022-03-15T23:50:32+0100","dateFinished":"2022-03-15T23:50:32+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37662"},{"text":"%pyspark\ndff.describe(continuousCols).show()\n","user":"imsduser","dateUpdated":"2022-03-15T03:45:38+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+------------------+-----------------+------------------+-----------------+------------------+------------------+------------------+------------------+-----------------+------------------+\n|summary|              loan|          mortdue|             value|              yoj|             derog|            delinq|             clage|              ninq|             clno|           debtinc|\n+-------+------------------+-----------------+------------------+-----------------+------------------+------------------+------------------+------------------+-----------------+------------------+\n|  count|              5960|             5442|              5848|             5445|              5252|              5380|              5652|              5450|             5738|              4693|\n|   mean| 18607.96979865772|73760.81719905653|101776.04874128976| 8.90358126721763|0.2545696877380046|0.4494423791821561|179.76627517814808|1.1860550458715597|21.29609620076682|33.779915328234615|\n| stddev|11207.480416694007|44457.60945733738|57385.775333653095|7.585544231901781| 0.846046777086319|1.1272659176049724| 85.81009185923472|1.7286749712080518|10.13893319245864| 8.601746176096125|\n|    min|            1100.0|           2063.0|            8000.0|                0|                 0|                 0|               0.0|                 0|                0|        0.52449924|\n|    max|           89900.0|         399550.0|          855909.0|               41|                10|                15|         1168.2335|                17|               71|         203.31215|\n+-------+------------------+-----------------+------------------+-----------------+------------------+------------------+------------------+------------------+-----------------+------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1646968560610_1727948845","id":"20220311-041600_568113109","dateCreated":"2022-03-11T04:16:00+0100","dateStarted":"2022-03-15T03:45:38+0100","dateFinished":"2022-03-15T03:45:40+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37663"},{"text":"%pyspark\nscaler = StandardScaler().setInputCol(\"features\").setOutputCol(\"Scaled_features\")\ntrain = scaler.fit(train).transform(train)\ntest = scaler.fit(test).transform(test)\ntrain.show()","user":"imsduser","dateUpdated":"2022-03-15T23:15:54+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----+--------------------+--------------------+\n|label|            features|     Scaled_features|\n+-----+--------------------+--------------------+\n|  0.0|[1.0,1.0,0.0,0.0,...|[2.19341744283980...|\n|  0.0|(16,[1,6,7,8,9,12...|(16,[1,6,7,8,9,12...|\n|  0.0|[1.0,0.0,0.0,0.0,...|[2.19341744283980...|\n|  0.0|[1.0,1.0,0.0,0.0,...|[2.19341744283980...|\n|  0.0|[0.0,0.0,0.0,1.0,...|[0.0,0.0,0.0,2.73...|\n|  0.0|[1.0,1.0,0.0,0.0,...|[2.19341744283980...|\n|  0.0|[1.0,1.0,0.0,0.0,...|[2.19341744283980...|\n|  0.0|(16,[0,3,6,7,8,9,...|(16,[0,3,6,7,8,9,...|\n|  0.0|[1.0,1.0,0.0,0.0,...|[2.19341744283980...|\n|  0.0|(16,[2,6,7,8,9,11...|(16,[2,6,7,8,9,11...|\n|  0.0|(16,[0,1,6,7,8,9,...|(16,[0,1,6,7,8,9,...|\n|  0.0|(16,[2,6,7,8,9,12...|(16,[2,6,7,8,9,12...|\n|  0.0|[1.0,0.0,1.0,0.0,...|[2.19341744283980...|\n|  0.0|(16,[3,6,7,8,9,12...|(16,[3,6,7,8,9,12...|\n|  0.0|(16,[0,2,6,7,8,9,...|(16,[0,2,6,7,8,9,...|\n|  0.0|[1.0,0.0,0.0,0.0,...|[2.19341744283980...|\n|  0.0|[1.0,0.0,1.0,0.0,...|[2.19341744283980...|\n|  0.0|(16,[0,4,6,7,8,9,...|(16,[0,4,6,7,8,9,...|\n|  0.0|[1.0,0.0,1.0,0.0,...|[2.19341744283980...|\n|  0.0|[1.0,1.0,0.0,0.0,...|[2.19341744283980...|\n+-----+--------------------+--------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1646970479888_-1358811376","id":"20220311-044759_401323175","dateCreated":"2022-03-11T04:47:59+0100","dateStarted":"2022-03-15T03:46:48+0100","dateFinished":"2022-03-15T03:46:53+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37664"},{"text":"%pyspark\nprint('--- Train ---')\ntrain.groupBy('label').count().orderBy('count', ascending=False).show()\n\nprint('--- Test ---')\ntest.groupBy('label').count().orderBy('count', ascending=False).show()","user":"imsduser","dateUpdated":"2022-03-15T03:57:11+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"--- Train ---\n+-----+-----+\n|label|count|\n+-----+-----+\n|  0.0| 3836|\n|  1.0|  940|\n+-----+-----+\n\n--- Test ---\n+-----+-----+\n|label|count|\n+-----+-----+\n|  0.0|  935|\n|  1.0|  249|\n+-----+-----+\n\n"}]},"apps":[],"jobName":"paragraph_1646970956399_-1829301273","id":"20220311-045556_818112536","dateCreated":"2022-03-11T04:55:56+0100","dateStarted":"2022-03-15T03:47:18+0100","dateFinished":"2022-03-15T03:47:24+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37665"},{"text":"%md \n<h3 style=\"font-family: Verdana\"><font color=\"#FF33F6\"><strong>1 - GridSearch - Model Selection</strong></font></h3>\nC'est une technique de réglage qui tente de déterminer les valeurs optimales des hyperparamètres. Il s'agit d'une recherche exhaustive qui est effectuée sur les valeurs spécifiques des paramètres d'un modèle. Le modèle est également connu sous le nom d'estimateur. L'exercice du Gridsearch peut nous faire économiser du temps, des efforts et des ressources. Le point de la grille qui maximise la valeur moyenne en validation croisée, est la combinaison optimale des valeurs des hyperparamètres. La recherche sur la grille est un algorithme exhaustif qui couvre toutes les combinaisons, ce qui lui permet de trouver le meilleur point dans le domaine.\n\n\nLes différents estimateurs testés sont les suivants :\n- DecisionTreeClassifier\n- RandomForestClassifier\n- LogisticRegression\n- NaiveBayes\n- GBTClassifier\n","user":"imsduser","dateUpdated":"2022-03-16T16:47:40+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3 style=\"font-family: Verdana\"><font color=\"#FF33F6\"><strong>1 - GridSearch - Model Selection</strong></font></h3>\n<p>C'est une technique de réglage qui tente de déterminer les valeurs optimales des hyperparamètres. Il s'agit d'une recherche exhaustive qui est effectuée sur les valeurs spécifiques des paramètres d'un modèle. Le modèle est également connu sous le nom d'estimateur. L'exercice du Gridsearch peut nous faire économiser du temps, des efforts et des ressources. Le point de la grille qui maximise la valeur moyenne en validation croisée, est la combinaison optimale des valeurs des hyperparamètres. La recherche sur la grille est un algorithme exhaustif qui couvre toutes les combinaisons, ce qui lui permet de trouver le meilleur point dans le domaine.</p>\n<p>Les différents estimateurs testés sont les suivants :</p>\n<ul>\n<li>DecisionTreeClassifier</li>\n<li>RandomForestClassifier</li>\n<li>LogisticRegression</li>\n<li>NaiveBayes</li>\n<li>GBTClassifier</li>\n</ul>\n"}]},"apps":[],"jobName":"paragraph_1646699033163_-1163125219","id":"20220308-012353_384642010","dateCreated":"2022-03-08T01:23:53+0100","dateStarted":"2022-03-16T16:47:40+0100","dateFinished":"2022-03-16T16:47:40+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37666"},{"text":"%md\n\n<h4 style=\"font-family: Verdana\"><font color=\"#D30543\"><strong> Decision Tree </strong></font></h4>\n\nC'est une technique d’apprentissage supervisé qui peut être utilisée à la fois pour les problèmes de classification et de régression, mais elle est principalement préférée pour résoudre les problèmes de classification. Il s’agit d’un classificateur à structure arborescente, où les nœuds internes représentent les caractéristiques d’un ensemble de données, les branches représentent les règles de décision et chaque nœud feuille représente le résultat. Ces algorithmes sélectionnent automatiquement les variables discriminantes à partir de données non-structurées et potentiellement volumineuses. Ils peuvent ainsi permettre d'extraire des règles logiques de cause à effet (des déterminismes) qui n'apparaissaient pas initialement dans les données brutes.","user":"imsduser","dateUpdated":"2022-03-16T16:48:15+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h4 style=\"font-family: Verdana\"><font color=\"#D30543\"><strong> Decision Tree </strong></font></h4>\n<p>C'est une technique d’apprentissage supervisé qui peut être utilisée à la fois pour les problèmes de classification et de régression, mais elle est principalement préférée pour résoudre les problèmes de classification. Il s’agit d’un classificateur à structure arborescente, où les nœuds internes représentent les caractéristiques d’un ensemble de données, les branches représentent les règles de décision et chaque nœud feuille représente le résultat. Ces algorithmes sélectionnent automatiquement les variables discriminantes à partir de données non-structurées et potentiellement volumineuses. Ils peuvent ainsi permettre d'extraire des règles logiques de cause à effet (des déterminismes) qui n'apparaissaient pas initialement dans les données brutes.</p>\n"}]},"apps":[],"jobName":"paragraph_1646700009850_-962111149","id":"20220308-014009_2033694507","dateCreated":"2022-03-08T01:40:09+0100","dateStarted":"2022-03-16T16:48:05+0100","dateFinished":"2022-03-16T16:48:05+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37667"},{"text":"%pyspark\ndt = DecisionTreeClassifier(labelCol=\"label\", featuresCol=\"Scaled_features\")\n\ndtparamGrid = (ParamGridBuilder()\n             .addGrid(dt.maxDepth, [ 10, 20, 30])\n             .addGrid(dt.maxBins, [20, 40, 80])\n             .build())\n\ndtevaluator = BinaryClassificationEvaluator(rawPredictionCol=\"rawPrediction\")\n\ndtcv = CrossValidator(estimator = dt,\n                      estimatorParamMaps = dtparamGrid,\n                      evaluator = dtevaluator,\n                      numFolds = 3)\n\ndtcvModel = dtcv.fit(train)\n\ncv_model = dtcvModel\nprint(\"Meilleurs parametres : \" , cv_model.getEstimatorParamMaps()[np.argmax(cv_model.avgMetrics)])","user":"imsduser","dateUpdated":"2022-03-15T23:16:28+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"('Meilleurs parametres : ', {Param(parent=u'DecisionTreeClassifier_4c828a4bb8ec04fd5619', name='maxBins', doc='Max number of bins for discretizing continuous features.  Must be >=2 and >= number of categories for any categorical feature.'): 80, Param(parent=u'DecisionTreeClassifier_4c828a4bb8ec04fd5619', name='maxDepth', doc='Maximum depth of the tree. (>= 0) E.g., depth 0 means 1 leaf node; depth 1 means 1 internal node + 2 leaf nodes.'): 20})\n"}]},"apps":[],"jobName":"paragraph_1646699690936_-1751827142","id":"20220308-013450_1189345505","dateCreated":"2022-03-08T01:34:50+0100","dateStarted":"2022-03-15T03:51:37+0100","dateFinished":"2022-03-15T04:17:42+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37668"},{"text":"%md\n<h4 style=\"font-family: Verdana\"><font color=\"#D30543\"><strong> Random Forest</strong></font></h4>\nLe Random Forest est un algorithme d’apprentissage supervisé . La «forêt» qu’elle construit est un ensemble d’arbres de décision, généralement formés avec la méthode «assemblage». L’idée générale de la méthode d’assemblage est qu’une combinaison de modèles d’apprentissage, augmente le résultat global. En termes simples : une forêt aléatoire construit plusieurs arbres de décision et les fusionne pour obtenir une prédiction plus précise et plus stable.","user":"imsduser","dateUpdated":"2022-03-15T23:54:08+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h4 style=\"font-family: Verdana\"><font color=\"#D30543\"><strong> Random Forest</strong></font></h4>\n<p>Le Random Forest est un algorithme d’apprentissage supervisé . La «forêt» qu’elle construit est un ensemble d’arbres de décision, généralement formés avec la méthode «assemblage». L’idée générale de la méthode d’assemblage est qu’une combinaison de modèles d’apprentissage, augmente le résultat global. En termes simples : une forêt aléatoire construit plusieurs arbres de décision et les fusionne pour obtenir une prédiction plus précise et plus stable.</p>\n"}]},"apps":[],"jobName":"paragraph_1646698980980_-296932851","id":"20220308-012300_1772357493","dateCreated":"2022-03-08T01:23:00+0100","dateStarted":"2022-03-15T23:53:26+0100","dateFinished":"2022-03-15T23:53:26+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37669"},{"text":"%pyspark\n\nrf = RandomForestClassifier(labelCol=\"label\", featuresCol=\"Scaled_features\")\n\nrfevaluator = BinaryClassificationEvaluator()\n\nrfparamGrid = (ParamGridBuilder()\n             .addGrid(rf.maxDepth, [ 10, 20, 30])\n             .addGrid(rf.maxBins, [5, 10, 20])\n             .addGrid(rf.numTrees, [5, 20, 50])\n             .build())\n\nrfcv = CrossValidator(estimator = rf,\n                      estimatorParamMaps = rfparamGrid,\n                      evaluator = rfevaluator,\n                      numFolds =3)\n\nrfcvModel = rfcv.fit(train)\ncv_model = rfcvModel\nprint(\"Meilleurs parametres : \" , cv_model.getEstimatorParamMaps()[np.argmax(cv_model.avgMetrics)])","user":"imsduser","dateUpdated":"2022-03-15T23:16:28+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"('Meilleurs parametres : ', {Param(parent=u'RandomForestClassifier_45d985091ee021f255d0', name='maxDepth', doc='Maximum depth of the tree. (>= 0) E.g., depth 0 means 1 leaf node; depth 1 means 1 internal node + 2 leaf nodes.'): 30, Param(parent=u'RandomForestClassifier_45d985091ee021f255d0', name='numTrees', doc='Number of trees to train (>= 1).'): 50, Param(parent=u'RandomForestClassifier_45d985091ee021f255d0', name='maxBins', doc='Max number of bins for discretizing continuous features.  Must be >=2 and >= number of categories for any categorical feature.'): 20})\n"}]},"apps":[],"jobName":"paragraph_1646688805855_1043239063","id":"20220307-223325_691411726","dateCreated":"2022-03-07T22:33:25+0100","dateStarted":"2022-03-15T03:51:51+0100","dateFinished":"2022-03-15T07:46:44+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37670"},{"text":"%md\n\n<h4 style=\"font-family: Verdana\"><font color=\"#D30543\"><strong> LogisticRegression</strong></font></h4>\n\nLa régression logistique est un modèle statistique linéaire permettant d'étudier les relations entre un ensemble de variables explicatives  X_i  et une variable cible  y. Ce modèle utilise une fonction logistique  hθ  comme fonction de lien, qui donne une probabilité allant de 0 à 1. \nTrouver la fonction logistique optimale revient à optimiser la fonction de coût selon le paramètre multi-dimensionnel θ.\n\nLa régression logistique est appelée modèle linéaire généralisé, c'est-à-dire qu'il s'agit d'un modèle linéaire avec une fonction de liaison qui relie le résultat de la régression multiple linéaire à la probabilité postérieure de la classe. qui fait correspondre la sortie de la régression multiple linéaire à la probabilité postérieure de la classe 1 𝑝(y=1|𝑥) en utilisant la fonction sigmoïde logistique :\n\n\\begin{equation}\np(y=1|w,xi) = \\frac{1}{1+exp(-w.xi)}\n\\end{equation}\n\nLa régression logistique est un modèle discriminant puisqu'elle se concentre uniquement sur la probabilité postérieure de chaque classe 𝑝(𝐶𝑘|𝑥). Elle nécessite uniquement d'estimer les poids 𝑃 du vecteur 𝑤. ","user":"imsduser","dateUpdated":"2022-03-16T16:48:55+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h4 style=\"font-family: Verdana\"><font color=\"#D30543\"><strong> LogisticRegression</strong></font></h4>\n<p>La régression logistique est un modèle statistique linéaire permettant d'étudier les relations entre un ensemble de variables explicatives  X_i  et une variable cible  y. Ce modèle utilise une fonction logistique  hθ  comme fonction de lien, qui donne une probabilité allant de 0 à 1.\n<br  />Trouver la fonction logistique optimale revient à optimiser la fonction de coût selon le paramètre multi-dimensionnel θ.</p>\n<p>La régression logistique est appelée modèle linéaire généralisé, c'est-à-dire qu'il s'agit d'un modèle linéaire avec une fonction de liaison qui relie le résultat de la régression multiple linéaire à la probabilité postérieure de la classe. qui fait correspondre la sortie de la régression multiple linéaire à la probabilité postérieure de la classe 1 𝑝(y=1|𝑥) en utilisant la fonction sigmoïde logistique :</p>\n<p>\\begin{equation}\n<br  />p(y=1|w,xi) = \\frac{1}{1+exp(-w.xi)}\n<br  />\\end{equation}</p>\n<p>La régression logistique est un modèle discriminant puisqu'elle se concentre uniquement sur la probabilité postérieure de chaque classe 𝑝(𝐶𝑘|𝑥). Elle nécessite uniquement d'estimer les poids 𝑃 du vecteur 𝑤.</p>\n"}]},"apps":[],"jobName":"paragraph_1646963293659_1546227536","id":"20220311-024813_237700468","dateCreated":"2022-03-11T02:48:13+0100","dateStarted":"2022-03-16T16:48:55+0100","dateFinished":"2022-03-16T16:48:55+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37671"},{"text":"%pyspark\nlr = LogisticRegression(labelCol=\"label\", featuresCol=\"Scaled_features\")\n\nlrparamGrid = (ParamGridBuilder()\n             .addGrid(lr.regParam, [ 0.1, 1.0, 2.0])\n             .addGrid(lr.elasticNetParam, [ 0.5, 0.75, 1.0])\n             .addGrid(lr.maxIter, [10, 20, 50])\n             .build())\n\nlrevaluator = BinaryClassificationEvaluator(rawPredictionCol=\"rawPrediction\")\n\nlrcv = CrossValidator(estimator = lr,\n                    estimatorParamMaps = lrparamGrid,\n                    evaluator = lrevaluator,\n                    numFolds = 3)\n\nlrcvModel = lrcv.fit(train)\n\ncv_model = lrcvModel\nprint(\"Meilleurs parametres : \" , cv_model.getEstimatorParamMaps()[np.argmax(cv_model.avgMetrics)])","user":"imsduser","dateUpdated":"2022-03-15T23:16:29+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"('Meilleurs parametres : ', {Param(parent=u'LogisticRegression_475aaecc886a775cfcd1', name='regParam', doc='regularization parameter (>= 0).'): 0.1, Param(parent=u'LogisticRegression_475aaecc886a775cfcd1', name='maxIter', doc='max number of iterations (>= 0).'): 10, Param(parent=u'LogisticRegression_475aaecc886a775cfcd1', name='elasticNetParam', doc='the ElasticNet mixing parameter, in range [0, 1]. For alpha = 0, the penalty is an L2 penalty. For alpha = 1, it is an L1 penalty.'): 0.5})\n"}]},"apps":[],"jobName":"paragraph_1646701463799_1034375258","id":"20220308-020423_938627850","dateCreated":"2022-03-08T02:04:23+0100","dateStarted":"2022-03-15T04:17:43+0100","dateFinished":"2022-03-15T08:11:18+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37672"},{"text":"%md\n\n<h4 style=\"font-family: Verdana\"><font color=\"#D30543\"><strong> NaiveBayes </strong></font></h4>\nLes méthodes de Bayes naïf sont un ensemble d'algorithmes d'apprentissage supervisé basés sur l'application du théorème de Bayes avec l'hypothèse \"naïve\" de l'indépendance conditionnelle entre chaque paire de caractéristiques étant donné la valeur de la variable de classe. Cependant, cette technique est très efficace sur un large éventail de problèmes complexes.\nIl est facile et rapide de prédire la classe de l'ensemble de données de test. Il est également performant dans la prédiction multi-classes. Lorsque l'hypothèse d'indépendance est vérifiée, un classificateur Naive Bayes est plus performant que d'autres modèles tels que la régression logistique, et moins de données d'entraînement sont nécessaires.","user":"imsduser","dateUpdated":"2022-03-15T23:55:26+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h4 style=\"font-family: Verdana\"><font color=\"#D30543\"><strong> NaiveBayes </strong></font></h4>\n<p>Les méthodes de Bayes naïf sont un ensemble d'algorithmes d'apprentissage supervisé basés sur l'application du théorème de Bayes avec l'hypothèse &ldquo;naïve&rdquo; de l'indépendance conditionnelle entre chaque paire de caractéristiques étant donné la valeur de la variable de classe. Cependant, cette technique est très efficace sur un large éventail de problèmes complexes.\n<br  />Il est facile et rapide de prédire la classe de l'ensemble de données de test. Il est également performant dans la prédiction multi-classes. Lorsque l'hypothèse d'indépendance est vérifiée, un classificateur Naive Bayes est plus performant que d'autres modèles tels que la régression logistique, et moins de données d'entraînement sont nécessaires.</p>\n"}]},"apps":[],"jobName":"paragraph_1646971248054_1662496378","id":"20220311-050048_1937921992","dateCreated":"2022-03-11T05:00:48+0100","dateStarted":"2022-03-15T23:55:17+0100","dateFinished":"2022-03-15T23:55:17+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37673"},{"text":"%pyspark\n\nnb = NaiveBayes(labelCol=\"label\", featuresCol=\"Scaled_features\")\n\nnbparamGrid = (ParamGridBuilder()\n               .addGrid(nb.smoothing, [ 0.4, 0.6, 0.8, 1.0])\n               .build())\n\nnbevaluator = BinaryClassificationEvaluator(rawPredictionCol=\"rawPrediction\")\n\nnbcv = CrossValidator(estimator = nb,\n                    estimatorParamMaps = nbparamGrid,\n                    evaluator = nbevaluator,\n                    numFolds = 5)\nnbcvModel = nbcv.fit(train)\n                    \ncv_model = nbcvModel\nprint(\"Meilleurs parametres : \" , cv_model.getEstimatorParamMaps()[np.argmax(cv_model.avgMetrics)])\n","user":"imsduser","dateUpdated":"2022-03-15T23:16:29+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"('Meilleurs parametres : ', {Param(parent=u'NaiveBayes_48d0887485701bf11328', name='smoothing', doc='The smoothing parameter, should be >= 0, default is 1.0'): 0.4})\n"}]},"apps":[],"jobName":"paragraph_1646963314678_-1102737993","id":"20220311-024834_878284145","dateCreated":"2022-03-11T02:48:34+0100","dateStarted":"2022-03-15T07:46:44+0100","dateFinished":"2022-03-15T08:13:38+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37674"},{"text":"%md\n<h4 style=\"font-family: Verdana\"><font color=\"#D30543\"><strong> GradientBoostingClassifier</strong></font></h4>\n\nDans le Gradient Boosting, chaque prédicteur tente d’améliorer son pré-décesseur en réduisant les erreurs. Mais l’idée fascinante derrière ceci est qu’au lieu d’ajuster un prédicteur sur les données à chaque itération, il ajuste en fait un nouveau prédicteur aux erreurs résiduelles commises par le prédicteur précédent. Il construit un modèle additif de manière progressive, par étapes, et permet l'optimisation de fonctions de perte différentiables arbitraires. À chaque étape, des arbres de régression de (n) classes sont ajustés sur le gradient négatif de la fonction de perte de déviance binomiale ou multinomiale.","user":"imsduser","dateUpdated":"2022-03-16T16:50:15+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h4 style=\"font-family: Verdana\"><font color=\"#D30543\"><strong> GradientBoostingClassifier</strong></font></h4>\n<p>Dans le Gradient Boosting, chaque prédicteur tente d’améliorer son pré-décesseur en réduisant les erreurs. Mais l’idée fascinante derrière ceci est qu’au lieu d’ajuster un prédicteur sur les données à chaque itération, il ajuste en fait un nouveau prédicteur aux erreurs résiduelles commises par le prédicteur précédent. Il construit un modèle additif de manière progressive, par étapes, et permet l'optimisation de fonctions de perte différentiables arbitraires. À chaque étape, des arbres de régression de (n) classes sont ajustés sur le gradient négatif de la fonction de perte de déviance binomiale ou multinomiale.</p>\n"}]},"apps":[],"jobName":"paragraph_1646783306236_889520636","id":"20220309-004826_1130419546","dateCreated":"2022-03-09T00:48:26+0100","dateStarted":"2022-03-16T16:50:15+0100","dateFinished":"2022-03-16T16:50:22+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37675"},{"text":"%pyspark\ngb  =  GBTClassifier(labelCol=\"label\", featuresCol=\"Scaled_features\",seed=42)\n\ngbparamGrid = (ParamGridBuilder()\n             .addGrid(gb.maxDepth, [ 10, 20, 30])\n             .addGrid(gb.maxBins, [5, 10, 20])\n             .build())\n\ngbevaluator = BinaryClassificationEvaluator(rawPredictionCol=\"rawPrediction\")\n\ngbcv = CrossValidator(estimator = gb,\n                    estimatorParamMaps = gbparamGrid,\n                    evaluator = gbevaluator,\n                    numFolds = 3)\n\ngbcvModel = gbcv.fit(train)\n\ncv_model = gbcvModel\nprint(\"Meilleurs parametres : \" , cv_model.getEstimatorParamMaps()[np.argmax(cv_model.avgMetrics)])","user":"imsduser","dateUpdated":"2022-03-15T23:16:40+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1647361926683_625849475","id":"20220315-173206_2097287961","dateCreated":"2022-03-15T17:32:06+0100","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:37676"},{"text":"%md\n<h3 style=\"font-family: Verdana\"><font color=\"#FF33F6\"><strong>2 - Meilleurs modèles</strong></font></h3>","user":"imsduser","dateUpdated":"2022-03-15T23:58:23+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3 style=\"font-family: Verdana\"><font color=\"#FF33F6\"><strong>2 - Meilleurs modèles</strong></font></h3>\n"}]},"apps":[],"jobName":"paragraph_1646784491157_-229366163","id":"20220309-010811_1934031445","dateCreated":"2022-03-09T01:08:11+0100","dateStarted":"2022-03-15T23:58:23+0100","dateFinished":"2022-03-15T23:58:23+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37677"},{"text":"%md\n\n<h4 style=\"font-family: Verdana\"><font color=\"#D30543\"><strong> DecisionTree </strong></font></h4>","user":"imsduser","dateUpdated":"2022-03-16T00:05:27+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h4 style=\"font-family: Verdana\"><font color=\"#D30543\"><strong> DecisionTree </strong></font></h4>\n"}]},"apps":[],"jobName":"paragraph_1646790443987_2093847266","id":"20220309-024723_660541818","dateCreated":"2022-03-09T02:47:23+0100","dateStarted":"2022-03-16T00:05:27+0100","dateFinished":"2022-03-16T00:05:27+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37678"},{"text":"%pyspark\n### Decision Treee\ndt = DecisionTreeClassifier(labelCol=\"label\", featuresCol=\"Scaled_features\", maxDepth = 20, maxBins = 80)\nmodeldt = dt.fit(train)\ndtpredictions = modeldt.transform(test)\n\nlabelConverter = IndexToString(inputCol=\"prediction\", outputCol=\"predictedLabel\",\n                               labels=[\"0\", \"1\"])\ndtpredictions = labelConverter.transform(dtpredictions)\n#dtpredictions.show()","user":"imsduser","dateUpdated":"2022-03-15T23:16:58+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1646791638698_572455405","id":"20220309-030718_584327282","dateCreated":"2022-03-09T03:07:18+0100","dateStarted":"2022-03-15T17:35:25+0100","dateFinished":"2022-03-15T17:37:03+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37679"},{"text":"%pyspark\ndtpredictions.select(\"Scaled_features\",\"label\",\"predictedLabel\").show(5)","user":"imsduser","dateUpdated":"2022-03-15T17:52:26+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+-----+--------------+\n|     Scaled_features|label|predictedLabel|\n+--------------------+-----+--------------+\n|[0.0,2.0098533605...|  0.0|             0|\n|(16,[3,6,7,8,9,12...|  0.0|             0|\n|(16,[0,1,6,7,8,9,...|  0.0|             0|\n|(16,[5,6,7,8,9,12...|  0.0|             0|\n|(16,[1,6,7,8,9,12...|  1.0|             1|\n+--------------------+-----+--------------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1646961322758_-1548294711","id":"20220311-021522_677927101","dateCreated":"2022-03-11T02:15:22+0100","dateStarted":"2022-03-15T17:52:26+0100","dateFinished":"2022-03-15T17:52:28+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37680"},{"text":"%pyspark\n### Random Forest\nrf = RandomForestClassifier(labelCol=\"label\", featuresCol=\"Scaled_features\", maxDepth = 30,maxBins = 20, numTrees = 50 )\nmodelrf = rf.fit(train)\nrfpredictions = modelrf.transform(test)\nrfpredictions = labelConverter.transform(rfpredictions)\n#rfpredictions.show()","user":"imsduser","dateUpdated":"2022-03-15T23:17:27+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1646791137439_170087965","id":"20220309-025857_1393507617","dateCreated":"2022-03-09T02:58:57+0100","dateStarted":"2022-03-15T17:35:57+0100","dateFinished":"2022-03-15T17:50:13+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37681"},{"text":"%md\n<h4 style=\"font-family: Verdana\"><font color=\"#D30543\"><strong> LogisticRegression </strong></font></h4>","user":"imsduser","dateUpdated":"2022-03-16T00:00:03+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h4 style=\"font-family: Verdana\"><font color=\"#D30543\"><strong> LogisticRegression </strong></font></h4>\n"}]},"apps":[],"jobName":"paragraph_1646791220746_1256942311","id":"20220309-030020_1843344114","dateCreated":"2022-03-09T03:00:20+0100","dateStarted":"2022-03-15T23:59:48+0100","dateFinished":"2022-03-15T23:59:48+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37682"},{"text":"%pyspark\n### Logistic Regression\nlr = LogisticRegression(labelCol=\"label\", featuresCol=\"Scaled_features\",regParam = 0.1, maxIter = 10, elasticNetParam = 0.5)\nmodellr = lr.fit(train)\nlrpredictions = modellr.transform(test)\nlrpredictions = labelConverter.transform(lrpredictions)\n#lrpredictions.show()","user":"imsduser","dateUpdated":"2022-03-15T23:17:27+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1646791137238_-1131517564","id":"20220309-025857_896795918","dateCreated":"2022-03-09T02:58:57+0100","dateStarted":"2022-03-15T17:50:13+0100","dateFinished":"2022-03-15T17:51:20+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37683"},{"text":"%md\n<h4 style=\"font-family: Verdana\"><font color=\"#D30543\"><strong> NaiveBayes </strong></font></h4>","user":"imsduser","dateUpdated":"2022-03-16T00:00:17+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":false,"tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h4 style=\"font-family: Verdana\"><font color=\"#D30543\"><strong> NaiveBayes </strong></font></h4>\n"}]},"apps":[],"jobName":"paragraph_1646963485942_-1659055898","id":"20220311-025125_2031668823","dateCreated":"2022-03-11T02:51:25+0100","dateStarted":"2022-03-16T00:00:03+0100","dateFinished":"2022-03-16T00:00:05+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37684"},{"text":"%pyspark\nnb = NaiveBayes(labelCol=\"label\", featuresCol=\"Scaled_features\", smoothing = 0.4)\nmodelnb = nb.fit(train)\nnbpredictions = modelnb.transform(test)\nnbpredictions = labelConverter.transform(nbpredictions)","user":"imsduser","dateUpdated":"2022-03-15T23:17:28+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1646963482429_-1353580596","id":"20220311-025122_510808591","dateCreated":"2022-03-11T02:51:22+0100","dateStarted":"2022-03-15T17:37:04+0100","dateFinished":"2022-03-15T17:50:19+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37685"},{"text":"%md\n\n<h4 style=\"font-family: Verdana\"><font color=\"#D30543\"><strong> GradientBoostingClassifier </strong></font></h4>","user":"imsduser","dateUpdated":"2022-03-16T00:00:49+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h4 style=\"font-family: Verdana\"><font color=\"#D30543\"><strong> GradientBoostingClassifier </strong></font></h4>\n"}]},"apps":[],"jobName":"paragraph_1647362197653_545617033","id":"20220315-173637_938714967","dateCreated":"2022-03-15T17:36:37+0100","dateStarted":"2022-03-16T00:00:49+0100","dateFinished":"2022-03-16T00:00:49+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37686"},{"text":"%pyspark\ngb  =  GBTClassifier(labelCol=\"label\", featuresCol=\"Scaled_features\",maxDepth = 30 , maxBins = 20 , seed=42)\n\nmodelgb = gb.fit(train)\ngbpredictions = modelgb.transform(test)\ngbpredictions = labelConverter.transform(gbpredictions)","user":"imsduser","dateUpdated":"2022-03-15T23:33:47+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1647362195367_468267180","id":"20220315-173635_613639420","dateCreated":"2022-03-15T17:36:35+0100","dateStarted":"2022-03-15T23:33:37+0100","dateFinished":"2022-03-16T00:13:19+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37687"},{"text":"%md\n<h4 style=\"font-family: Verdana\"><font color=\"#D30543\"><strong>  Métriques utilisées </strong></font></h4>","user":"imsduser","dateUpdated":"2022-03-16T00:02:53+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h4 style=\"font-family: Verdana\"><font color=\"#D30543\"><strong>  Métriques utilisées </strong></font></h4>\n"}]},"apps":[],"jobName":"paragraph_1647385285665_275000188","id":"20220316-000125_1200496135","dateCreated":"2022-03-16T00:01:25+0100","dateStarted":"2022-03-16T00:02:01+0100","dateFinished":"2022-03-16T00:02:01+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37688"},{"text":"%md\nAfin de juger des performances de notre modèle, on sera amené à juger les valeurs des critères objectifs qui sont les suivants :\n<h5 style=\"font-family: Verdana\"><font color=\"#D30543\"><strong> Accuracy</strong></font></h5>\n\nL’accuracy représente le pourcentage de bonne prédictions. Elle calcule ainsi le ratio du nombre de clients (en défaut ou pas) bien classés sur le nombre total de clients. L’accuracy entre les données de test et les données prédites se détermine de la façon suivante :\n\\begin{equation}\nAccuracy = \\frac{TN + TP}{TN + TP + FP + FN}\n\\end{equation}\n\n<h5 style=\"font-family: Verdana\"><font color=\"#D30543\"><strong> Précision</strong></font></h5>\n\nLa precision minimise le taux d’erreurs parmi les exemples prédits positifs par le modèle. Elle renseigne alors sur la proportion des prédictions positives correctes. Sa valeur est comprise entre 0 et 1, plus elle est proche de 1 mieux est la précision, l’objectif étant de diminuer l’erreur du 1er type.\n\\begin{equation}\nPrecision  = \\frac{TP}{TP + FP}\n\\end{equation}\n<h5 style=\"font-family: Verdana\"><font color=\"#D30543\"><strong> Recall </strong></font></h5>\n\nLe recall, également connu sous le nom de sensibilité, détermine la probabilité de détection d’un prédicteur. Il permet de connaître tous les clients en défaut, ainsi que le pourcentage de clients que le prédicteur a effectivement classé en défaut (True Positive Rate). Sa valeur est comprise entre 0 et 1, plus elle est proche de 1 mieux est le recall, l’objectif étant de diminuer l’erreur du 2nd type.\n\\begin{equation}\nRecall = \\frac{TP}{TP + FN}\n\\end{equation}\n\n<h5 style=\"font-family: Verdana\"><font color=\"#D30543\"><strong> F1  score </strong></font></h5>\nDans la majeure partie des cas, le recall et la précision ne suffisent pas pour valider un modèle de classification. En effet, il est difficile de choisir entre 2 modèles si l'un a une grande précision et un faible recall ou vice versa. Il est pertinent de chercher une autre métrique pour trancher, alors intervient le F1 score. Il représente une moyenne harmonique de la précision et du recall. Il pénalise les valeurs extrêmes, si le recall ou la précision est faible alors le F1 score tend vers 0.\n\\begin{equation}\nF1  score = \\frac{2 * TP}{2 * TP + (FP + FN)}\n\\end{equation}\n\n\n\n<h5 style=\"font-family: Verdana\"><font color=\"#D30543\"><strong>WeightedPrecision</strong></font></h5>\nLa précision pondérée donne la moyenne pondérée de la précision avec des poids égaux à la probabilité de la classe.\n\\begin{equation}\n\\sum_{i=1}^{M}Precision_i \\cdot Weight_i\n\\end{equation}\n\n\n<h5 style=\"font-family: Verdana\"><font color=\"#D30543\"><strong>WeightedRecall</strong></font></h5>\nLe rappel pondéré donne la moyenne pondérée du rappel avec des poids égaux à la probabilité de la classe.\nLa moyenne pondérée tient compte du nombre d'éléments de chaque classe dans son calcul, donc moins d'éléments d'une classe signifie que son score de précision/rappel a moins d'impact sur la moyenne pondérée pour chacune de ces valeurs.\n\\begin{equation}\n\\sum_{i=1}^{M}Recall_i \\cdot Weight_i\n\\end{equation}\n<h5 style=\"font-family: Verdana\"><font color=\"#D30543\"><strong> ROC curve - AUC </strong></font></h5>\n\nLa ROC (Receiver Operating Characteristic) curve est une mesure de performance d’un classificateur binaire. Elle trace le taux de vrais positifs (TPR ou Recall) en fonction du taux de faux positifs TFP pour chaque seuil possible. La meilleure courbe est celle qui longe l’axe des ordonnées et atteint le point extrême au Nord-Ouest, le coin supérieur gauche.\nElle facilite la comparaison de plusieurs modèles en fournissant un indicateur unique qui est l’AUC. Cette métrique ne nécessite pas non plus de spécifier un seuil de décision. L’AUC est invariante à l’échelle, elle renseigne à quel point les prédictions sont classées, plutôt que leurs valeurs absolues. Le meilleur modèle a son AUC proche de 1, le prédicteur aléatoire a son AUC = 0.5 et sa ROC curve est une bissectrice. Un modèle avec son AUC = 0 est un modèle qui prédit toujours Y=0 lorsque Y=1 et Y=1 lorsque Y=0.\nNous avons un classifieur binaire, et dans notre cas de courbe ROC on considère 2 probabilités conditionnelles : le taux de vrais positifs (TPR)  c’est à dire la proportion de classe négative classée comme positive que l’on peut appeler ‘sensibilité’ et inversement pour le FPR (représentant le taux de faux positifs, que l’on peut appeler ‘spécificité’). \nLes taux sont calculés de la manière suivante : \n\n\\begin{equation}\nFPR = \\frac{TP}{TP+ FN}\n\\end{equation}\n\\begin{equation}\nFNR = \\frac{TN}{TN + FP}\n\\end{equation}\n\nLa courbe ROC, finalement, est un tracé de ces deux probabilités avec la sensibilité (TPR) sur l’axe des abscisses et la spécifié (TNR) sur l’axe des ordonnées.\nOn peut ainsi comparer plusieurs modèles à l'aide de leurs courbes ROC et déterminer quel modèle performe le mieux en se basant sur l'aire sous la courbe (AUC). Plus l'aire sous la courbe est grande, plus le modèle est performant.\n\n\\begin{equation}\nAUC(f)=\\int_{-\\infty}^{+\\infty} g(x)\n\\end{equation}\n\n\n\n\n","user":"imsduser","dateUpdated":"2022-03-16T00:02:53+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Afin de juger des performances de notre modèle, on sera amené à juger les valeurs des critères objectifs qui sont les suivants :</p>\n<h5 style=\"font-family: Verdana\"><font color=\"#D30543\"><strong> Accuracy</strong></font></h5>\n<p>L’accuracy représente le pourcentage de bonne prédictions. Elle calcule ainsi le ratio du nombre de clients (en défaut ou pas) bien classés sur le nombre total de clients. L’accuracy entre les données de test et les données prédites se détermine de la façon suivante :\n<br  />\\begin{equation}\n<br  />Accuracy = \\frac{TN + TP}{TN + TP + FP + FN}\n<br  />\\end{equation}</p>\n<h5 style=\"font-family: Verdana\"><font color=\"#D30543\"><strong> Précision</strong></font></h5>\n<p>La precision minimise le taux d’erreurs parmi les exemples prédits positifs par le modèle. Elle renseigne alors sur la proportion des prédictions positives correctes. Sa valeur est comprise entre 0 et 1, plus elle est proche de 1 mieux est la précision, l’objectif étant de diminuer l’erreur du 1er type.\n<br  />\\begin{equation}\n<br  />Precision  = \\frac{TP}{TP + FP}\n<br  />\\end{equation}</p>\n<h5 style=\"font-family: Verdana\"><font color=\"#D30543\"><strong> Recall </strong></font></h5>\n<p>Le recall, également connu sous le nom de sensibilité, détermine la probabilité de détection d’un prédicteur. Il permet de connaître tous les clients en défaut, ainsi que le pourcentage de clients que le prédicteur a effectivement classé en défaut (True Positive Rate). Sa valeur est comprise entre 0 et 1, plus elle est proche de 1 mieux est le recall, l’objectif étant de diminuer l’erreur du 2nd type.\n<br  />\\begin{equation}\n<br  />Recall = \\frac{TP}{TP + FN}\n<br  />\\end{equation}</p>\n<h5 style=\"font-family: Verdana\"><font color=\"#D30543\"><strong> F1  score </strong></font></h5>\n<p>Dans la majeure partie des cas, le recall et la précision ne suffisent pas pour valider un modèle de classification. En effet, il est difficile de choisir entre 2 modèles si l'un a une grande précision et un faible recall ou vice versa. Il est pertinent de chercher une autre métrique pour trancher, alors intervient le F1 score. Il représente une moyenne harmonique de la précision et du recall. Il pénalise les valeurs extrêmes, si le recall ou la précision est faible alors le F1 score tend vers 0.\n<br  />\\begin{equation}\n<br  />F1  score = \\frac{2 * TP}{2 * TP + (FP + FN)}\n<br  />\\end{equation}</p>\n<h5 style=\"font-family: Verdana\"><font color=\"#D30543\"><strong>WeightedPrecision</strong></font></h5>\n<p>La précision pondérée donne la moyenne pondérée de la précision avec des poids égaux à la probabilité de la classe.\n<br  />\\begin{equation}\n<br  />\\sum_{i=1}^{M}Precision_i \\cdot Weight_i\n<br  />\\end{equation}</p>\n<h5 style=\"font-family: Verdana\"><font color=\"#D30543\"><strong>WeightedRecall</strong></font></h5>\n<p>Le rappel pondéré donne la moyenne pondérée du rappel avec des poids égaux à la probabilité de la classe.\n<br  />La moyenne pondérée tient compte du nombre d'éléments de chaque classe dans son calcul, donc moins d'éléments d'une classe signifie que son score de précision/rappel a moins d'impact sur la moyenne pondérée pour chacune de ces valeurs.\n<br  />\\begin{equation}\n<br  />\\sum_{i=1}^{M}Recall_i \\cdot Weight_i\n<br  />\\end{equation}</p>\n<h5 style=\"font-family: Verdana\"><font color=\"#D30543\"><strong> ROC curve - AUC </strong></font></h5>\n<p>La ROC (Receiver Operating Characteristic) curve est une mesure de performance d’un classificateur binaire. Elle trace le taux de vrais positifs (TPR ou Recall) en fonction du taux de faux positifs TFP pour chaque seuil possible. La meilleure courbe est celle qui longe l’axe des ordonnées et atteint le point extrême au Nord-Ouest, le coin supérieur gauche.\n<br  />Elle facilite la comparaison de plusieurs modèles en fournissant un indicateur unique qui est l’AUC. Cette métrique ne nécessite pas non plus de spécifier un seuil de décision. L’AUC est invariante à l’échelle, elle renseigne à quel point les prédictions sont classées, plutôt que leurs valeurs absolues. Le meilleur modèle a son AUC proche de 1, le prédicteur aléatoire a son AUC = 0.5 et sa ROC curve est une bissectrice. Un modèle avec son AUC = 0 est un modèle qui prédit toujours Y=0 lorsque Y=1 et Y=1 lorsque Y=0.\n<br  />Nous avons un classifieur binaire, et dans notre cas de courbe ROC on considère 2 probabilités conditionnelles : le taux de vrais positifs (TPR)  c’est à dire la proportion de classe négative classée comme positive que l’on peut appeler ‘sensibilité’ et inversement pour le FPR (représentant le taux de faux positifs, que l’on peut appeler ‘spécificité’).\n<br  />Les taux sont calculés de la manière suivante :</p>\n<p>\\begin{equation}\n<br  />FPR = \\frac{TP}{TP+ FN}\n<br  />\\end{equation}\n<br  />\\begin{equation}\n<br  />FNR = \\frac{TN}{TN + FP}\n<br  />\\end{equation}</p>\n<p>La courbe ROC, finalement, est un tracé de ces deux probabilités avec la sensibilité (TPR) sur l’axe des abscisses et la spécifié (TNR) sur l’axe des ordonnées.\n<br  />On peut ainsi comparer plusieurs modèles à l'aide de leurs courbes ROC et déterminer quel modèle performe le mieux en se basant sur l'aire sous la courbe (AUC). Plus l'aire sous la courbe est grande, plus le modèle est performant.</p>\n<p>\\begin{equation}\n<br  />AUC(f)=\\int_{-\\infty}^{+\\infty} g(x)\n<br  />\\end{equation}</p>\n"}]},"apps":[],"jobName":"paragraph_1646701650182_1381290716","id":"20220308-020730_1468760208","dateCreated":"2022-03-08T02:07:30+0100","dateStarted":"2022-03-16T00:01:59+0100","dateFinished":"2022-03-16T00:01:59+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37689"},{"text":"%pyspark\ndef metriques(model, data):\n    \n    #print(str(model))\n    if data == train:\n        dd = \"train\"\n    else:\n        dd = \"test\"\n    #print(\" ---- \" + dd)\n    \n    evaluatorMulti = MulticlassClassificationEvaluator(labelCol=\"label\", predictionCol=\"prediction\")\n    evaluator = BinaryClassificationEvaluator(labelCol=\"label\", rawPredictionCol=\"prediction\", metricName='areaUnderROC')\n    \n    predictionAndTarget = model.transform(data).select(\"label\", \"prediction\")\n\n    acc = evaluatorMulti.evaluate(predictionAndTarget, {evaluatorMulti.metricName: \"accuracy\"})\n    f1 = evaluatorMulti.evaluate(predictionAndTarget, {evaluatorMulti.metricName: \"f1\"})\n    weightedPrecision = evaluatorMulti.evaluate(predictionAndTarget, {evaluatorMulti.metricName: \"weightedPrecision\"})\n    weightedRecall = evaluatorMulti.evaluate(predictionAndTarget, {evaluatorMulti.metricName: \"weightedRecall\"})\n    auc = evaluator.evaluate(predictionAndTarget)\n    #print(\"Accuracy : \", acc)\n    #print(\"f1 : \", f1)\n    #print(\"weightedPrecision : \", weightedPrecision)\n    #print(\"weightedRecall : \", weightedRecall)\n    #print(\"AUC : \", auc)\n    return acc, f1, auc, weightedPrecision, weightedRecall\n\n","user":"imsduser","dateUpdated":"2022-03-15T23:17:48+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1646966427512_-1143281123","id":"20220311-034027_2005404204","dateCreated":"2022-03-11T03:40:27+0100","dateStarted":"2022-03-15T17:52:35+0100","dateFinished":"2022-03-15T17:52:35+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37690"},{"text":"%pyspark\nacc, f1, auc, weightedPrecision, weightedRecall = metriques(modeldt, train)\nacc_tr_dt, f1_tr_dt, auc_tr_dt, weightedPrecision_tr_dt, weightedRecall_tr_dt = acc, f1, auc, weightedPrecision, weightedRecall\nacc, f1, auc, weightedPrecision, weightedRecall = metriques(modeldt, test)\nacc_ts_dt, f1_ts_dt, auc_ts_dt, weightedPrecision_ts_dt, weightedRecall_ts_dt = acc, f1, auc, weightedPrecision, weightedRecall","user":"imsduser","dateUpdated":"2022-03-15T17:52:39+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python","editorHide":false,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1646966161890_782034666","id":"20220311-033601_670784712","dateCreated":"2022-03-11T03:36:01+0100","dateStarted":"2022-03-15T17:52:39+0100","dateFinished":"2022-03-15T17:54:45+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37691"},{"text":"%pyspark\nacc, f1, auc, weightedPrecision, weightedRecall = metriques(modelrf, train)\nacc_tr_rf, f1_tr_rf, auc_tr_rf, weightedPrecision_tr_rf, weightedRecall_tr_rf = acc, f1, auc, weightedPrecision, weightedRecall\nacc, f1, auc, weightedPrecision, weightedRecall = metriques(modelrf, test)\nacc_ts_rf, f1_ts_rf, auc_ts_rf, weightedPrecision_ts_rf, weightedRecall_ts_rf = acc, f1, auc, weightedPrecision, weightedRecall","user":"imsduser","dateUpdated":"2022-03-15T17:52:52+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1646966748885_130498248","id":"20220311-034548_1431409353","dateCreated":"2022-03-11T03:45:48+0100","dateStarted":"2022-03-15T17:52:52+0100","dateFinished":"2022-03-15T18:00:53+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37692"},{"text":"%pyspark\nacc, f1, auc, weightedPrecision, weightedRecall = metriques(modelgb, train)\nacc_tr_gb, f1_tr_gb, auc_tr_gb, weightedPrecision_tr_gb, weightedRecall_tr_gb = acc, f1, auc, weightedPrecision, weightedRecall\nacc, f1, auc, weightedPrecision, weightedRecall = metriques(modelgb, test)\nacc_ts_gb, f1_ts_gb, auc_ts_gb, weightedPrecision_ts_gb, weightedRecall_ts_gb = acc, f1, auc, weightedPrecision, weightedRecall","user":"imsduser","dateUpdated":"2022-03-15T23:33:50+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1647362448886_1723670548","id":"20220315-174048_1877495943","dateCreated":"2022-03-15T17:40:48+0100","dateStarted":"2022-03-15T23:33:50+0100","dateFinished":"2022-03-16T00:15:14+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37693"},{"text":"%pyspark\nacc, f1, auc, weightedPrecision, weightedRecall = metriques(modellr, train)\nacc_tr_lr, f1_tr_lr, auc_tr_lr, weightedPrecision_tr_lr, weightedRecall_tr_lr = acc, f1, auc, weightedPrecision, weightedRecall\nacc, f1, auc, weightedPrecision, weightedRecall = metriques(modellr, test)\nacc_ts_lr, f1_ts_lr, auc_ts_lr, weightedPrecision_ts_lr, weightedRecall_ts_lr = acc, f1, auc, weightedPrecision, weightedRecall","user":"imsduser","dateUpdated":"2022-03-15T17:53:01+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1646966789953_1595683356","id":"20220311-034629_2040850806","dateCreated":"2022-03-11T03:46:29+0100","dateStarted":"2022-03-15T17:54:46+0100","dateFinished":"2022-03-15T18:03:02+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37694"},{"text":"%pyspark\nacc, f1, auc, weightedPrecision, weightedRecall = metriques(modelnb, train)\nacc_tr_nb, f1_tr_nb, auc_tr_nb, weightedPrecision_tr_nb, weightedRecall_tr_nb = acc, f1, auc, weightedPrecision, weightedRecall\nacc, f1, auc, weightedPrecision, weightedRecall = metriques(modelnb, test)\nacc_ts_nb, f1_ts_nb, auc_ts_nb, weightedPrecision_ts_nb, weightedRecall_ts_nb = acc, f1, auc, weightedPrecision, weightedRecall","user":"imsduser","dateUpdated":"2022-03-15T17:53:04+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1646966829993_-1936064716","id":"20220311-034709_1007002987","dateCreated":"2022-03-11T03:47:09+0100","dateStarted":"2022-03-15T18:00:53+0100","dateFinished":"2022-03-15T18:05:11+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37695"},{"text":"%pyspark\nmetrics_val_train = [(\"LogisticRegression\",auc_tr_lr, acc_tr_lr, f1_tr_lr, weightedPrecision_tr_lr, weightedRecall_tr_lr),\n           (\"RandomForest\",      auc_tr_rf, acc_tr_rf, f1_tr_rf, weightedPrecision_tr_rf, weightedRecall_tr_rf),\n           (\"NaiveBayes\"   ,      auc_tr_nb, acc_tr_nb, f1_tr_nb, weightedPrecision_tr_nb, weightedRecall_tr_nb),\n           (\"DecisionTree\",       auc_tr_dt, acc_tr_dt, f1_tr_dt, weightedPrecision_tr_dt, weightedRecall_tr_dt),\n           (\"GradientBoosting\",  auc_tr_gb, acc_tr_gb, f1_tr_gb, weightedPrecision_tr_gb, weightedRecall_tr_gb)]\n           \nmetrics_val_test = [(\"LogisticRegression\",auc_ts_lr, acc_ts_lr, f1_ts_lr, weightedPrecision_ts_lr, weightedRecall_ts_lr),\n           (\"RandomForest\",      auc_ts_rf, acc_ts_rf, f1_ts_rf, weightedPrecision_ts_rf, weightedRecall_ts_rf),\n           (\"NaiveBayes\"   ,      auc_ts_nb, acc_ts_nb, f1_ts_nb, weightedPrecision_ts_nb, weightedRecall_ts_nb),\n           (\"DecisionTree\",       auc_ts_dt, acc_ts_dt, f1_ts_dt, weightedPrecision_ts_dt, weightedRecall_ts_dt),\n           (\"GradientBoosting\",  auc_ts_gb, acc_ts_gb, f1_ts_gb, weightedPrecision_ts_gb, weightedRecall_ts_gb)]\n         \nprint(\"                     ------- TEST\")\nmetrics = [\"Model\",\"auc\", \"acc\", \"f1\", \"wgtPrec\", \"wgtRec\"]\nmetrics_test = spark.createDataFrame(data = metrics_val_test, schema = metrics).show()\nprint(\"                    ------- TRAIN\")\nmetrics_train = spark.createDataFrame(data = metrics_val_train, schema = metrics).show()","user":"imsduser","dateUpdated":"2022-03-16T01:32:56+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"                     ------- TEST\n+------------------+------------------+------------------+------------------+------------------+------------------+\n|             Model|               auc|               acc|                f1|           wgtPrec|            wgtRec|\n+------------------+------------------+------------------+------------------+------------------+------------------+\n|LogisticRegression|0.5341365461847389|0.8040540540540541| 0.729417324652439|0.8430081752703861|0.8040540540540541|\n|      RandomForest|0.6174043768657518|0.8378378378378378|0.7960729091736333|0.8594963882031602|0.8378378378378378|\n|        NaiveBayes|0.6328565599295578|0.7947635135135135|0.7795749313254619| 0.773173572763505|0.7947635135135135|\n|      DecisionTree|0.6986963898374245|0.8429054054054054|0.8295766889114382|0.8302384607609011|0.8429054054054055|\n|  GradientBoosting|0.6272362175976633|0.7905405405405406|0.7752842237955174|0.7683943490432814|0.7905405405405405|\n+------------------+------------------+------------------+------------------+------------------+------------------+\n\n                    ------- TRAIN\n+------------------+------------------+------------------+------------------+------------------+------------------+\n|             Model|               auc|               acc|                f1|           wgtPrec|            wgtRec|\n+------------------+------------------+------------------+------------------+------------------+------------------+\n|LogisticRegression|0.5457446808510639|0.8211892797319933|0.7557271693773926| 0.853748843721093|0.8211892797319933|\n|      RandomForest|0.9989361702127659|0.9995812395309883|0.9995810711175775|0.9995814577490545|0.9995812395309883|\n|        NaiveBayes|0.6613155325804806|0.8100921273031826|0.8016608176366982| 0.796429354477743|0.8100921273031826|\n|      DecisionTree|0.9831301444323653|0.9922529313232831|0.9922165332153041|0.9922536076799767|0.9922529313232831|\n|  GradientBoosting|               1.0|               1.0|               1.0|               1.0|               1.0|\n+------------------+------------------+------------------+------------------+------------------+------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1647362551595_783698337","id":"20220315-174231_813324181","dateCreated":"2022-03-15T17:42:31+0100","dateStarted":"2022-03-16T00:13:19+0100","dateFinished":"2022-03-16T00:15:15+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37696"},{"text":"%md\nOn remarque que globalement l'arbre de décision donne des résultats très bons. Concernant l’AUC et le wgtRec, il détient la pôle avec le RandomForrest, on voit que la regression logistique est la moins performante.\n\nLe modèle le plus équilibré est aussi l'arbre de décision qui présente le F1 score le plus élevé. Ce dernier ne formule pas d'hypothèses au sujet des données et n'est pas affecté par les problèmes d'échelles de mesure des variables. Il est capable aussi de gérer à la fois des variables numériques et catégorielles, et s'avère facilement interprétable.\n\nCependant, les arbres de décision peuvent s'avérer assez instables : ils sont sensibles aux variations (même assez faibles) de l'ensemble d'apprentissage en termes d'échantillons ou de variables considérées. Parfois, ils sont également très complexes, et généralisent mal l'ensemble d'apprentissage (problème de surapprentissage). La plupart des Modèles overfittent, et s'adaptent trop  aux données d'entraînement.\n\nToutefois, même si les algorithmes de Machine Learning se débrouillent pas mal, on préférera la logistique pour construire notre Grille de score en raison de son interprétabilité et de sa capacité à être facilement explicable.","user":"imsduser","dateUpdated":"2022-03-16T16:52:11+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":false,"tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>On remarque que globalement l'arbre de décision donne des résultats très bons. Concernant l’AUC et le wgtRec, il détient la pôle avec le RandomForrest. On voit que la regréssion logistique est la moins performante. Notre problème est orienté recall.</p>\n<p>Le modèle le plus équilibré est aussi l'arbre de décision qui présente le F1 score le plus élevé. Ce dernier ne formule pas d'hypothèses au sujet des données et n'est pas affecté par les problèmes d'échelles de mesure des variables. Il est capable aussi de gérer à la fois des variables numériques et catégorielles, et s'avère facilement interprétable.</p>\n<p>Cependant, les arbres de décision peuvent s'avérer assez instables : ils sont sensibles aux variations (même assez faibles) de l'ensemble d'apprentissage en termes d'échantillons ou de variables considérées. Parfois, ils sont également très complexes, et généralisent mal l'ensemble d'apprentissage (problème de surapprentissage). La plupart des Modèles overfittent, et s'adaptent trop  aux données d'entraînement.</p>\n<p>Toutefois, même si les algorithmes de ML se débrouillent pas mal, on préférera la logistique pour construire notre Grille de score en raison de son interprétabilité et de sa capacité à être facilement explicable.</p>\n"}]},"apps":[],"jobName":"paragraph_1646688804458_1705761344","id":"20220307-223324_718566909","dateCreated":"2022-03-07T22:33:24+0100","dateStarted":"2022-03-16T01:26:31+0100","dateFinished":"2022-03-16T01:26:31+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37697"},{"text":"%md\n<h2 style=\"font-family: Verdana\"><font color=\"#7133FF\"><strong> V - Streamlit app web</strong></font></h2>","user":"imsduser","dateUpdated":"2022-03-16T01:31:02+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2 style=\"font-family: Verdana\"><font color=\"#7133FF\"><strong> V - Streamlit app web</strong></font></h2>\n"}]},"apps":[],"jobName":"paragraph_1647378517096_-384508091","id":"20220315-220837_1961897730","dateCreated":"2022-03-15T22:08:37+0100","dateStarted":"2022-03-16T00:02:18+0100","dateFinished":"2022-03-16T00:02:18+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37698"},{"text":"%md\n\nCette application ci-dessous est un outil automatisé permettant selon les caractéristiques entrées des clients de générer le score ainsi que la probabilité de défaut d'un emprunteur. Il est accessible [en cliquant sur ce lien] (https://share.streamlit.io/aadmberrada/systemesrepartis/main/app.py) (nous vous invitons à y accéder et la tester).\n\nIl s'agit d'un formulaire de demande prêt à la disposition de tout client souhaitant avoir un près auprès de sa banque.\n\nCeci réduit ainsi toute asymétrie d'information entre les clients et leur banque tout en facilitant la communication. Ainsi, sur la base de son score, le prêt peut être accordé au client. En cas d'issue favorable, il lui suffira de contacter son conseillé(e) muni de ses justificatifs et des originaux des documents demandés. Du côté de la banque par ailleurs, cette application est très utile car elle permet la conversion du modèle statistique en un outil d'aide à la décision.","user":"imsduser","dateUpdated":"2022-03-16T16:55:24+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Cette application ci-dessous est un outil automatisé permettant selon les caractéristiques entrées des clients de générer le score ainsi que la probabilité de défaut d'un emprunteur. Il est accessible <a href=\"https://share.streamlit.io/aadmberrada/systemesrepartis/main/app.py\">en cliquant sur ce lien</a> (nous vous invitons à y accéder et la tester).</p>\n<p>Il s'agit d'un formulaire de demande prêt à la disposition de tout client souhaitant avoir un près auprès de sa banque.</p>\n<p>Ceci réduit ainsi toute asymétrie d'information entre les clients et leur banque tout en facilitant la communication. Ainsi, sur la base de son score, le prêt peut être accordé au client. En cas d'issue favorable, il lui suffira de contacter son conseillé(e) muni de ses justificatifs et des originaux des documents demandés. Du côté de la banque par ailleurs, cette application est très utile car elle permet la conversion du modèle statistique en un outil d'aide à la décision.</p>\n"}]},"apps":[],"jobName":"paragraph_1647369722014_764884961","id":"20220315-194202_1124256985","dateCreated":"2022-03-15T19:42:02+0100","dateStarted":"2022-03-16T16:55:24+0100","dateFinished":"2022-03-16T16:55:24+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37699"},{"text":"%md\n<p align=\"center\">\n  <img src=\"https://raw.githubusercontent.com/aadmberrada/SystemesRepartis/main/stream.gif\" alt=\"animated\" />\n</p>\n\nCette application est un outil automatisé permettant, selon les caractéristiques entrées des clients, de générer le score ainsi que la probabilité de défaut d'un emprunteur.\n","user":"imsduser","dateUpdated":"2022-03-16T01:35:00+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p align=\"center\">\n  <img src=\"https://raw.githubusercontent.com/aadmberrada/SystemesRepartis/main/stream.gif\" alt=\"animated\" />\n</p>\n<p>Cette application est un outil automatisé permettant, selon les caractéristiques entrées des clients, de générer le score ainsi que la probabilité de défaut d'un emprunteur.</p>\n"}]},"apps":[],"jobName":"paragraph_1647369738382_-1250029704","id":"20220315-194218_560659635","dateCreated":"2022-03-15T19:42:18+0100","dateStarted":"2022-03-16T01:34:50+0100","dateFinished":"2022-03-16T01:34:50+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37700"},{"text":"%md\n<h2 style=\"font-family: Verdana\"><font color=\"#7133FF\"><strong> Conclusion </strong></font></h2>","user":"imsduser","dateUpdated":"2022-03-15T22:10:44+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2 style=\"font-family: Verdana\"><font color=\"#7133FF\"><strong> Conclusion </strong></font></h2>\n"}]},"apps":[],"jobName":"paragraph_1647079028447_-1698642564","id":"20220312-105708_1651724397","dateCreated":"2022-03-12T10:57:08+0100","dateStarted":"2022-03-15T22:09:32+0100","dateFinished":"2022-03-15T22:09:32+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37701"},{"text":"%md\nAinsi, en se basant sur les données HMEQ et en appliquant notre méthodologie précise, nous avons pu créer notre grille de score répartie en classes de risque en fonction des probabilités de risque des individus. Ce modèle de scoring est fondé sur le meilleur modèle estimé que nous avons pu établir, utilisant l’algorithme le plus simple et le plus compréhensible qui est la régression logistique. Nous avons obtenu finalement une performance de prédiction importante et notamment un recall très intéressant. La qualité de notre grille scoring découle ainsi de la qualité et la performance de notre modèle de prévision. Une fois notre modèle validé, il peut être converti en un outil d’aide à la décision. En effet, pour convertir le modèle statistique en un outil de prise de décision, l’organisation bancaire doit décider du score minimum requis pour accepter des clients. Ce dernier reflète le niveau de risque que l’organisation souhaite prendre, plus le score est bas et plus le nombre de clients recevant des services est élevé. Au final, l’arbitrage est entre le volume du portefeuille et le profit par rapport au risque. Le seuil reflète les objectifs commerciaux de la banque, tels que la maximisation du profit, la réduction des coûts et l’amélioration de la productivité.\n","user":"imsduser","dateUpdated":"2022-03-16T00:33:21+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Ainsi, en se basant sur les données HMEQ et en appliquant notre méthodologie précise, nous avons pu créer notre grille de score répartie en classes de risque en fonction des probabilités de risque des individus. Ce modèle de scoring est fondé sur le meilleur modèle estimé que nous avons pu établir, utilisant l’algorithme le plus simple et le plus compréhensible qui est la régression logistique. Nous avons obtenu finalement une performance de prédiction importante et notamment un recall très intéressant. La qualité de notre grille scoring découle ainsi de la qualité et la performance de notre modèle de prévision. Une fois notre modèle validé, il peut être converti en un outil d’aide à la décision. En effet, pour convertir le modèle statistique en un outil de prise de décision, l’organisation bancaire doit décider du score minimum requis pour accepter des clients. Ce dernier reflète le niveau de risque que l’organisation souhaite prendre, plus le score est bas et plus le nombre de clients recevant des services est élevé. Au final, l’arbitrage est entre le volume du portefeuille et le profit par rapport au risque. Le seuil reflète les objectifs commerciaux de la banque, tels que la maximisation du profit, la réduction des coûts et l’amélioration de la productivité.</p>\n"}]},"apps":[],"jobName":"paragraph_1647078988030_-642384240","id":"20220312-105628_1569758678","dateCreated":"2022-03-12T10:56:28+0100","dateStarted":"2022-03-16T00:33:21+0100","dateFinished":"2022-03-16T00:33:21+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:37702"},{"text":"%md\n","user":"imsduser","dateUpdated":"2022-03-12T16:16:49+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1647098209346_1651034516","id":"20220312-161649_1015699227","dateCreated":"2022-03-12T16:16:49+0100","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37703"}],"name":"loan_center","id":"2GYAV6EWT","angularObjects":{"2CHS8UYQQ:shared_process":[],"2CKX6DGQZ:shared_process":[],"2C8A4SZ9T_livy2:shared_process":[],"2CK8A9MEG:shared_process":[],"2C4U48MY3_spark2:shared_process":[],"2CKX8WPU1:shared_process":[],"2CKAY1A8Y:shared_process":[],"2CKEKWY8Z:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}